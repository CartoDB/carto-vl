/*!
 * CARTO VL js https://carto.com/
 * Version: 1.4.6
 * 
 */!function(e){var t={};function __webpack_require__(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,__webpack_require__),n.l=!0,n.exports}__webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,r){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(__webpack_require__.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)__webpack_require__.d(r,n,function(t){return e[t]}.bind(null,n));return r},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=57)}([function(e,t){e.exports=function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}},function(e,t){function _getPrototypeOf(t){return e.exports=_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(t)}e.exports=_getPrototypeOf},function(e,t,r){e.exports=r(37)},function(e,t,r){var n=r(10),a=r(42);e.exports=function _possibleConstructorReturn(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?a(e):t}},function(e,t,r){var n=r(14);e.exports=function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}},function(e,t,r){var n=r(34),a=r(35),i=r(36);e.exports=function _slicedToArray(e,t){return n(e)||a(e,t)||i()}},function(e,t){function asyncGeneratorStep(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}e.exports=function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var i=e.apply(t,r);function _next(e){asyncGeneratorStep(i,n,a,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(i,n,a,_next,_throw,"throw",e)}_next(void 0)})}}},function(e,t,r){var n=r(46),a=r(47),i=r(48);e.exports=function _toConsumableArray(e){return n(e)||a(e)||i()}},function(e,t,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function _has(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)_has(r,n)&&(e[n]=r[n])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var a={arraySet:function(e,t,r,n,a){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),a);else for(var i=0;i<n;i++)e[a+i]=t[r+i]},flattenChunks:function(e){var t,r,n,a,i,o;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(o=new Uint8Array(n),a=0,t=0,r=e.length;t<r;t++)i=e[t],o.set(i,a),a+=i.length;return o}},i={arraySet:function(e,t,r,n,a){for(var i=0;i<n;i++)e[a+i]=t[r+i]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,a)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,i))},t.setTyped(n)},function(e,t){function _typeof2(e){return(_typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof2(e){return typeof e}:function _typeof2(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(t){return"function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?e.exports=_typeof=function _typeof(e){return _typeof2(e)}:e.exports=_typeof=function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)},_typeof(t)}e.exports=_typeof},function(e,t,r){r(2);var n=r(45);function _get(t,r,a){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=_get=Reflect.get:e.exports=_get=function _get(e,t,r){var a=n(e,t);if(a){var i=Object.getOwnPropertyDescriptor(a,t);return i.get?i.get.call(r):i.value}},_get(t,r,a||t)}e.exports=_get},function(e,t,r){e.exports.VectorTile=r(39),e.exports.VectorTileFeature=r(17),e.exports.VectorTileLayer=r(16)},function(e,t,r){"use strict";e.exports=Pbf;var n=r(41);function Pbf(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Pbf.Varint=0,Pbf.Fixed64=1,Pbf.Bytes=2,Pbf.Fixed32=5;function readPackedEnd(e){return e.type===Pbf.Bytes?e.readVarint()+e.pos:e.pos+1}function toNum(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function makeRoomForExtraLength(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.ceil(Math.log(t)/(7*Math.LN2));r.realloc(n);for(var a=r.pos-1;a>=e;a--)r.buf[a+n]=r.buf[a]}function writePackedVarint(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function writePackedSVarint(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function writePackedFloat(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function writePackedDouble(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function writePackedBoolean(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function writePackedFixed32(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function writePackedSFixed32(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function writePackedFixed64(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function writePackedSFixed64(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function readUInt32(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function writeInt32(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function readInt32(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}Pbf.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),a=n>>3,i=this.pos;this.type=7&n,e(a,t,this),this.pos===i&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=readUInt32(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=readInt32(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=readUInt32(this.buf,this.pos)+4294967296*readUInt32(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=readUInt32(this.buf,this.pos)+4294967296*readInt32(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,n=this.buf;return t=127&(r=n[this.pos++]),r<128?t:(t|=(127&(r=n[this.pos++]))<<7,r<128?t:(t|=(127&(r=n[this.pos++]))<<14,r<128?t:(t|=(127&(r=n[this.pos++]))<<21,r<128?t:function readVarintRemainder(e,t,r){var n,a,i=r.buf;if(a=i[r.pos++],n=(112&a)>>4,a<128)return toNum(e,n,t);if(a=i[r.pos++],n|=(127&a)<<3,a<128)return toNum(e,n,t);if(a=i[r.pos++],n|=(127&a)<<10,a<128)return toNum(e,n,t);if(a=i[r.pos++],n|=(127&a)<<17,a<128)return toNum(e,n,t);if(a=i[r.pos++],n|=(127&a)<<24,a<128)return toNum(e,n,t);if(a=i[r.pos++],n|=(1&a)<<31,a<128)return toNum(e,n,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=n[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=function readUtf8(e,t,r){var n="",a=t;for(;a<r;){var i,o,s,u=e[a],c=null,l=u>239?4:u>223?3:u>191?2:1;if(a+l>r)break;1===l?u<128&&(c=u):2===l?128==(192&(i=e[a+1]))&&(c=(31&u)<<6|63&i)<=127&&(c=null):3===l?(i=e[a+1],o=e[a+2],128==(192&i)&&128==(192&o)&&((c=(15&u)<<12|(63&i)<<6|63&o)<=2047||c>=55296&&c<=57343)&&(c=null)):4===l&&(i=e[a+1],o=e[a+2],s=e[a+3],128==(192&i)&&128==(192&o)&&128==(192&s)&&((c=(15&u)<<18|(63&i)<<12|(63&o)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,l=1):c>65535&&(c-=65536,n+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),n+=String.fromCharCode(c),a+=l}return n}(this.buf,this.pos,e);return this.pos=e,t},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){var r=readPackedEnd(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Pbf.Varint)for(;this.buf[this.pos++]>127;);else if(t===Pbf.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Pbf.Fixed32)this.pos+=4;else{if(t!==Pbf.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),writeInt32(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),writeInt32(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),writeInt32(this.buf,-1&e,this.pos),writeInt32(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),writeInt32(this.buf,-1&e,this.pos),writeInt32(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function writeBigVarint(e,t){var r,n;e>=0?(r=e%4294967296|0,n=e/4294967296|0):(n=~(-e/4294967296),4294967295^(r=~(-e%4294967296))?r=r+1|0:(r=0,n=n+1|0));if(e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function writeBigVarintLow(e,t,r){r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos]=127&e}(r,0,t),function writeBigVarintHigh(e,t){var r=(7&e)<<4;if(t.buf[t.pos++]|=r|((e>>>=3)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;t.buf[t.pos++]=127&e}(n,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function writeUtf8(e,t,r){for(var n,a,i=0;i<t.length;i++){if((n=t.charCodeAt(i))>55295&&n<57344){if(!a){n>56319||i+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):a=n;continue}if(n<56320){e[r++]=239,e[r++]=191,e[r++]=189,a=n;continue}n=a-55296<<10|n-56320|65536,a=null}else a&&(e[r++]=239,e[r++]=191,e[r++]=189,a=null);n<128?e[r++]=n:(n<2048?e[r++]=n>>6|192:(n<65536?e[r++]=n>>12|224:(e[r++]=n>>18|240,e[r++]=n>>12&63|128),e[r++]=n>>6&63|128),e[r++]=63&n|128)}return r}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&makeRoomForExtraLength(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),n.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),n.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var n=this.pos-r;n>=128&&makeRoomForExtraLength(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,r){this.writeTag(e,Pbf.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){this.writeMessage(e,writePackedVarint,t)},writePackedSVarint:function(e,t){this.writeMessage(e,writePackedSVarint,t)},writePackedBoolean:function(e,t){this.writeMessage(e,writePackedBoolean,t)},writePackedFloat:function(e,t){this.writeMessage(e,writePackedFloat,t)},writePackedDouble:function(e,t){this.writeMessage(e,writePackedDouble,t)},writePackedFixed32:function(e,t){this.writeMessage(e,writePackedFixed32,t)},writePackedSFixed32:function(e,t){this.writeMessage(e,writePackedSFixed32,t)},writePackedFixed64:function(e,t){this.writeMessage(e,writePackedFixed64,t)},writePackedSFixed64:function(e,t){this.writeMessage(e,writePackedSFixed64,t)},writeBytesField:function(e,t){this.writeTag(e,Pbf.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Pbf.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Pbf.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Pbf.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Pbf.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Pbf.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Pbf.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Pbf.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Pbf.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Pbf.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}}},function(e,t){function _setPrototypeOf(t,r){return e.exports=_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e},_setPrototypeOf(t,r)}e.exports=_setPrototypeOf},function(e,t,r){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(e,t,r){"use strict";var n=r(17);function VectorTileLayer(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(readLayer,this,t),this.length=this._features.length}function readLayer(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function readValueMessage(e){var t=null,r=e.readVarint()+e.pos;for(;e.pos<r;){var n=e.readVarint()>>3;t=1===n?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null}return t}(r))}e.exports=VectorTileLayer,VectorTileLayer.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new n(this._pbf,t,this.extent,this._keys,this._values)}},function(e,t,r){"use strict";var n=r(40);function VectorTileFeature(e,t,r,n,a){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=a,e.readFields(readFeature,this,t)}function readFeature(e,t,r){1==e?t.id=r.readVarint():2==e?function readTag(e,t){var r=e.readVarint()+e.pos;for(;e.pos<r;){var n=t._keys[e.readVarint()],a=t._values[e.readVarint()];t.properties[n]=a}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function signedArea(e){for(var t,r,n=0,a=0,i=e.length,o=i-1;a<i;o=a++)t=e[a],n+=((r=e[o]).x-t.x)*(t.y+r.y);return n}e.exports=VectorTileFeature,VectorTileFeature.types=["Unknown","Point","LineString","Polygon"],VectorTileFeature.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,a=1,i=0,o=0,s=0,u=[];e.pos<r;){if(i<=0){var c=e.readVarint();a=7&c,i=c>>3}if(i--,1===a||2===a)o+=e.readSVarint(),s+=e.readSVarint(),1===a&&(t&&u.push(t),t=[]),t.push(new n(o,s));else{if(7!==a)throw new Error("unknown command "+a);t&&t.push(t[0].clone())}}return t&&u.push(t),u},VectorTileFeature.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,a=0,i=0,o=1/0,s=-1/0,u=1/0,c=-1/0;e.pos<t;){if(n<=0){var l=e.readVarint();r=7&l,n=l>>3}if(n--,1===r||2===r)a+=e.readSVarint(),i+=e.readSVarint(),a<o&&(o=a),a>s&&(s=a),i<u&&(u=i),i>c&&(c=i);else if(7!==r)throw new Error("unknown command "+r)}return[o,u,s,c]},VectorTileFeature.prototype.toGeoJSON=function(e,t,r){var n,a,i=this.extent*Math.pow(2,r),o=this.extent*e,s=this.extent*t,u=this.loadGeometry(),c=VectorTileFeature.types[this.type];function project(e){for(var t=0;t<e.length;t++){var r=e[t],n=180-360*(r.y+s)/i;e[t]=[360*(r.x+o)/i-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}}switch(this.type){case 1:var l=[];for(n=0;n<u.length;n++)l[n]=u[n][0];project(u=l);break;case 2:for(n=0;n<u.length;n++)project(u[n]);break;case 3:for(u=function classifyRings(e){var t=e.length;if(t<=1)return[e];for(var r,n,a=[],i=0;i<t;i++){var o=signedArea(e[i]);0!==o&&(void 0===n&&(n=o<0),n===o<0?(r&&a.push(r),r=[e[i]]):r.push(e[i]))}r&&a.push(r);return a}(u),n=0;n<u.length;n++)for(a=0;a<u[n].length;a++)project(u[n][a])}1===u.length?u=u[0]:c="Multi"+c;var f={type:"Feature",geometry:{type:c,coordinates:u},properties:this.properties};return"id"in this&&(f.id=this.id),f}},function(e,t,r){"use strict";e.exports=function adler32(e,t,r,n){for(var a=65535&e|0,i=e>>>16&65535|0,o=0;0!==r;){r-=o=r>2e3?2e3:r;do{i=i+(a=a+t[n++]|0)|0}while(--o);a%=65521,i%=65521}return a|i<<16|0}},function(e,t,r){"use strict";var n=function makeTable(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();e.exports=function crc32(e,t,r,a){var i=n,o=a+r;e^=-1;for(var s=a;s<o;s++)e=e>>>8^i[255&(e^t[s])];return-1^e}},function(e,t,r){"use strict";var n=r(9),a=!0,i=!0;try{String.fromCharCode.apply(null,[0])}catch(e){a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){i=!1}for(var o=new n.Buf8(256),s=0;s<256;s++)o[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function buf2binstring(e,t){if(t<65534&&(e.subarray&&i||!e.subarray&&a))return String.fromCharCode.apply(null,n.shrinkBuf(e,t));for(var r="",o=0;o<t;o++)r+=String.fromCharCode(e[o]);return r}o[254]=o[254]=1,t.string2buf=function(e){var t,r,a,i,o,s=e.length,u=0;for(i=0;i<s;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(a=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(a-56320),i++),u+=r<128?1:r<2048?2:r<65536?3:4;for(t=new n.Buf8(u),o=0,i=0;o<u;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(a=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(a-56320),i++),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|63&r):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|63&r):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|63&r);return t},t.buf2binstring=function(e){return buf2binstring(e,e.length)},t.binstring2buf=function(e){for(var t=new n.Buf8(e.length),r=0,a=t.length;r<a;r++)t[r]=e.charCodeAt(r);return t},t.buf2string=function(e,t){var r,n,a,i,s=t||e.length,u=new Array(2*s);for(n=0,r=0;r<s;)if((a=e[r++])<128)u[n++]=a;else if((i=o[a])>4)u[n++]=65533,r+=i-1;else{for(a&=2===i?31:3===i?15:7;i>1&&r<s;)a=a<<6|63&e[r++],i--;i>1?u[n++]=65533:a<65536?u[n++]=a:(a-=65536,u[n++]=55296|a>>10&1023,u[n++]=56320|1023&a)}return buf2binstring(u,n)},t.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0?t:0===r?t:r+o[e[r]]>t?r:t}},function(e,t,r){"use strict";e.exports=function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(e,t,r){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t,r){var n=r(2),a=r(14),i=r(43),o=r(44);function _wrapNativeSuper(t){var r="function"==typeof Map?new Map:void 0;return e.exports=_wrapNativeSuper=function _wrapNativeSuper(e){if(null===e||!i(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,Wrapper)}function Wrapper(){return o(e,arguments,n(this).constructor)}return Wrapper.prototype=Object.create(e.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),a(Wrapper,e)},_wrapNativeSuper(t)}e.exports=_wrapNativeSuper},function(e,t,r){"use strict";function earcut(e,t,r){r=r||2;var n,a,i,o,s,u,c,l=t&&t.length,f=l?t[0]*r:e.length,h=linkedList(e,0,f,r,!0),d=[];if(!h)return d;if(l&&(h=function eliminateHoles(e,t,r,n){var a,i,o,s,u,c=[];for(a=0,i=t.length;a<i;a++)o=t[a]*n,s=a<i-1?t[a+1]*n:e.length,(u=linkedList(e,o,s,n,!1))===u.next&&(u.steiner=!0),c.push(getLeftmost(u));for(c.sort(compareX),a=0;a<c.length;a++)eliminateHole(c[a],r),r=filterPoints(r,r.next);return r}(e,t,h,r)),e.length>80*r){n=i=e[0],a=o=e[1];for(var p=r;p<f;p+=r)s=e[p],u=e[p+1],s<n&&(n=s),u<a&&(a=u),s>i&&(i=s),u>o&&(o=u);c=0!==(c=Math.max(i-n,o-a))?1/c:0}return earcutLinked(h,d,r,n,a,c),d}function linkedList(e,t,r,n,a){var i,o;if(a===signedArea(e,t,r,n)>0)for(i=t;i<r;i+=n)o=insertNode(i,e[i],e[i+1],o);else for(i=r-n;i>=t;i-=n)o=insertNode(i,e[i],e[i+1],o);return o&&equals(o,o.next)&&(removeNode(o),o=o.next),o}function filterPoints(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!equals(n,n.next)&&0!==area(n.prev,n,n.next))n=n.next;else{if(removeNode(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function earcutLinked(e,t,r,n,a,i,o){if(e){!o&&i&&function indexCurve(e,t,r,n){var a=e;do{null===a.z&&(a.z=zOrder(a.x,a.y,t,r,n)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next}while(a!==e);a.prevZ.nextZ=null,a.prevZ=null,function sortLinked(e){var t,r,n,a,i,o,s,u,c=1;do{for(r=e,e=null,i=null,o=0;r;){for(o++,n=r,s=0,t=0;t<c&&(s++,n=n.nextZ);t++);for(u=c;s>0||u>0&&n;)0!==s&&(0===u||!n||r.z<=n.z)?(a=r,r=r.nextZ,s--):(a=n,n=n.nextZ,u--),i?i.nextZ=a:e=a,a.prevZ=i,i=a;r=n}i.nextZ=null,c*=2}while(o>1);return e}(a)}(e,n,a,i);for(var s,u,c=e;e.prev!==e.next;)if(s=e.prev,u=e.next,i?isEarHashed(e,n,a,i):isEar(e))t.push(s.i/r),t.push(e.i/r),t.push(u.i/r),removeNode(e),e=u.next,c=u.next;else if((e=u)===c){o?1===o?earcutLinked(e=cureLocalIntersections(e,t,r),t,r,n,a,i,2):2===o&&splitEarcut(e,t,r,n,a,i):earcutLinked(filterPoints(e),t,r,n,a,i,1);break}}}function isEar(e){var t=e.prev,r=e,n=e.next;if(area(t,r,n)>=0)return!1;for(var a=e.next.next;a!==e.prev;){if(pointInTriangle(t.x,t.y,r.x,r.y,n.x,n.y,a.x,a.y)&&area(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function isEarHashed(e,t,r,n){var a=e.prev,i=e,o=e.next;if(area(a,i,o)>=0)return!1;for(var s=a.x<i.x?a.x<o.x?a.x:o.x:i.x<o.x?i.x:o.x,u=a.y<i.y?a.y<o.y?a.y:o.y:i.y<o.y?i.y:o.y,c=a.x>i.x?a.x>o.x?a.x:o.x:i.x>o.x?i.x:o.x,l=a.y>i.y?a.y>o.y?a.y:o.y:i.y>o.y?i.y:o.y,f=zOrder(s,u,t,r,n),h=zOrder(c,l,t,r,n),d=e.prevZ,p=e.nextZ;d&&d.z>=f&&p&&p.z<=h;){if(d!==e.prev&&d!==e.next&&pointInTriangle(a.x,a.y,i.x,i.y,o.x,o.y,d.x,d.y)&&area(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,p!==e.prev&&p!==e.next&&pointInTriangle(a.x,a.y,i.x,i.y,o.x,o.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;d&&d.z>=f;){if(d!==e.prev&&d!==e.next&&pointInTriangle(a.x,a.y,i.x,i.y,o.x,o.y,d.x,d.y)&&area(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;p&&p.z<=h;){if(p!==e.prev&&p!==e.next&&pointInTriangle(a.x,a.y,i.x,i.y,o.x,o.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function cureLocalIntersections(e,t,r){var n=e;do{var a=n.prev,i=n.next.next;!equals(a,i)&&intersects(a,n,n.next,i)&&locallyInside(a,i)&&locallyInside(i,a)&&(t.push(a.i/r),t.push(n.i/r),t.push(i.i/r),removeNode(n),removeNode(n.next),n=e=i),n=n.next}while(n!==e);return n}function splitEarcut(e,t,r,n,a,i){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&isValidDiagonal(o,s)){var u=splitPolygon(o,s);return o=filterPoints(o,o.next),u=filterPoints(u,u.next),earcutLinked(o,t,r,n,a,i),void earcutLinked(u,t,r,n,a,i)}s=s.next}o=o.next}while(o!==e)}function compareX(e,t){return e.x-t.x}function eliminateHole(e,t){if(t=function findHoleBridge(e,t){var r,n=t,a=e.x,i=e.y,o=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var s=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=a&&s>o){if(o=s,s===a){if(i===n.y)return n;if(i===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(a===o)return r.prev;var u,c=r,l=r.x,f=r.y,h=1/0;n=r.next;for(;n!==c;)a>=n.x&&n.x>=l&&a!==n.x&&pointInTriangle(i<f?a:o,i,l,f,i<f?o:a,i,n.x,n.y)&&((u=Math.abs(i-n.y)/(a-n.x))<h||u===h&&n.x>r.x)&&locallyInside(n,e)&&(r=n,h=u),n=n.next;return r}(e,t)){var r=splitPolygon(t,e);filterPoints(r,r.next)}}function zOrder(e,t,r,n,a){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*a)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*a)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function getLeftmost(e){var t=e,r=e;do{t.x<r.x&&(r=t),t=t.next}while(t!==e);return r}function pointInTriangle(e,t,r,n,a,i,o,s){return(a-o)*(t-s)-(e-o)*(i-s)>=0&&(e-o)*(n-s)-(r-o)*(t-s)>=0&&(r-o)*(i-s)-(a-o)*(n-s)>=0}function isValidDiagonal(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function intersectsPolygon(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&intersects(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&locallyInside(e,t)&&locallyInside(t,e)&&function middleInside(e,t){var r=e,n=!1,a=(e.x+t.x)/2,i=(e.y+t.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&a<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)}function area(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function equals(e,t){return e.x===t.x&&e.y===t.y}function intersects(e,t,r,n){return!!(equals(e,t)&&equals(r,n)||equals(e,n)&&equals(r,t))||area(e,t,r)>0!=area(e,t,n)>0&&area(r,n,e)>0!=area(r,n,t)>0}function locallyInside(e,t){return area(e.prev,e,e.next)<0?area(e,t,e.next)>=0&&area(e,e.prev,t)>=0:area(e,t,e.prev)<0||area(e,e.next,t)<0}function splitPolygon(e,t){var r=new Node(e.i,e.x,e.y),n=new Node(t.i,t.x,t.y),a=e.next,i=t.prev;return e.next=t,t.prev=e,r.next=a,a.prev=r,n.next=r,r.prev=n,i.next=n,n.prev=i,n}function insertNode(e,t,r,n){var a=new Node(e,t,r);return n?(a.next=n.next,a.prev=n,n.next.prev=a,n.next=a):(a.prev=a,a.next=a),a}function removeNode(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Node(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(e,t,r,n){for(var a=0,i=t,o=r-n;i<r;i+=n)a+=(e[o]-e[i])*(e[i+1]+e[o+1]),o=i;return a}e.exports=earcut,e.exports.default=earcut,earcut.deviation=function(e,t,r,n){var a=t&&t.length,i=a?t[0]*r:e.length,o=Math.abs(signedArea(e,0,i,r));if(a)for(var s=0,u=t.length;s<u;s++){var c=t[s]*r,l=s<u-1?t[s+1]*r:e.length;o-=Math.abs(signedArea(e,c,l,r))}var f=0;for(s=0;s<n.length;s+=3){var h=n[s]*r,d=n[s+1]*r,p=n[s+2]*r;f+=Math.abs((e[h]-e[p])*(e[d+1]-e[h+1])-(e[h]-e[d])*(e[p+1]-e[h+1]))}return 0===o&&0===f?0:Math.abs((f-o)/o)},earcut.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,a=0;a<e.length;a++){for(var i=0;i<e[a].length;i++)for(var o=0;o<t;o++)r.vertices.push(e[a][i][o]);a>0&&(n+=e[a-1].length,r.holes.push(n))}return r}},function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(256),n=0;n<e.length;n++)r[e.charCodeAt(n)]=n;t.encode=function(t){var r,n=new Uint8Array(t),a=n.length,i="";for(r=0;r<a;r+=3)i+=e[n[r]>>2],i+=e[(3&n[r])<<4|n[r+1]>>4],i+=e[(15&n[r+1])<<2|n[r+2]>>6],i+=e[63&n[r+2]];return a%3==2?i=i.substring(0,i.length-1)+"=":a%3==1&&(i=i.substring(0,i.length-2)+"=="),i},t.decode=function(e){var t,n,a,i,o,s=.75*e.length,u=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var l=new ArrayBuffer(s),f=new Uint8Array(l);for(t=0;t<u;t+=4)n=r[e.charCodeAt(t)],a=r[e.charCodeAt(t+1)],i=r[e.charCodeAt(t+2)],o=r[e.charCodeAt(t+3)],f[c++]=n<<2|a>>4,f[c++]=(15&a)<<4|i>>2,f[c++]=(3&i)<<6|63&o;return l}}()},function(e,t,r){"use strict";var n={};(0,r(9).assign)(n,r(49),r(52),r(22)),e.exports=n},,,,,,,,function(e,t){e.exports=function _arrayWithHoles(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function _iterableToArrayLimit(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}},function(e,t){e.exports=function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(e,t,r){var n=function(){return this||"object"==typeof self&&self}()||Function("return this")(),a=n.regeneratorRuntime&&Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime")>=0,i=a&&n.regeneratorRuntime;if(n.regeneratorRuntime=void 0,e.exports=r(38),a)n.regeneratorRuntime=i;else try{delete n.regeneratorRuntime}catch(e){n.regeneratorRuntime=void 0}},function(e,t){!function(t){"use strict";var r,n=Object.prototype,a=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag",c="object"==typeof e,l=t.regeneratorRuntime;if(l)c&&(e.exports=l);else{(l=t.regeneratorRuntime=c?e.exports:{}).wrap=wrap;var f="suspendedStart",h="suspendedYield",d="executing",p="completed",_={},y={};y[o]=function(){return this};var m=Object.getPrototypeOf,v=m&&m(m(values([])));v&&v!==n&&a.call(v,o)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);GeneratorFunction.prototype=g.constructor=GeneratorFunctionPrototype,GeneratorFunctionPrototype.constructor=GeneratorFunction,GeneratorFunctionPrototype[u]=GeneratorFunction.displayName="GeneratorFunction",l.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},l.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,u in e||(e[u]="GeneratorFunction")),e.prototype=Object.create(g),e},l.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),AsyncIterator.prototype[s]=function(){return this},l.AsyncIterator=AsyncIterator,l.async=function(e,t,r,n){var a=new AsyncIterator(wrap(e,t,r,n));return l.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},defineIteratorMethods(g),g[u]="Generator",g[o]=function(){return this},g.toString=function(){return"[object Generator]"},l.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function next(){for(;t.length;){var r=t.pop();if(r in e)return next.value=r,next.done=!1,next}return next.done=!0,next}},l.values=values,Context.prototype={constructor:Context,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(resetTryEntry),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function handle(n,a){return o.type="throw",o.arg=e,t.next=n,a&&(t.method="next",t.arg=r),!!a}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],o=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var s=a.call(i,"catchLoc"),u=a.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,_):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;resetTryEntry(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:values(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=r),_}}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),o=new Context(n||[]);return i._invoke=function makeInvokeMethod(e,t,r){var n=f;return function invoke(a,i){if(n===d)throw new Error("Generator is already running");if(n===p){if("throw"===a)throw i;return doneResult()}for(r.method=a,r.arg=i;;){var o=r.delegate;if(o){var s=maybeInvokeDelegate(o,r);if(s){if(s===_)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===f)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var u=tryCatch(e,t,r);if("normal"===u.type){if(n=r.done?p:h,u.arg===_)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=p,r.method="throw",r.arg=u.arg)}}}(e,r,o),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}function defineIteratorMethods(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function AsyncIterator(e){var t;this._invoke=function enqueue(r,n){function callInvokeWithMethodAndArg(){return new Promise(function(t,i){!function invoke(t,r,n,i){var o=tryCatch(e[t],e,r);if("throw"!==o.type){var s=o.arg,u=s.value;return u&&"object"==typeof u&&a.call(u,"__await")?Promise.resolve(u.__await).then(function(e){invoke("next",e,n,i)},function(e){invoke("throw",e,n,i)}):Promise.resolve(u).then(function(e){s.value=e,n(s)},function(e){return invoke("throw",e,n,i)})}i(o.arg)}(r,n,t,i)})}return t=t?t.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}}function maybeInvokeDelegate(e,t){var n=e.iterator[t.method];if(n===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=r,maybeInvokeDelegate(e,t),"throw"===t.method))return _;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return _}var a=tryCatch(n,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,_;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,_):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,_)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function next(){for(;++n<e.length;)if(a.call(e,n))return next.value=e[n],next.done=!1,next;return next.value=r,next.done=!0,next};return i.next=i}}return{next:doneResult}}function doneResult(){return{value:r,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},function(e,t,r){"use strict";var n=r(16);function readTile(e,t,r){if(3===e){var a=new n(r,r.readVarint()+r.pos);a.length&&(t[a.name]=a)}}e.exports=function VectorTile(e,t){this.layers=e.readFields(readTile,{},t)}},function(e,t,r){"use strict";function Point(e,t){this.x=e,this.y=t}e.exports=Point,Point.prototype={clone:function(){return new Point(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,a=r*this.x+t*this.y;return this.x=n,this.y=a,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),a=t.x+r*(this.x-t.x)-n*(this.y-t.y),i=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=a,this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Point.convert=function(e){return e instanceof Point?e:Array.isArray(e)?new Point(e[0],e[1]):e}},function(e,t){t.read=function(e,t,r,n,a){var i,o,s=8*a-n-1,u=(1<<s)-1,c=u>>1,l=-7,f=r?a-1:0,h=r?-1:1,d=e[t+f];for(f+=h,i=d&(1<<-l)-1,d>>=-l,l+=s;l>0;i=256*i+e[t+f],f+=h,l-=8);for(o=i&(1<<-l)-1,i>>=-l,l+=n;l>0;o=256*o+e[t+f],f+=h,l-=8);if(0===i)i=1-c;else{if(i===u)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,n),i-=c}return(d?-1:1)*o*Math.pow(2,i-n)},t.write=function(e,t,r,n,a,i){var o,s,u,c=8*i-a-1,l=(1<<c)-1,f=l>>1,h=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:i-1,p=n?1:-1,_=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),(t+=o+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(o++,u/=2),o+f>=l?(s=0,o=l):o+f>=1?(s=(t*u-1)*Math.pow(2,a),o+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,a),o=0));a>=8;e[r+d]=255&s,d+=p,s/=256,a-=8);for(o=o<<a|s,c+=a;c>0;e[r+d]=255&o,d+=p,o/=256,c-=8);e[r+d-p]|=128*_}},function(e,t){e.exports=function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){e.exports=function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}},function(e,t,r){var n=r(14);function _construct(t,r,a){return!function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?e.exports=_construct=function _construct(e,t,r){var a=[null];a.push.apply(a,t);var i=new(Function.bind.apply(e,a));return r&&n(i,r.prototype),i}:e.exports=_construct=Reflect.construct,_construct.apply(null,arguments)}e.exports=_construct},function(e,t,r){var n=r(2);e.exports=function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e}},function(e,t){e.exports=function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}},function(e,t){e.exports=function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},function(e,t){e.exports=function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(e,t,r){"use strict";var n=r(50),a=r(9),i=r(20),o=r(15),s=r(21),u=Object.prototype.toString,c=0,l=-1,f=0,h=8;function Deflate(e){if(!(this instanceof Deflate))return new Deflate(e);this.options=a.assign({level:l,method:h,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var r=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==c)throw new Error(o[r]);if(t.header&&n.deflateSetHeader(this.strm,t.header),t.dictionary){var d;if(d="string"==typeof t.dictionary?i.string2buf(t.dictionary):"[object ArrayBuffer]"===u.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=n.deflateSetDictionary(this.strm,d))!==c)throw new Error(o[r]);this._dict_set=!0}}function deflate(e,t){var r=new Deflate(t);if(r.push(e,!0),r.err)throw r.msg||o[r.err];return r.result}Deflate.prototype.push=function(e,t){var r,o,s=this.strm,l=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=i.string2buf(e):"[object ArrayBuffer]"===u.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new a.Buf8(l),s.next_out=0,s.avail_out=l),1!==(r=n.deflate(s,o))&&r!==c)return this.onEnd(r),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(i.buf2binstring(a.shrinkBuf(s.output,s.next_out))):this.onData(a.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&1!==r);return 4===o?(r=n.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===c):2!==o||(this.onEnd(c),s.avail_out=0,!0)},Deflate.prototype.onData=function(e){this.chunks.push(e)},Deflate.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=Deflate,t.deflate=deflate,t.deflateRaw=function deflateRaw(e,t){return(t=t||{}).raw=!0,deflate(e,t)},t.gzip=function gzip(e,t){return(t=t||{}).gzip=!0,deflate(e,t)}},function(e,t,r){"use strict";var n,a=r(9),i=r(51),o=r(18),s=r(19),u=r(15),c=0,l=1,f=3,h=4,d=5,p=0,_=1,y=-2,m=-3,v=-5,g=-1,b=1,x=2,w=3,k=4,M=0,T=2,P=8,z=9,I=15,S=8,E=286,N=30,C=19,F=2*E+1,A=15,D=3,O=258,V=O+D+1,R=32,B=42,L=69,Z=73,q=91,j=103,G=113,U=666,W=1,Y=2,Q=3,H=4,J=3;function err(e,t){return e.msg=u[t],t}function rank(e){return(e<<1)-(e>4?9:0)}function zero(e){for(var t=e.length;--t>=0;)e[t]=0}function flush_pending(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(a.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function flush_block_only(e,t){i._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,flush_pending(e.strm)}function put_byte(e,t){e.pending_buf[e.pending++]=t}function putShortMSB(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function read_buf(e,t,r,n){var i=e.avail_in;return i>n&&(i=n),0===i?0:(e.avail_in-=i,a.arraySet(t,e.input,e.next_in,i,r),1===e.state.wrap?e.adler=o(e.adler,t,i,r):2===e.state.wrap&&(e.adler=s(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)}function longest_match(e,t){var r,n,a=e.max_chain_length,i=e.strstart,o=e.prev_length,s=e.nice_match,u=e.strstart>e.w_size-V?e.strstart-(e.w_size-V):0,c=e.window,l=e.w_mask,f=e.prev,h=e.strstart+O,d=c[i+o-1],p=c[i+o];e.prev_length>=e.good_match&&(a>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(r=t)+o]===p&&c[r+o-1]===d&&c[r]===c[i]&&c[++r]===c[i+1]){i+=2,r++;do{}while(c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&i<h);if(n=O-(h-i),i=h-O,n>o){if(e.match_start=t,o=n,n>=s)break;d=c[i+o-1],p=c[i+o]}}}while((t=f[t&l])>u&&0!=--a);return o<=e.lookahead?o:e.lookahead}function fill_window(e){var t,r,n,i,o,s=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=s+(s-V)){a.arraySet(e.window,e.window,s,s,0),e.match_start-=s,e.strstart-=s,e.block_start-=s,t=r=e.hash_size;do{n=e.head[--t],e.head[t]=n>=s?n-s:0}while(--r);t=r=s;do{n=e.prev[--t],e.prev[t]=n>=s?n-s:0}while(--r);i+=s}if(0===e.strm.avail_in)break;if(r=read_buf(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=r,e.lookahead+e.insert>=D)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+D-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<D)););}while(e.lookahead<V&&0!==e.strm.avail_in)}function deflate_fast(e,t){for(var r,n;;){if(e.lookahead<V){if(fill_window(e),e.lookahead<V&&t===c)return W;if(0===e.lookahead)break}if(r=0,e.lookahead>=D&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+D-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-V&&(e.match_length=longest_match(e,r)),e.match_length>=D)if(n=i._tr_tally(e,e.strstart-e.match_start,e.match_length-D),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=D){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+D-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(flush_block_only(e,!1),0===e.strm.avail_out))return W}return e.insert=e.strstart<D-1?e.strstart:D-1,t===h?(flush_block_only(e,!0),0===e.strm.avail_out?Q:H):e.last_lit&&(flush_block_only(e,!1),0===e.strm.avail_out)?W:Y}function deflate_slow(e,t){for(var r,n,a;;){if(e.lookahead<V){if(fill_window(e),e.lookahead<V&&t===c)return W;if(0===e.lookahead)break}if(r=0,e.lookahead>=D&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+D-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=D-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-V&&(e.match_length=longest_match(e,r),e.match_length<=5&&(e.strategy===b||e.match_length===D&&e.strstart-e.match_start>4096)&&(e.match_length=D-1)),e.prev_length>=D&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-D,n=i._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-D),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=a&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+D-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=D-1,e.strstart++,n&&(flush_block_only(e,!1),0===e.strm.avail_out))return W}else if(e.match_available){if((n=i._tr_tally(e,0,e.window[e.strstart-1]))&&flush_block_only(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return W}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=i._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<D-1?e.strstart:D-1,t===h?(flush_block_only(e,!0),0===e.strm.avail_out?Q:H):e.last_lit&&(flush_block_only(e,!1),0===e.strm.avail_out)?W:Y}function Config(e,t,r,n,a){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=a}function deflateResetKeep(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=T,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?B:G,e.adler=2===t.wrap?0:1,t.last_flush=c,i._tr_init(t),p):err(e,y)}function deflateReset(e){var t=deflateResetKeep(e);return t===p&&function lm_init(e){e.window_size=2*e.w_size,zero(e.head),e.max_lazy_match=n[e.level].max_lazy,e.good_match=n[e.level].good_length,e.nice_match=n[e.level].nice_length,e.max_chain_length=n[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=D-1,e.match_available=0,e.ins_h=0}(e.state),t}function deflateInit2(e,t,r,n,i,o){if(!e)return y;var s=1;if(t===g&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),i<1||i>z||r!==P||n<8||n>15||t<0||t>9||o<0||o>k)return err(e,y);8===n&&(n=9);var u=new function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=P,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*F),this.dyn_dtree=new a.Buf16(2*(2*N+1)),this.bl_tree=new a.Buf16(2*(2*C+1)),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(A+1),this.heap=new a.Buf16(2*E+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*E+1),zero(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0};return e.state=u,u.strm=e,u.wrap=s,u.gzhead=null,u.w_bits=n,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=i+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+D-1)/D),u.window=new a.Buf8(2*u.w_size),u.head=new a.Buf16(u.hash_size),u.prev=new a.Buf16(u.w_size),u.lit_bufsize=1<<i+6,u.pending_buf_size=4*u.lit_bufsize,u.pending_buf=new a.Buf8(u.pending_buf_size),u.d_buf=1*u.lit_bufsize,u.l_buf=3*u.lit_bufsize,u.level=t,u.strategy=o,u.method=r,deflateReset(e)}n=[new Config(0,0,0,0,function deflate_stored(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(fill_window(e),0===e.lookahead&&t===c)return W;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,flush_block_only(e,!1),0===e.strm.avail_out))return W;if(e.strstart-e.block_start>=e.w_size-V&&(flush_block_only(e,!1),0===e.strm.avail_out))return W}return e.insert=0,t===h?(flush_block_only(e,!0),0===e.strm.avail_out?Q:H):(e.strstart>e.block_start&&(flush_block_only(e,!1),e.strm.avail_out),W)}),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)],t.deflateInit=function deflateInit(e,t){return deflateInit2(e,t,P,I,S,M)},t.deflateInit2=deflateInit2,t.deflateReset=deflateReset,t.deflateResetKeep=deflateResetKeep,t.deflateSetHeader=function deflateSetHeader(e,t){return e&&e.state?2!==e.state.wrap?y:(e.state.gzhead=t,p):y},t.deflate=function deflate(e,t){var r,a,o,u;if(!e||!e.state||t>d||t<0)return e?err(e,y):y;if(a=e.state,!e.output||!e.input&&0!==e.avail_in||a.status===U&&t!==h)return err(e,0===e.avail_out?v:y);if(a.strm=e,r=a.last_flush,a.last_flush=t,a.status===B)if(2===a.wrap)e.adler=0,put_byte(a,31),put_byte(a,139),put_byte(a,8),a.gzhead?(put_byte(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),put_byte(a,255&a.gzhead.time),put_byte(a,a.gzhead.time>>8&255),put_byte(a,a.gzhead.time>>16&255),put_byte(a,a.gzhead.time>>24&255),put_byte(a,9===a.level?2:a.strategy>=x||a.level<2?4:0),put_byte(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(put_byte(a,255&a.gzhead.extra.length),put_byte(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=s(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=L):(put_byte(a,0),put_byte(a,0),put_byte(a,0),put_byte(a,0),put_byte(a,0),put_byte(a,9===a.level?2:a.strategy>=x||a.level<2?4:0),put_byte(a,J),a.status=G);else{var m=P+(a.w_bits-8<<4)<<8;m|=(a.strategy>=x||a.level<2?0:a.level<6?1:6===a.level?2:3)<<6,0!==a.strstart&&(m|=R),m+=31-m%31,a.status=G,putShortMSB(a,m),0!==a.strstart&&(putShortMSB(a,e.adler>>>16),putShortMSB(a,65535&e.adler)),e.adler=1}if(a.status===L)if(a.gzhead.extra){for(o=a.pending;a.gzindex<(65535&a.gzhead.extra.length)&&(a.pending!==a.pending_buf_size||(a.gzhead.hcrc&&a.pending>o&&(e.adler=s(e.adler,a.pending_buf,a.pending-o,o)),flush_pending(e),o=a.pending,a.pending!==a.pending_buf_size));)put_byte(a,255&a.gzhead.extra[a.gzindex]),a.gzindex++;a.gzhead.hcrc&&a.pending>o&&(e.adler=s(e.adler,a.pending_buf,a.pending-o,o)),a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=Z)}else a.status=Z;if(a.status===Z)if(a.gzhead.name){o=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>o&&(e.adler=s(e.adler,a.pending_buf,a.pending-o,o)),flush_pending(e),o=a.pending,a.pending===a.pending_buf_size)){u=1;break}u=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,put_byte(a,u)}while(0!==u);a.gzhead.hcrc&&a.pending>o&&(e.adler=s(e.adler,a.pending_buf,a.pending-o,o)),0===u&&(a.gzindex=0,a.status=q)}else a.status=q;if(a.status===q)if(a.gzhead.comment){o=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>o&&(e.adler=s(e.adler,a.pending_buf,a.pending-o,o)),flush_pending(e),o=a.pending,a.pending===a.pending_buf_size)){u=1;break}u=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,put_byte(a,u)}while(0!==u);a.gzhead.hcrc&&a.pending>o&&(e.adler=s(e.adler,a.pending_buf,a.pending-o,o)),0===u&&(a.status=j)}else a.status=j;if(a.status===j&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&flush_pending(e),a.pending+2<=a.pending_buf_size&&(put_byte(a,255&e.adler),put_byte(a,e.adler>>8&255),e.adler=0,a.status=G)):a.status=G),0!==a.pending){if(flush_pending(e),0===e.avail_out)return a.last_flush=-1,p}else if(0===e.avail_in&&rank(t)<=rank(r)&&t!==h)return err(e,v);if(a.status===U&&0!==e.avail_in)return err(e,v);if(0!==e.avail_in||0!==a.lookahead||t!==c&&a.status!==U){var g=a.strategy===x?function deflate_huff(e,t){for(var r;;){if(0===e.lookahead&&(fill_window(e),0===e.lookahead)){if(t===c)return W;break}if(e.match_length=0,r=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(flush_block_only(e,!1),0===e.strm.avail_out))return W}return e.insert=0,t===h?(flush_block_only(e,!0),0===e.strm.avail_out?Q:H):e.last_lit&&(flush_block_only(e,!1),0===e.strm.avail_out)?W:Y}(a,t):a.strategy===w?function deflate_rle(e,t){for(var r,n,a,o,s=e.window;;){if(e.lookahead<=O){if(fill_window(e),e.lookahead<=O&&t===c)return W;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=D&&e.strstart>0&&(n=s[a=e.strstart-1])===s[++a]&&n===s[++a]&&n===s[++a]){o=e.strstart+O;do{}while(n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&a<o);e.match_length=O-(o-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=D?(r=i._tr_tally(e,1,e.match_length-D),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(flush_block_only(e,!1),0===e.strm.avail_out))return W}return e.insert=0,t===h?(flush_block_only(e,!0),0===e.strm.avail_out?Q:H):e.last_lit&&(flush_block_only(e,!1),0===e.strm.avail_out)?W:Y}(a,t):n[a.level].func(a,t);if(g!==Q&&g!==H||(a.status=U),g===W||g===Q)return 0===e.avail_out&&(a.last_flush=-1),p;if(g===Y&&(t===l?i._tr_align(a):t!==d&&(i._tr_stored_block(a,0,0,!1),t===f&&(zero(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),flush_pending(e),0===e.avail_out))return a.last_flush=-1,p}return t!==h?p:a.wrap<=0?_:(2===a.wrap?(put_byte(a,255&e.adler),put_byte(a,e.adler>>8&255),put_byte(a,e.adler>>16&255),put_byte(a,e.adler>>24&255),put_byte(a,255&e.total_in),put_byte(a,e.total_in>>8&255),put_byte(a,e.total_in>>16&255),put_byte(a,e.total_in>>24&255)):(putShortMSB(a,e.adler>>>16),putShortMSB(a,65535&e.adler)),flush_pending(e),a.wrap>0&&(a.wrap=-a.wrap),0!==a.pending?p:_)},t.deflateEnd=function deflateEnd(e){var t;return e&&e.state?(t=e.state.status)!==B&&t!==L&&t!==Z&&t!==q&&t!==j&&t!==G&&t!==U?err(e,y):(e.state=null,t===G?err(e,m):p):y},t.deflateSetDictionary=function deflateSetDictionary(e,t){var r,n,i,s,u,c,l,f,h=t.length;if(!e||!e.state)return y;if(2===(s=(r=e.state).wrap)||1===s&&r.status!==B||r.lookahead)return y;for(1===s&&(e.adler=o(e.adler,t,h,0)),r.wrap=0,h>=r.w_size&&(0===s&&(zero(r.head),r.strstart=0,r.block_start=0,r.insert=0),f=new a.Buf8(r.w_size),a.arraySet(f,t,h-r.w_size,r.w_size,0),t=f,h=r.w_size),u=e.avail_in,c=e.next_in,l=e.input,e.avail_in=h,e.next_in=0,e.input=t,fill_window(r);r.lookahead>=D;){n=r.strstart,i=r.lookahead-(D-1);do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+D-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++}while(--i);r.strstart=n,r.lookahead=D-1,fill_window(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=D-1,r.match_available=0,e.next_in=c,e.input=l,e.avail_in=u,r.wrap=s,p},t.deflateInfo="pako deflate (from Nodeca project)"},function(e,t,r){"use strict";var n=r(9),a=4,i=0,o=1,s=2;function zero(e){for(var t=e.length;--t>=0;)e[t]=0}var u=0,c=1,l=2,f=29,h=256,d=h+1+f,p=30,_=19,y=2*d+1,m=15,v=16,g=7,b=256,x=16,w=17,k=18,M=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],T=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],P=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],I=new Array(2*(d+2));zero(I);var S=new Array(2*p);zero(S);var E=new Array(512);zero(E);var N=new Array(256);zero(N);var C=new Array(f);zero(C);var F,A,D,O=new Array(p);function StaticTreeDesc(e,t,r,n,a){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=a,this.has_stree=e&&e.length}function TreeDesc(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function d_code(e){return e<256?E[e]:E[256+(e>>>7)]}function put_short(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function send_bits(e,t,r){e.bi_valid>v-r?(e.bi_buf|=t<<e.bi_valid&65535,put_short(e,e.bi_buf),e.bi_buf=t>>v-e.bi_valid,e.bi_valid+=r-v):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function send_code(e,t,r){send_bits(e,r[2*t],r[2*t+1])}function bi_reverse(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function gen_codes(e,t,r){var n,a,i=new Array(m+1),o=0;for(n=1;n<=m;n++)i[n]=o=o+r[n-1]<<1;for(a=0;a<=t;a++){var s=e[2*a+1];0!==s&&(e[2*a]=bi_reverse(i[s]++,s))}}function init_block(e){var t;for(t=0;t<d;t++)e.dyn_ltree[2*t]=0;for(t=0;t<p;t++)e.dyn_dtree[2*t]=0;for(t=0;t<_;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*b]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function bi_windup(e){e.bi_valid>8?put_short(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function smaller(e,t,r,n){var a=2*t,i=2*r;return e[a]<e[i]||e[a]===e[i]&&n[t]<=n[r]}function pqdownheap(e,t,r){for(var n=e.heap[r],a=r<<1;a<=e.heap_len&&(a<e.heap_len&&smaller(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!smaller(t,n,e.heap[a],e.depth));)e.heap[r]=e.heap[a],r=a,a<<=1;e.heap[r]=n}function compress_block(e,t,r){var n,a,i,o,s=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],a=e.pending_buf[e.l_buf+s],s++,0===n?send_code(e,a,t):(send_code(e,(i=N[a])+h+1,t),0!==(o=M[i])&&send_bits(e,a-=C[i],o),send_code(e,i=d_code(--n),r),0!==(o=T[i])&&send_bits(e,n-=O[i],o))}while(s<e.last_lit);send_code(e,b,t)}function build_tree(e,t){var r,n,a,i=t.dyn_tree,o=t.stat_desc.static_tree,s=t.stat_desc.has_stree,u=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=y,r=0;r<u;r++)0!==i[2*r]?(e.heap[++e.heap_len]=c=r,e.depth[r]=0):i[2*r+1]=0;for(;e.heap_len<2;)i[2*(a=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[a]=0,e.opt_len--,s&&(e.static_len-=o[2*a+1]);for(t.max_code=c,r=e.heap_len>>1;r>=1;r--)pqdownheap(e,i,r);a=u;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],pqdownheap(e,i,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,i[2*a]=i[2*r]+i[2*n],e.depth[a]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,i[2*r+1]=i[2*n+1]=a,e.heap[1]=a++,pqdownheap(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function gen_bitlen(e,t){var r,n,a,i,o,s,u=t.dyn_tree,c=t.max_code,l=t.stat_desc.static_tree,f=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,d=t.stat_desc.extra_base,p=t.stat_desc.max_length,_=0;for(i=0;i<=m;i++)e.bl_count[i]=0;for(u[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<y;r++)(i=u[2*u[2*(n=e.heap[r])+1]+1]+1)>p&&(i=p,_++),u[2*n+1]=i,n>c||(e.bl_count[i]++,o=0,n>=d&&(o=h[n-d]),s=u[2*n],e.opt_len+=s*(i+o),f&&(e.static_len+=s*(l[2*n+1]+o)));if(0!==_){do{for(i=p-1;0===e.bl_count[i];)i--;e.bl_count[i]--,e.bl_count[i+1]+=2,e.bl_count[p]--,_-=2}while(_>0);for(i=p;0!==i;i--)for(n=e.bl_count[i];0!==n;)(a=e.heap[--r])>c||(u[2*a+1]!==i&&(e.opt_len+=(i-u[2*a+1])*u[2*a],u[2*a+1]=i),n--)}}(e,t),gen_codes(i,c,e.bl_count)}function scan_tree(e,t,r){var n,a,i=-1,o=t[1],s=0,u=7,c=4;for(0===o&&(u=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)a=o,o=t[2*(n+1)+1],++s<u&&a===o||(s<c?e.bl_tree[2*a]+=s:0!==a?(a!==i&&e.bl_tree[2*a]++,e.bl_tree[2*x]++):s<=10?e.bl_tree[2*w]++:e.bl_tree[2*k]++,s=0,i=a,0===o?(u=138,c=3):a===o?(u=6,c=3):(u=7,c=4))}function send_tree(e,t,r){var n,a,i=-1,o=t[1],s=0,u=7,c=4;for(0===o&&(u=138,c=3),n=0;n<=r;n++)if(a=o,o=t[2*(n+1)+1],!(++s<u&&a===o)){if(s<c)do{send_code(e,a,e.bl_tree)}while(0!=--s);else 0!==a?(a!==i&&(send_code(e,a,e.bl_tree),s--),send_code(e,x,e.bl_tree),send_bits(e,s-3,2)):s<=10?(send_code(e,w,e.bl_tree),send_bits(e,s-3,3)):(send_code(e,k,e.bl_tree),send_bits(e,s-11,7));s=0,i=a,0===o?(u=138,c=3):a===o?(u=6,c=3):(u=7,c=4)}}zero(O);var V=!1;function _tr_stored_block(e,t,r,a){send_bits(e,(u<<1)+(a?1:0),3),function copy_block(e,t,r,a){bi_windup(e),a&&(put_short(e,r),put_short(e,~r)),n.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r,!0)}t._tr_init=function _tr_init(e){V||(function tr_static_init(){var e,t,r,n,a,i=new Array(m+1);for(r=0,n=0;n<f-1;n++)for(C[n]=r,e=0;e<1<<M[n];e++)N[r++]=n;for(N[r-1]=n,a=0,n=0;n<16;n++)for(O[n]=a,e=0;e<1<<T[n];e++)E[a++]=n;for(a>>=7;n<p;n++)for(O[n]=a<<7,e=0;e<1<<T[n]-7;e++)E[256+a++]=n;for(t=0;t<=m;t++)i[t]=0;for(e=0;e<=143;)I[2*e+1]=8,e++,i[8]++;for(;e<=255;)I[2*e+1]=9,e++,i[9]++;for(;e<=279;)I[2*e+1]=7,e++,i[7]++;for(;e<=287;)I[2*e+1]=8,e++,i[8]++;for(gen_codes(I,d+1,i),e=0;e<p;e++)S[2*e+1]=5,S[2*e]=bi_reverse(e,5);F=new StaticTreeDesc(I,M,h+1,d,m),A=new StaticTreeDesc(S,T,0,p,m),D=new StaticTreeDesc(new Array(0),P,0,_,g)}(),V=!0),e.l_desc=new TreeDesc(e.dyn_ltree,F),e.d_desc=new TreeDesc(e.dyn_dtree,A),e.bl_desc=new TreeDesc(e.bl_tree,D),e.bi_buf=0,e.bi_valid=0,init_block(e)},t._tr_stored_block=_tr_stored_block,t._tr_flush_block=function _tr_flush_block(e,t,r,n){var u,f,d=0;e.level>0?(e.strm.data_type===s&&(e.strm.data_type=function detect_data_type(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return i;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return o;for(t=32;t<h;t++)if(0!==e.dyn_ltree[2*t])return o;return i}(e)),build_tree(e,e.l_desc),build_tree(e,e.d_desc),d=function build_bl_tree(e){var t;for(scan_tree(e,e.dyn_ltree,e.l_desc.max_code),scan_tree(e,e.dyn_dtree,e.d_desc.max_code),build_tree(e,e.bl_desc),t=_-1;t>=3&&0===e.bl_tree[2*z[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),u=e.opt_len+3+7>>>3,(f=e.static_len+3+7>>>3)<=u&&(u=f)):u=f=r+5,r+4<=u&&-1!==t?_tr_stored_block(e,t,r,n):e.strategy===a||f===u?(send_bits(e,(c<<1)+(n?1:0),3),compress_block(e,I,S)):(send_bits(e,(l<<1)+(n?1:0),3),function send_all_trees(e,t,r,n){var a;for(send_bits(e,t-257,5),send_bits(e,r-1,5),send_bits(e,n-4,4),a=0;a<n;a++)send_bits(e,e.bl_tree[2*z[a]+1],3);send_tree(e,e.dyn_ltree,t-1),send_tree(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,d+1),compress_block(e,e.dyn_ltree,e.dyn_dtree)),init_block(e),n&&bi_windup(e)},t._tr_tally=function _tr_tally(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(N[r]+h+1)]++,e.dyn_dtree[2*d_code(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function _tr_align(e){send_bits(e,c<<1,3),send_code(e,b,I),function bi_flush(e){16===e.bi_valid?(put_short(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},function(e,t,r){"use strict";var n=r(53),a=r(9),i=r(20),o=r(22),s=r(15),u=r(21),c=r(56),l=Object.prototype.toString;function Inflate(e){if(!(this instanceof Inflate))return new Inflate(e);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var r=n.inflateInit2(this.strm,t.windowBits);if(r!==o.Z_OK)throw new Error(s[r]);if(this.header=new c,n.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=i.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=n.inflateSetDictionary(this.strm,t.dictionary))!==o.Z_OK))throw new Error(s[r])}function inflate(e,t){var r=new Inflate(t);if(r.push(e,!0),r.err)throw r.msg||s[r.err];return r.result}Inflate.prototype.push=function(e,t){var r,s,u,c,f,h=this.strm,d=this.options.chunkSize,p=this.options.dictionary,_=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof e?h.input=i.binstring2buf(e):"[object ArrayBuffer]"===l.call(e)?h.input=new Uint8Array(e):h.input=e,h.next_in=0,h.avail_in=h.input.length;do{if(0===h.avail_out&&(h.output=new a.Buf8(d),h.next_out=0,h.avail_out=d),(r=n.inflate(h,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&p&&(r=n.inflateSetDictionary(this.strm,p)),r===o.Z_BUF_ERROR&&!0===_&&(r=o.Z_OK,_=!1),r!==o.Z_STREAM_END&&r!==o.Z_OK)return this.onEnd(r),this.ended=!0,!1;h.next_out&&(0!==h.avail_out&&r!==o.Z_STREAM_END&&(0!==h.avail_in||s!==o.Z_FINISH&&s!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(u=i.utf8border(h.output,h.next_out),c=h.next_out-u,f=i.buf2string(h.output,u),h.next_out=c,h.avail_out=d-c,c&&a.arraySet(h.output,h.output,u,c,0),this.onData(f)):this.onData(a.shrinkBuf(h.output,h.next_out)))),0===h.avail_in&&0===h.avail_out&&(_=!0)}while((h.avail_in>0||0===h.avail_out)&&r!==o.Z_STREAM_END);return r===o.Z_STREAM_END&&(s=o.Z_FINISH),s===o.Z_FINISH?(r=n.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===o.Z_OK):s!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),h.avail_out=0,!0)},Inflate.prototype.onData=function(e){this.chunks.push(e)},Inflate.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=Inflate,t.inflate=inflate,t.inflateRaw=function inflateRaw(e,t){return(t=t||{}).raw=!0,inflate(e,t)},t.ungzip=inflate},function(e,t,r){"use strict";var n=r(9),a=r(18),i=r(19),o=r(54),s=r(55),u=0,c=1,l=2,f=4,h=5,d=6,p=0,_=1,y=2,m=-2,v=-3,g=-4,b=-5,x=8,w=1,k=2,M=3,T=4,P=5,z=6,I=7,S=8,E=9,N=10,C=11,F=12,A=13,D=14,O=15,V=16,R=17,B=18,L=19,Z=20,q=21,j=22,G=23,U=24,W=25,Y=26,Q=27,H=28,J=29,$=30,K=31,X=32,ee=852,te=592,re=15;function zswap32(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function inflateResetKeep(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=w,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new n.Buf32(ee),t.distcode=t.distdyn=new n.Buf32(te),t.sane=1,t.back=-1,p):m}function inflateReset(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,inflateResetKeep(e)):m}function inflateReset2(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?m:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,inflateReset(e))):m}function inflateInit2(e,t){var r,a;return e?(a=new function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0},e.state=a,a.window=null,(r=inflateReset2(e,t))!==p&&(e.state=null),r):m}var ne,ae,ie=!0;function fixedtables(e){if(ie){var t;for(ne=new n.Buf32(512),ae=new n.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(c,e.lens,0,288,ne,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(l,e.lens,0,32,ae,0,e.work,{bits:5}),ie=!1}e.lencode=ne,e.lenbits=9,e.distcode=ae,e.distbits=5}function updatewindow(e,t,r,a){var i,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new n.Buf8(o.wsize)),a>=o.wsize?(n.arraySet(o.window,t,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((i=o.wsize-o.wnext)>a&&(i=a),n.arraySet(o.window,t,r-a,i,o.wnext),(a-=i)?(n.arraySet(o.window,t,r-a,a,0),o.wnext=a,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0}t.inflateReset=inflateReset,t.inflateReset2=inflateReset2,t.inflateResetKeep=inflateResetKeep,t.inflateInit=function inflateInit(e){return inflateInit2(e,re)},t.inflateInit2=inflateInit2,t.inflate=function inflate(e,t){var r,ee,te,re,ne,ae,ie,oe,se,ue,ce,le,fe,he,de,pe,_e,ye,me,ve,ge,be,xe,we,ke=0,Me=new n.Buf8(4),Te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return m;(r=e.state).mode===F&&(r.mode=A),ne=e.next_out,te=e.output,ie=e.avail_out,re=e.next_in,ee=e.input,ae=e.avail_in,oe=r.hold,se=r.bits,ue=ae,ce=ie,be=p;e:for(;;)switch(r.mode){case w:if(0===r.wrap){r.mode=A;break}for(;se<16;){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}if(2&r.wrap&&35615===oe){r.check=0,Me[0]=255&oe,Me[1]=oe>>>8&255,r.check=i(r.check,Me,2,0),oe=0,se=0,r.mode=k;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&oe)<<8)+(oe>>8))%31){e.msg="incorrect header check",r.mode=$;break}if((15&oe)!==x){e.msg="unknown compression method",r.mode=$;break}if(se-=4,ge=8+(15&(oe>>>=4)),0===r.wbits)r.wbits=ge;else if(ge>r.wbits){e.msg="invalid window size",r.mode=$;break}r.dmax=1<<ge,e.adler=r.check=1,r.mode=512&oe?N:F,oe=0,se=0;break;case k:for(;se<16;){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}if(r.flags=oe,(255&r.flags)!==x){e.msg="unknown compression method",r.mode=$;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=$;break}r.head&&(r.head.text=oe>>8&1),512&r.flags&&(Me[0]=255&oe,Me[1]=oe>>>8&255,r.check=i(r.check,Me,2,0)),oe=0,se=0,r.mode=M;case M:for(;se<32;){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}r.head&&(r.head.time=oe),512&r.flags&&(Me[0]=255&oe,Me[1]=oe>>>8&255,Me[2]=oe>>>16&255,Me[3]=oe>>>24&255,r.check=i(r.check,Me,4,0)),oe=0,se=0,r.mode=T;case T:for(;se<16;){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}r.head&&(r.head.xflags=255&oe,r.head.os=oe>>8),512&r.flags&&(Me[0]=255&oe,Me[1]=oe>>>8&255,r.check=i(r.check,Me,2,0)),oe=0,se=0,r.mode=P;case P:if(1024&r.flags){for(;se<16;){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}r.length=oe,r.head&&(r.head.extra_len=oe),512&r.flags&&(Me[0]=255&oe,Me[1]=oe>>>8&255,r.check=i(r.check,Me,2,0)),oe=0,se=0}else r.head&&(r.head.extra=null);r.mode=z;case z:if(1024&r.flags&&((le=r.length)>ae&&(le=ae),le&&(r.head&&(ge=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),n.arraySet(r.head.extra,ee,re,le,ge)),512&r.flags&&(r.check=i(r.check,ee,le,re)),ae-=le,re+=le,r.length-=le),r.length))break e;r.length=0,r.mode=I;case I:if(2048&r.flags){if(0===ae)break e;le=0;do{ge=ee[re+le++],r.head&&ge&&r.length<65536&&(r.head.name+=String.fromCharCode(ge))}while(ge&&le<ae);if(512&r.flags&&(r.check=i(r.check,ee,le,re)),ae-=le,re+=le,ge)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=S;case S:if(4096&r.flags){if(0===ae)break e;le=0;do{ge=ee[re+le++],r.head&&ge&&r.length<65536&&(r.head.comment+=String.fromCharCode(ge))}while(ge&&le<ae);if(512&r.flags&&(r.check=i(r.check,ee,le,re)),ae-=le,re+=le,ge)break e}else r.head&&(r.head.comment=null);r.mode=E;case E:if(512&r.flags){for(;se<16;){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}if(oe!==(65535&r.check)){e.msg="header crc mismatch",r.mode=$;break}oe=0,se=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=F;break;case N:for(;se<32;){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}e.adler=r.check=zswap32(oe),oe=0,se=0,r.mode=C;case C:if(0===r.havedict)return e.next_out=ne,e.avail_out=ie,e.next_in=re,e.avail_in=ae,r.hold=oe,r.bits=se,y;e.adler=r.check=1,r.mode=F;case F:if(t===h||t===d)break e;case A:if(r.last){oe>>>=7&se,se-=7&se,r.mode=Q;break}for(;se<3;){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}switch(r.last=1&oe,se-=1,3&(oe>>>=1)){case 0:r.mode=D;break;case 1:if(fixedtables(r),r.mode=Z,t===d){oe>>>=2,se-=2;break e}break;case 2:r.mode=R;break;case 3:e.msg="invalid block type",r.mode=$}oe>>>=2,se-=2;break;case D:for(oe>>>=7&se,se-=7&se;se<32;){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}if((65535&oe)!=(oe>>>16^65535)){e.msg="invalid stored block lengths",r.mode=$;break}if(r.length=65535&oe,oe=0,se=0,r.mode=O,t===d)break e;case O:r.mode=V;case V:if(le=r.length){if(le>ae&&(le=ae),le>ie&&(le=ie),0===le)break e;n.arraySet(te,ee,re,le,ne),ae-=le,re+=le,ie-=le,ne+=le,r.length-=le;break}r.mode=F;break;case R:for(;se<14;){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}if(r.nlen=257+(31&oe),oe>>>=5,se-=5,r.ndist=1+(31&oe),oe>>>=5,se-=5,r.ncode=4+(15&oe),oe>>>=4,se-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=$;break}r.have=0,r.mode=B;case B:for(;r.have<r.ncode;){for(;se<3;){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}r.lens[Te[r.have++]]=7&oe,oe>>>=3,se-=3}for(;r.have<19;)r.lens[Te[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,xe={bits:r.lenbits},be=s(u,r.lens,0,19,r.lencode,0,r.work,xe),r.lenbits=xe.bits,be){e.msg="invalid code lengths set",r.mode=$;break}r.have=0,r.mode=L;case L:for(;r.have<r.nlen+r.ndist;){for(;pe=(ke=r.lencode[oe&(1<<r.lenbits)-1])>>>16&255,_e=65535&ke,!((de=ke>>>24)<=se);){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}if(_e<16)oe>>>=de,se-=de,r.lens[r.have++]=_e;else{if(16===_e){for(we=de+2;se<we;){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}if(oe>>>=de,se-=de,0===r.have){e.msg="invalid bit length repeat",r.mode=$;break}ge=r.lens[r.have-1],le=3+(3&oe),oe>>>=2,se-=2}else if(17===_e){for(we=de+3;se<we;){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}se-=de,ge=0,le=3+(7&(oe>>>=de)),oe>>>=3,se-=3}else{for(we=de+7;se<we;){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}se-=de,ge=0,le=11+(127&(oe>>>=de)),oe>>>=7,se-=7}if(r.have+le>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=$;break}for(;le--;)r.lens[r.have++]=ge}}if(r.mode===$)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=$;break}if(r.lenbits=9,xe={bits:r.lenbits},be=s(c,r.lens,0,r.nlen,r.lencode,0,r.work,xe),r.lenbits=xe.bits,be){e.msg="invalid literal/lengths set",r.mode=$;break}if(r.distbits=6,r.distcode=r.distdyn,xe={bits:r.distbits},be=s(l,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,xe),r.distbits=xe.bits,be){e.msg="invalid distances set",r.mode=$;break}if(r.mode=Z,t===d)break e;case Z:r.mode=q;case q:if(ae>=6&&ie>=258){e.next_out=ne,e.avail_out=ie,e.next_in=re,e.avail_in=ae,r.hold=oe,r.bits=se,o(e,ce),ne=e.next_out,te=e.output,ie=e.avail_out,re=e.next_in,ee=e.input,ae=e.avail_in,oe=r.hold,se=r.bits,r.mode===F&&(r.back=-1);break}for(r.back=0;pe=(ke=r.lencode[oe&(1<<r.lenbits)-1])>>>16&255,_e=65535&ke,!((de=ke>>>24)<=se);){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}if(pe&&0==(240&pe)){for(ye=de,me=pe,ve=_e;pe=(ke=r.lencode[ve+((oe&(1<<ye+me)-1)>>ye)])>>>16&255,_e=65535&ke,!(ye+(de=ke>>>24)<=se);){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}oe>>>=ye,se-=ye,r.back+=ye}if(oe>>>=de,se-=de,r.back+=de,r.length=_e,0===pe){r.mode=Y;break}if(32&pe){r.back=-1,r.mode=F;break}if(64&pe){e.msg="invalid literal/length code",r.mode=$;break}r.extra=15&pe,r.mode=j;case j:if(r.extra){for(we=r.extra;se<we;){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}r.length+=oe&(1<<r.extra)-1,oe>>>=r.extra,se-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=G;case G:for(;pe=(ke=r.distcode[oe&(1<<r.distbits)-1])>>>16&255,_e=65535&ke,!((de=ke>>>24)<=se);){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}if(0==(240&pe)){for(ye=de,me=pe,ve=_e;pe=(ke=r.distcode[ve+((oe&(1<<ye+me)-1)>>ye)])>>>16&255,_e=65535&ke,!(ye+(de=ke>>>24)<=se);){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}oe>>>=ye,se-=ye,r.back+=ye}if(oe>>>=de,se-=de,r.back+=de,64&pe){e.msg="invalid distance code",r.mode=$;break}r.offset=_e,r.extra=15&pe,r.mode=U;case U:if(r.extra){for(we=r.extra;se<we;){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}r.offset+=oe&(1<<r.extra)-1,oe>>>=r.extra,se-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=$;break}r.mode=W;case W:if(0===ie)break e;if(le=ce-ie,r.offset>le){if((le=r.offset-le)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=$;break}le>r.wnext?(le-=r.wnext,fe=r.wsize-le):fe=r.wnext-le,le>r.length&&(le=r.length),he=r.window}else he=te,fe=ne-r.offset,le=r.length;le>ie&&(le=ie),ie-=le,r.length-=le;do{te[ne++]=he[fe++]}while(--le);0===r.length&&(r.mode=q);break;case Y:if(0===ie)break e;te[ne++]=r.length,ie--,r.mode=q;break;case Q:if(r.wrap){for(;se<32;){if(0===ae)break e;ae--,oe|=ee[re++]<<se,se+=8}if(ce-=ie,e.total_out+=ce,r.total+=ce,ce&&(e.adler=r.check=r.flags?i(r.check,te,ce,ne-ce):a(r.check,te,ce,ne-ce)),ce=ie,(r.flags?oe:zswap32(oe))!==r.check){e.msg="incorrect data check",r.mode=$;break}oe=0,se=0}r.mode=H;case H:if(r.wrap&&r.flags){for(;se<32;){if(0===ae)break e;ae--,oe+=ee[re++]<<se,se+=8}if(oe!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=$;break}oe=0,se=0}r.mode=J;case J:be=_;break e;case $:be=v;break e;case K:return g;case X:default:return m}return e.next_out=ne,e.avail_out=ie,e.next_in=re,e.avail_in=ae,r.hold=oe,r.bits=se,(r.wsize||ce!==e.avail_out&&r.mode<$&&(r.mode<Q||t!==f))&&updatewindow(e,e.output,e.next_out,ce-e.avail_out)?(r.mode=K,g):(ue-=e.avail_in,ce-=e.avail_out,e.total_in+=ue,e.total_out+=ce,r.total+=ce,r.wrap&&ce&&(e.adler=r.check=r.flags?i(r.check,te,ce,e.next_out-ce):a(r.check,te,ce,e.next_out-ce)),e.data_type=r.bits+(r.last?64:0)+(r.mode===F?128:0)+(r.mode===Z||r.mode===O?256:0),(0===ue&&0===ce||t===f)&&be===p&&(be=b),be)},t.inflateEnd=function inflateEnd(e){if(!e||!e.state)return m;var t=e.state;return t.window&&(t.window=null),e.state=null,p},t.inflateGetHeader=function inflateGetHeader(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?m:(r.head=t,t.done=!1,p):m},t.inflateSetDictionary=function inflateSetDictionary(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&r.mode!==C?m:r.mode===C&&a(1,t,n,0)!==r.check?v:updatewindow(e,t,n,n)?(r.mode=K,g):(r.havedict=1,p):m},t.inflateInfo="pako inflate (from Nodeca project)"},function(e,t,r){"use strict";e.exports=function inflate_fast(e,t){var r,n,a,i,o,s,u,c,l,f,h,d,p,_,y,m,v,g,b,x,w,k,M,T,P;r=e.state,n=e.next_in,T=e.input,a=n+(e.avail_in-5),i=e.next_out,P=e.output,o=i-(t-e.avail_out),s=i+(e.avail_out-257),u=r.dmax,c=r.wsize,l=r.whave,f=r.wnext,h=r.window,d=r.hold,p=r.bits,_=r.lencode,y=r.distcode,m=(1<<r.lenbits)-1,v=(1<<r.distbits)-1;e:do{p<15&&(d+=T[n++]<<p,p+=8,d+=T[n++]<<p,p+=8),g=_[d&m];t:for(;;){if(d>>>=b=g>>>24,p-=b,0===(b=g>>>16&255))P[i++]=65535&g;else{if(!(16&b)){if(0==(64&b)){g=_[(65535&g)+(d&(1<<b)-1)];continue t}if(32&b){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}x=65535&g,(b&=15)&&(p<b&&(d+=T[n++]<<p,p+=8),x+=d&(1<<b)-1,d>>>=b,p-=b),p<15&&(d+=T[n++]<<p,p+=8,d+=T[n++]<<p,p+=8),g=y[d&v];r:for(;;){if(d>>>=b=g>>>24,p-=b,!(16&(b=g>>>16&255))){if(0==(64&b)){g=y[(65535&g)+(d&(1<<b)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(w=65535&g,p<(b&=15)&&(d+=T[n++]<<p,(p+=8)<b&&(d+=T[n++]<<p,p+=8)),(w+=d&(1<<b)-1)>u){e.msg="invalid distance too far back",r.mode=30;break e}if(d>>>=b,p-=b,w>(b=i-o)){if((b=w-b)>l&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(k=0,M=h,0===f){if(k+=c-b,b<x){x-=b;do{P[i++]=h[k++]}while(--b);k=i-w,M=P}}else if(f<b){if(k+=c+f-b,(b-=f)<x){x-=b;do{P[i++]=h[k++]}while(--b);if(k=0,f<x){x-=b=f;do{P[i++]=h[k++]}while(--b);k=i-w,M=P}}}else if(k+=f-b,b<x){x-=b;do{P[i++]=h[k++]}while(--b);k=i-w,M=P}for(;x>2;)P[i++]=M[k++],P[i++]=M[k++],P[i++]=M[k++],x-=3;x&&(P[i++]=M[k++],x>1&&(P[i++]=M[k++]))}else{k=i-w;do{P[i++]=P[k++],P[i++]=P[k++],P[i++]=P[k++],x-=3}while(x>2);x&&(P[i++]=P[k++],x>1&&(P[i++]=P[k++]))}break}}break}}while(n<a&&i<s);n-=x=p>>3,d&=(1<<(p-=x<<3))-1,e.next_in=n,e.next_out=i,e.avail_in=n<a?a-n+5:5-(n-a),e.avail_out=i<s?s-i+257:257-(i-s),r.hold=d,r.bits=p}},function(e,t,r){"use strict";var n=r(9),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],i=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function inflate_table(e,t,r,u,c,l,f,h){var d,p,_,y,m,v,g,b,x,w=h.bits,k=0,M=0,T=0,P=0,z=0,I=0,S=0,E=0,N=0,C=0,F=null,A=0,D=new n.Buf16(16),O=new n.Buf16(16),V=null,R=0;for(k=0;k<=15;k++)D[k]=0;for(M=0;M<u;M++)D[t[r+M]]++;for(z=w,P=15;P>=1&&0===D[P];P--);if(z>P&&(z=P),0===P)return c[l++]=20971520,c[l++]=20971520,h.bits=1,0;for(T=1;T<P&&0===D[T];T++);for(z<T&&(z=T),E=1,k=1;k<=15;k++)if(E<<=1,(E-=D[k])<0)return-1;if(E>0&&(0===e||1!==P))return-1;for(O[1]=0,k=1;k<15;k++)O[k+1]=O[k]+D[k];for(M=0;M<u;M++)0!==t[r+M]&&(f[O[t[r+M]]++]=M);if(0===e?(F=V=f,v=19):1===e?(F=a,A-=257,V=i,R-=257,v=256):(F=o,V=s,v=-1),C=0,M=0,k=T,m=l,I=z,S=0,_=-1,y=(N=1<<z)-1,1===e&&N>852||2===e&&N>592)return 1;for(;;){g=k-S,f[M]<v?(b=0,x=f[M]):f[M]>v?(b=V[R+f[M]],x=F[A+f[M]]):(b=96,x=0),d=1<<k-S,T=p=1<<I;do{c[m+(C>>S)+(p-=d)]=g<<24|b<<16|x|0}while(0!==p);for(d=1<<k-1;C&d;)d>>=1;if(0!==d?(C&=d-1,C+=d):C=0,M++,0==--D[k]){if(k===P)break;k=t[r+f[M]]}if(k>z&&(C&y)!==_){for(0===S&&(S=z),m+=T,E=1<<(I=k-S);I+S<P&&!((E-=D[I+S])<=0);)I++,E<<=1;if(N+=1<<I,1===e&&N>852||2===e&&N>592)return 1;c[_=C&y]=z<<24|I<<16|m-l|0}}return 0!==C&&(c[m+C]=k-S<<24|64<<16|0),h.bits=z,0}},function(e,t,r){"use strict";e.exports=function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"create",function(){return create}),r.d(n,"clone",function(){return clone}),r.d(n,"copy",function(){return copy}),r.d(n,"fromValues",function(){return fromValues}),r.d(n,"set",function(){return set}),r.d(n,"identity",function(){return identity}),r.d(n,"transpose",function(){return transpose}),r.d(n,"invert",function(){return invert}),r.d(n,"adjoint",function(){return adjoint}),r.d(n,"determinant",function(){return determinant}),r.d(n,"multiply",function(){return multiply}),r.d(n,"translate",function(){return translate}),r.d(n,"scale",function(){return mat4_scale}),r.d(n,"rotate",function(){return rotate}),r.d(n,"rotateX",function(){return rotateX}),r.d(n,"rotateY",function(){return rotateY}),r.d(n,"rotateZ",function(){return rotateZ}),r.d(n,"fromTranslation",function(){return fromTranslation}),r.d(n,"fromScaling",function(){return fromScaling}),r.d(n,"fromRotation",function(){return fromRotation}),r.d(n,"fromXRotation",function(){return fromXRotation}),r.d(n,"fromYRotation",function(){return fromYRotation}),r.d(n,"fromZRotation",function(){return fromZRotation}),r.d(n,"fromRotationTranslation",function(){return fromRotationTranslation}),r.d(n,"fromQuat2",function(){return fromQuat2}),r.d(n,"getTranslation",function(){return getTranslation}),r.d(n,"getScaling",function(){return getScaling}),r.d(n,"getRotation",function(){return getRotation}),r.d(n,"fromRotationTranslationScale",function(){return fromRotationTranslationScale}),r.d(n,"fromRotationTranslationScaleOrigin",function(){return fromRotationTranslationScaleOrigin}),r.d(n,"fromQuat",function(){return fromQuat}),r.d(n,"frustum",function(){return frustum}),r.d(n,"perspective",function(){return perspective}),r.d(n,"perspectiveFromFieldOfView",function(){return perspectiveFromFieldOfView}),r.d(n,"ortho",function(){return ortho}),r.d(n,"lookAt",function(){return lookAt}),r.d(n,"targetTo",function(){return targetTo}),r.d(n,"str",function(){return str}),r.d(n,"frob",function(){return frob}),r.d(n,"add",function(){return add}),r.d(n,"subtract",function(){return subtract}),r.d(n,"multiplyScalar",function(){return multiplyScalar}),r.d(n,"multiplyScalarAndAdd",function(){return multiplyScalarAndAdd}),r.d(n,"exactEquals",function(){return exactEquals}),r.d(n,"equals",function(){return mat4_equals}),r.d(n,"mul",function(){return M}),r.d(n,"sub",function(){return T});var a={};r.r(a),r.d(a,"create",function(){return vec4_create}),r.d(a,"clone",function(){return vec4_clone}),r.d(a,"fromValues",function(){return vec4_fromValues}),r.d(a,"copy",function(){return vec4_copy}),r.d(a,"set",function(){return vec4_set}),r.d(a,"add",function(){return vec4_add}),r.d(a,"subtract",function(){return vec4_subtract}),r.d(a,"multiply",function(){return vec4_multiply}),r.d(a,"divide",function(){return divide}),r.d(a,"ceil",function(){return ceil}),r.d(a,"floor",function(){return floor}),r.d(a,"min",function(){return vec4_min}),r.d(a,"max",function(){return vec4_max}),r.d(a,"round",function(){return round}),r.d(a,"scale",function(){return vec4_scale}),r.d(a,"scaleAndAdd",function(){return scaleAndAdd}),r.d(a,"distance",function(){return distance}),r.d(a,"squaredDistance",function(){return squaredDistance}),r.d(a,"length",function(){return vec4_length}),r.d(a,"squaredLength",function(){return squaredLength}),r.d(a,"negate",function(){return negate}),r.d(a,"inverse",function(){return inverse}),r.d(a,"normalize",function(){return normalize}),r.d(a,"dot",function(){return dot}),r.d(a,"lerp",function(){return lerp}),r.d(a,"random",function(){return random}),r.d(a,"transformMat4",function(){return transformMat4}),r.d(a,"transformQuat",function(){return transformQuat}),r.d(a,"str",function(){return vec4_str}),r.d(a,"exactEquals",function(){return vec4_exactEquals}),r.d(a,"equals",function(){return vec4_equals}),r.d(a,"sub",function(){return P}),r.d(a,"mul",function(){return I}),r.d(a,"div",function(){return S}),r.d(a,"dist",function(){return E}),r.d(a,"sqrDist",function(){return N}),r.d(a,"len",function(){return C}),r.d(a,"sqrLen",function(){return F}),r.d(a,"forEach",function(){return A});var i=r(6),o=r.n(i),s=r(3),u=r.n(s),c=r(7),l=r.n(c),f=r(0),h=r.n(f),d=r(1),p=r.n(d),_=r(12),m=r(13);function getRsysFromTile(e,t,r){return{center:{x:(e+.5)/Math.pow(2,r)*2-1,y:2*(1-(t+.5)/Math.pow(2,r))-1},scale:1/Math.pow(2,r)}}var v=r(8),g=r.n(v),b=1e-6,w="undefined"!=typeof Float32Array?Float32Array:Array,k=Math.random;Math.PI;function create(){var e=new w(16);return w!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function clone(e){var t=new w(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function copy(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function fromValues(e,t,r,n,a,i,o,s,u,c,l,f,h,d,p,_){var y=new w(16);return y[0]=e,y[1]=t,y[2]=r,y[3]=n,y[4]=a,y[5]=i,y[6]=o,y[7]=s,y[8]=u,y[9]=c,y[10]=l,y[11]=f,y[12]=h,y[13]=d,y[14]=p,y[15]=_,y}function set(e,t,r,n,a,i,o,s,u,c,l,f,h,d,p,_,y){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e[4]=i,e[5]=o,e[6]=s,e[7]=u,e[8]=c,e[9]=l,e[10]=f,e[11]=h,e[12]=d,e[13]=p,e[14]=_,e[15]=y,e}function identity(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function transpose(e,t){if(e===t){var r=t[1],n=t[2],a=t[3],i=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=i,e[11]=t[14],e[12]=a,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function invert(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],d=t[11],p=t[12],_=t[13],y=t[14],m=t[15],v=r*s-n*o,g=r*u-a*o,b=r*c-i*o,x=n*u-a*s,w=n*c-i*s,k=a*c-i*u,M=l*_-f*p,T=l*y-h*p,P=l*m-d*p,z=f*y-h*_,I=f*m-d*_,S=h*m-d*y,E=v*S-g*I+b*z+x*P-w*T+k*M;return E?(E=1/E,e[0]=(s*S-u*I+c*z)*E,e[1]=(a*I-n*S-i*z)*E,e[2]=(_*k-y*w+m*x)*E,e[3]=(h*w-f*k-d*x)*E,e[4]=(u*P-o*S-c*T)*E,e[5]=(r*S-a*P+i*T)*E,e[6]=(y*b-p*k-m*g)*E,e[7]=(l*k-h*b+d*g)*E,e[8]=(o*I-s*P+c*M)*E,e[9]=(n*P-r*I-i*M)*E,e[10]=(p*w-_*b+m*v)*E,e[11]=(f*b-l*w-d*v)*E,e[12]=(s*T-o*z-u*M)*E,e[13]=(r*z-n*T+a*M)*E,e[14]=(_*g-p*x-y*v)*E,e[15]=(l*x-f*g+h*v)*E,e):null}function adjoint(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],d=t[11],p=t[12],_=t[13],y=t[14],m=t[15];return e[0]=s*(h*m-d*y)-f*(u*m-c*y)+_*(u*d-c*h),e[1]=-(n*(h*m-d*y)-f*(a*m-i*y)+_*(a*d-i*h)),e[2]=n*(u*m-c*y)-s*(a*m-i*y)+_*(a*c-i*u),e[3]=-(n*(u*d-c*h)-s*(a*d-i*h)+f*(a*c-i*u)),e[4]=-(o*(h*m-d*y)-l*(u*m-c*y)+p*(u*d-c*h)),e[5]=r*(h*m-d*y)-l*(a*m-i*y)+p*(a*d-i*h),e[6]=-(r*(u*m-c*y)-o*(a*m-i*y)+p*(a*c-i*u)),e[7]=r*(u*d-c*h)-o*(a*d-i*h)+l*(a*c-i*u),e[8]=o*(f*m-d*_)-l*(s*m-c*_)+p*(s*d-c*f),e[9]=-(r*(f*m-d*_)-l*(n*m-i*_)+p*(n*d-i*f)),e[10]=r*(s*m-c*_)-o*(n*m-i*_)+p*(n*c-i*s),e[11]=-(r*(s*d-c*f)-o*(n*d-i*f)+l*(n*c-i*s)),e[12]=-(o*(f*y-h*_)-l*(s*y-u*_)+p*(s*h-u*f)),e[13]=r*(f*y-h*_)-l*(n*y-a*_)+p*(n*h-a*f),e[14]=-(r*(s*y-u*_)-o*(n*y-a*_)+p*(n*u-a*s)),e[15]=r*(s*h-u*f)-o*(n*h-a*f)+l*(n*u-a*s),e}function determinant(e){var t=e[0],r=e[1],n=e[2],a=e[3],i=e[4],o=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11],d=e[12],p=e[13],_=e[14],y=e[15];return(t*o-r*i)*(f*y-h*_)-(t*s-n*i)*(l*y-h*p)+(t*u-a*i)*(l*_-f*p)+(r*s-n*o)*(c*y-h*d)-(r*u-a*o)*(c*_-f*d)+(n*u-a*s)*(c*p-l*d)}function multiply(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=t[9],d=t[10],p=t[11],_=t[12],y=t[13],m=t[14],v=t[15],g=r[0],b=r[1],x=r[2],w=r[3];return e[0]=g*n+b*s+x*f+w*_,e[1]=g*a+b*u+x*h+w*y,e[2]=g*i+b*c+x*d+w*m,e[3]=g*o+b*l+x*p+w*v,g=r[4],b=r[5],x=r[6],w=r[7],e[4]=g*n+b*s+x*f+w*_,e[5]=g*a+b*u+x*h+w*y,e[6]=g*i+b*c+x*d+w*m,e[7]=g*o+b*l+x*p+w*v,g=r[8],b=r[9],x=r[10],w=r[11],e[8]=g*n+b*s+x*f+w*_,e[9]=g*a+b*u+x*h+w*y,e[10]=g*i+b*c+x*d+w*m,e[11]=g*o+b*l+x*p+w*v,g=r[12],b=r[13],x=r[14],w=r[15],e[12]=g*n+b*s+x*f+w*_,e[13]=g*a+b*u+x*h+w*y,e[14]=g*i+b*c+x*d+w*m,e[15]=g*o+b*l+x*p+w*v,e}function translate(e,t,r){var n=r[0],a=r[1],i=r[2],o=void 0,s=void 0,u=void 0,c=void 0,l=void 0,f=void 0,h=void 0,d=void 0,p=void 0,_=void 0,y=void 0,m=void 0;return t===e?(e[12]=t[0]*n+t[4]*a+t[8]*i+t[12],e[13]=t[1]*n+t[5]*a+t[9]*i+t[13],e[14]=t[2]*n+t[6]*a+t[10]*i+t[14],e[15]=t[3]*n+t[7]*a+t[11]*i+t[15]):(o=t[0],s=t[1],u=t[2],c=t[3],l=t[4],f=t[5],h=t[6],d=t[7],p=t[8],_=t[9],y=t[10],m=t[11],e[0]=o,e[1]=s,e[2]=u,e[3]=c,e[4]=l,e[5]=f,e[6]=h,e[7]=d,e[8]=p,e[9]=_,e[10]=y,e[11]=m,e[12]=o*n+l*a+p*i+t[12],e[13]=s*n+f*a+_*i+t[13],e[14]=u*n+h*a+y*i+t[14],e[15]=c*n+d*a+m*i+t[15]),e}function mat4_scale(e,t,r){var n=r[0],a=r[1],i=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*a,e[5]=t[5]*a,e[6]=t[6]*a,e[7]=t[7]*a,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function rotate(e,t,r,n){var a,i,o,s,u,c,l,f,h,d,p,_,y,m,v,g,x,w,k,M,T,P,z,I,S=n[0],E=n[1],N=n[2],C=Math.sqrt(S*S+E*E+N*N);return C<b?null:(S*=C=1/C,E*=C,N*=C,a=Math.sin(r),o=1-(i=Math.cos(r)),s=t[0],u=t[1],c=t[2],l=t[3],f=t[4],h=t[5],d=t[6],p=t[7],_=t[8],y=t[9],m=t[10],v=t[11],g=S*S*o+i,x=E*S*o+N*a,w=N*S*o-E*a,k=S*E*o-N*a,M=E*E*o+i,T=N*E*o+S*a,P=S*N*o+E*a,z=E*N*o-S*a,I=N*N*o+i,e[0]=s*g+f*x+_*w,e[1]=u*g+h*x+y*w,e[2]=c*g+d*x+m*w,e[3]=l*g+p*x+v*w,e[4]=s*k+f*M+_*T,e[5]=u*k+h*M+y*T,e[6]=c*k+d*M+m*T,e[7]=l*k+p*M+v*T,e[8]=s*P+f*z+_*I,e[9]=u*P+h*z+y*I,e[10]=c*P+d*z+m*I,e[11]=l*P+p*z+v*I,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function rotateX(e,t,r){var n=Math.sin(r),a=Math.cos(r),i=t[4],o=t[5],s=t[6],u=t[7],c=t[8],l=t[9],f=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*a+c*n,e[5]=o*a+l*n,e[6]=s*a+f*n,e[7]=u*a+h*n,e[8]=c*a-i*n,e[9]=l*a-o*n,e[10]=f*a-s*n,e[11]=h*a-u*n,e}function rotateY(e,t,r){var n=Math.sin(r),a=Math.cos(r),i=t[0],o=t[1],s=t[2],u=t[3],c=t[8],l=t[9],f=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*a-c*n,e[1]=o*a-l*n,e[2]=s*a-f*n,e[3]=u*a-h*n,e[8]=i*n+c*a,e[9]=o*n+l*a,e[10]=s*n+f*a,e[11]=u*n+h*a,e}function rotateZ(e,t,r){var n=Math.sin(r),a=Math.cos(r),i=t[0],o=t[1],s=t[2],u=t[3],c=t[4],l=t[5],f=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*a+c*n,e[1]=o*a+l*n,e[2]=s*a+f*n,e[3]=u*a+h*n,e[4]=c*a-i*n,e[5]=l*a-o*n,e[6]=f*a-s*n,e[7]=h*a-u*n,e}function fromTranslation(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function fromScaling(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fromRotation(e,t,r){var n,a,i,o=r[0],s=r[1],u=r[2],c=Math.sqrt(o*o+s*s+u*u);return c<b?null:(o*=c=1/c,s*=c,u*=c,n=Math.sin(t),i=1-(a=Math.cos(t)),e[0]=o*o*i+a,e[1]=s*o*i+u*n,e[2]=u*o*i-s*n,e[3]=0,e[4]=o*s*i-u*n,e[5]=s*s*i+a,e[6]=u*s*i+o*n,e[7]=0,e[8]=o*u*i+s*n,e[9]=s*u*i-o*n,e[10]=u*u*i+a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function fromXRotation(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fromYRotation(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fromZRotation(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fromRotationTranslation(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=n+n,u=a+a,c=i+i,l=n*s,f=n*u,h=n*c,d=a*u,p=a*c,_=i*c,y=o*s,m=o*u,v=o*c;return e[0]=1-(d+_),e[1]=f+v,e[2]=h-m,e[3]=0,e[4]=f-v,e[5]=1-(l+_),e[6]=p+y,e[7]=0,e[8]=h+m,e[9]=p-y,e[10]=1-(l+d),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function fromQuat2(e,t){var r=new w(3),n=-t[0],a=-t[1],i=-t[2],o=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=n*n+a*a+i*i+o*o;return f>0?(r[0]=2*(s*o+l*n+u*i-c*a)/f,r[1]=2*(u*o+l*a+c*n-s*i)/f,r[2]=2*(c*o+l*i+s*a-u*n)/f):(r[0]=2*(s*o+l*n+u*i-c*a),r[1]=2*(u*o+l*a+c*n-s*i),r[2]=2*(c*o+l*i+s*a-u*n)),fromRotationTranslation(e,t,r),e}function getTranslation(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function getScaling(e,t){var r=t[0],n=t[1],a=t[2],i=t[4],o=t[5],s=t[6],u=t[8],c=t[9],l=t[10];return e[0]=Math.sqrt(r*r+n*n+a*a),e[1]=Math.sqrt(i*i+o*o+s*s),e[2]=Math.sqrt(u*u+c*c+l*l),e}function getRotation(e,t){var r=t[0]+t[5]+t[10],n=0;return r>0?(n=2*Math.sqrt(r+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n),e}function fromRotationTranslationScale(e,t,r,n){var a=t[0],i=t[1],o=t[2],s=t[3],u=a+a,c=i+i,l=o+o,f=a*u,h=a*c,d=a*l,p=i*c,_=i*l,y=o*l,m=s*u,v=s*c,g=s*l,b=n[0],x=n[1],w=n[2];return e[0]=(1-(p+y))*b,e[1]=(h+g)*b,e[2]=(d-v)*b,e[3]=0,e[4]=(h-g)*x,e[5]=(1-(f+y))*x,e[6]=(_+m)*x,e[7]=0,e[8]=(d+v)*w,e[9]=(_-m)*w,e[10]=(1-(f+p))*w,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function fromRotationTranslationScaleOrigin(e,t,r,n,a){var i=t[0],o=t[1],s=t[2],u=t[3],c=i+i,l=o+o,f=s+s,h=i*c,d=i*l,p=i*f,_=o*l,y=o*f,m=s*f,v=u*c,g=u*l,b=u*f,x=n[0],w=n[1],k=n[2],M=a[0],T=a[1],P=a[2],z=(1-(_+m))*x,I=(d+b)*x,S=(p-g)*x,E=(d-b)*w,N=(1-(h+m))*w,C=(y+v)*w,F=(p+g)*k,A=(y-v)*k,D=(1-(h+_))*k;return e[0]=z,e[1]=I,e[2]=S,e[3]=0,e[4]=E,e[5]=N,e[6]=C,e[7]=0,e[8]=F,e[9]=A,e[10]=D,e[11]=0,e[12]=r[0]+M-(z*M+E*T+F*P),e[13]=r[1]+T-(I*M+N*T+A*P),e[14]=r[2]+P-(S*M+C*T+D*P),e[15]=1,e}function fromQuat(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=r+r,s=n+n,u=a+a,c=r*o,l=n*o,f=n*s,h=a*o,d=a*s,p=a*u,_=i*o,y=i*s,m=i*u;return e[0]=1-f-p,e[1]=l+m,e[2]=h-y,e[3]=0,e[4]=l-m,e[5]=1-c-p,e[6]=d+_,e[7]=0,e[8]=h+y,e[9]=d-_,e[10]=1-c-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function frustum(e,t,r,n,a,i,o){var s=1/(r-t),u=1/(a-n),c=1/(i-o);return e[0]=2*i*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*i*u,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(a+n)*u,e[10]=(o+i)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*i*2*c,e[15]=0,e}function perspective(e,t,r,n,a){var i=1/Math.tan(t/2),o=void 0;return e[0]=i/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=a&&a!==1/0?(o=1/(n-a),e[10]=(a+n)*o,e[14]=2*a*n*o):(e[10]=-1,e[14]=-2*n),e}function perspectiveFromFieldOfView(e,t,r,n){var a=Math.tan(t.upDegrees*Math.PI/180),i=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(o+s),c=2/(a+i);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(o-s)*u*.5,e[9]=(a-i)*c*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function ortho(e,t,r,n,a,i,o){var s=1/(t-r),u=1/(n-a),c=1/(i-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*s,e[13]=(a+n)*u,e[14]=(o+i)*c,e[15]=1,e}function lookAt(e,t,r,n){var a=void 0,i=void 0,o=void 0,s=void 0,u=void 0,c=void 0,l=void 0,f=void 0,h=void 0,d=void 0,p=t[0],_=t[1],y=t[2],m=n[0],v=n[1],g=n[2],x=r[0],w=r[1],k=r[2];return Math.abs(p-x)<b&&Math.abs(_-w)<b&&Math.abs(y-k)<b?identity(e):(l=p-x,f=_-w,h=y-k,a=v*(h*=d=1/Math.sqrt(l*l+f*f+h*h))-g*(f*=d),i=g*(l*=d)-m*h,o=m*f-v*l,(d=Math.sqrt(a*a+i*i+o*o))?(a*=d=1/d,i*=d,o*=d):(a=0,i=0,o=0),s=f*o-h*i,u=h*a-l*o,c=l*i-f*a,(d=Math.sqrt(s*s+u*u+c*c))?(s*=d=1/d,u*=d,c*=d):(s=0,u=0,c=0),e[0]=a,e[1]=s,e[2]=l,e[3]=0,e[4]=i,e[5]=u,e[6]=f,e[7]=0,e[8]=o,e[9]=c,e[10]=h,e[11]=0,e[12]=-(a*p+i*_+o*y),e[13]=-(s*p+u*_+c*y),e[14]=-(l*p+f*_+h*y),e[15]=1,e)}function targetTo(e,t,r,n){var a=t[0],i=t[1],o=t[2],s=n[0],u=n[1],c=n[2],l=a-r[0],f=i-r[1],h=o-r[2],d=l*l+f*f+h*h;d>0&&(l*=d=1/Math.sqrt(d),f*=d,h*=d);var p=u*h-c*f,_=c*l-s*h,y=s*f-u*l;return(d=p*p+_*_+y*y)>0&&(p*=d=1/Math.sqrt(d),_*=d,y*=d),e[0]=p,e[1]=_,e[2]=y,e[3]=0,e[4]=f*y-h*_,e[5]=h*p-l*y,e[6]=l*_-f*p,e[7]=0,e[8]=l,e[9]=f,e[10]=h,e[11]=0,e[12]=a,e[13]=i,e[14]=o,e[15]=1,e}function str(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function frob(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))}function add(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function subtract(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function multiplyScalar(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function multiplyScalarAndAdd(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function exactEquals(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function mat4_equals(e,t){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],d=e[11],p=e[12],_=e[13],y=e[14],m=e[15],v=t[0],g=t[1],x=t[2],w=t[3],k=t[4],M=t[5],T=t[6],P=t[7],z=t[8],I=t[9],S=t[10],E=t[11],N=t[12],C=t[13],F=t[14],A=t[15];return Math.abs(r-v)<=b*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(n-g)<=b*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(a-x)<=b*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(i-w)<=b*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(o-k)<=b*Math.max(1,Math.abs(o),Math.abs(k))&&Math.abs(s-M)<=b*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(u-T)<=b*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(c-P)<=b*Math.max(1,Math.abs(c),Math.abs(P))&&Math.abs(l-z)<=b*Math.max(1,Math.abs(l),Math.abs(z))&&Math.abs(f-I)<=b*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(h-S)<=b*Math.max(1,Math.abs(h),Math.abs(S))&&Math.abs(d-E)<=b*Math.max(1,Math.abs(d),Math.abs(E))&&Math.abs(p-N)<=b*Math.max(1,Math.abs(p),Math.abs(N))&&Math.abs(_-C)<=b*Math.max(1,Math.abs(_),Math.abs(C))&&Math.abs(y-F)<=b*Math.max(1,Math.abs(y),Math.abs(F))&&Math.abs(m-A)<=b*Math.max(1,Math.abs(m),Math.abs(A))}var M=multiply,T=subtract;function vec4_create(){var e=new w(4);return w!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function vec4_clone(e){var t=new w(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function vec4_fromValues(e,t,r,n){var a=new w(4);return a[0]=e,a[1]=t,a[2]=r,a[3]=n,a}function vec4_copy(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function vec4_set(e,t,r,n,a){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e}function vec4_add(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function vec4_subtract(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function vec4_multiply(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function divide(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function ceil(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function floor(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function vec4_min(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function vec4_max(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function round(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function vec4_scale(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function scaleAndAdd(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}function distance(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2],i=t[3]-e[3];return Math.sqrt(r*r+n*n+a*a+i*i)}function squaredDistance(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2],i=t[3]-e[3];return r*r+n*n+a*a+i*i}function vec4_length(e){var t=e[0],r=e[1],n=e[2],a=e[3];return Math.sqrt(t*t+r*r+n*n+a*a)}function squaredLength(e){var t=e[0],r=e[1],n=e[2],a=e[3];return t*t+r*r+n*n+a*a}function negate(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function inverse(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function normalize(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=r*r+n*n+a*a+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=r*o,e[1]=n*o,e[2]=a*o,e[3]=i*o),e}function dot(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function lerp(e,t,r,n){var a=t[0],i=t[1],o=t[2],s=t[3];return e[0]=a+n*(r[0]-a),e[1]=i+n*(r[1]-i),e[2]=o+n*(r[2]-o),e[3]=s+n*(r[3]-s),e}function random(e,t){var r,n,a,i,o,s;t=t||1;do{o=(r=2*k()-1)*r+(n=2*k()-1)*n}while(o>=1);do{s=(a=2*k()-1)*a+(i=2*k()-1)*i}while(s>=1);var u=Math.sqrt((1-o)/s);return e[0]=t*r,e[1]=t*n,e[2]=t*a*u,e[3]=t*i*u,e}function transformMat4(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3];return e[0]=r[0]*n+r[4]*a+r[8]*i+r[12]*o,e[1]=r[1]*n+r[5]*a+r[9]*i+r[13]*o,e[2]=r[2]*n+r[6]*a+r[10]*i+r[14]*o,e[3]=r[3]*n+r[7]*a+r[11]*i+r[15]*o,e}function transformQuat(e,t,r){var n=t[0],a=t[1],i=t[2],o=r[0],s=r[1],u=r[2],c=r[3],l=c*n+s*i-u*a,f=c*a+u*n-o*i,h=c*i+o*a-s*n,d=-o*n-s*a-u*i;return e[0]=l*c+d*-o+f*-u-h*-s,e[1]=f*c+d*-s+h*-o-l*-u,e[2]=h*c+d*-u+l*-s-f*-o,e[3]=t[3],e}function vec4_str(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function vec4_exactEquals(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function vec4_equals(e,t){var r=e[0],n=e[1],a=e[2],i=e[3],o=t[0],s=t[1],u=t[2],c=t[3];return Math.abs(r-o)<=b*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=b*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-u)<=b*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(i-c)<=b*Math.max(1,Math.abs(i),Math.abs(c))}var P=vec4_subtract,I=vec4_multiply,S=divide,E=distance,N=squaredDistance,C=vec4_length,F=squaredLength,A=function(){var e=vec4_create();return function(t,r,n,a,i,o){var s=void 0,u=void 0;for(r||(r=4),n||(n=0),u=a?Math.min(a*r+n,t.length):t.length,s=n;s<u;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],i(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}(),D=function average(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t/e.length},O=r(4),V=r.n(O),R=r(2),B=r.n(R),L=r(5),Z=r.n(L),q=r(23),j=function(e){function CartoError(e){var t;if(h()(this,CartoError),!e)throw Error("Invalid CartoError, a message is mandatory");if(!e.message)throw Error("Invalid CartoError, a message is mandatory");if(!e.type)throw Error("Invalid CartoError, a type is mandatory");return(t=V()(this,B()(CartoError).call(this,"".concat(e.type," ").concat(e.message)))).name="CartoError",t.type=e.type,t.originalError=e,t}return Z()(CartoError,e),CartoError}(r.n(q)()(Error)),G=function(e){function CartoValidationError(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:U.DEFAULT;return h()(this,CartoValidationError),(t=V()(this,B()(CartoValidationError).call(this,{message:e,type:r}))).name="CartoValidationError",t}return Z()(CartoValidationError,e),CartoValidationError}(j),U={DEFAULT:"[Error]",MISSING_REQUIRED:"[Missing required property]",INCORRECT_TYPE:"[Property with an incorrect type]",INCORRECT_VALUE:"[Incorrect value]",TOO_MANY_ARGS:"[Too many arguments]",NOT_ENOUGH_ARGS:"[Not enough arguments]",WRONG_NUMBER_ARGS:"[Wrong number of arguments]"},W={UNKNOWN:"unknown",POINT:"point",LINE:"line",POLYGON:"polygon"};function geometry_sub(e,t){var r=o()(e,2),n=r[0],a=r[1],i=o()(t,2);return[n-i[0],a-i[1]]}function geometry_dot(e,t){var r=o()(e,2),n=r[0],a=r[1],i=o()(t,2);return n*i[0]+a*i[1]}function perpendicular(e){var t=o()(e,2),r=t[0];return[-t[1],r]}function getLineNormal(e,t){var r=function geometry_normalize(e,t){var r=Math.hypot(e,t);return[e/r,t/r]}(e[0]-t[0],e[1]-t[1]);return[-r[1],r[0]]}function getJoinNormal(e,t){var r=[e[1],-e[0]],n=[-t[1],t[0]],a=n[0]*r[1]-n[1]*r[0],i=n[0]*r[0]+n[1]*r[1],o=Math.abs(a);return{turnLeft:a>0,joinNormal:!(o<.866&&i>.5)&&neg([(r[0]+n[0])/o,(r[1]+n[1])/o])}}function neg(e){return[-e[0],-e[1]]}function halfPlaneSign(e,t,r){return(e.x-r.x)*(t.y-r.y)-(t.x-r.x)*(e.y-r.y)}function equalPoints(e,t){return e.x===t.x&&e.y===t.y}function computeCentroids(e,t){switch(t){case W.POINT:return function _computeCentroidsForPoints(e){for(var t=[],r=0;r<e.vertices.length/6;r++){var n=6*r,a=n+6,i=e.vertices.slice(n,a),s=o()(i,6),u=s[4],c=s[5];t.push({x:u,y:c})}return t}(e);case W.LINE:case W.POLYGON:return function _computeCentroidsForLinesOrPolygons(e,t){var r=[],n=0;return e.breakpoints.forEach(function(a){var i=e.vertices.slice(n,a),s=null;s=t===W.LINE?function _centroidForLines(e){for(var t=[],r=[],n=0;n<e.length/6;n++){var a=6*n,i=a+6,s=e.slice(a,i),u=o()(s,6),c=u[0],l=u[1],f=u[2],h=u[3],d=u[4],p=u[5],_=c===f&&l===h,y=f===d&&h===p;if(!_||!y){var m=[c,l],v=_?[d,p]:[f,h];t.push(m[0]),t.push(v[0]),r.push(m[1]),r.push(v[1])}}return{x:D(t),y:D(r)}}(i):function _centroidForPolygons(e){for(var t=[],r=[],n=[],a=0;a<e.length/6;a++){var i=6*a,s=i+6,u=e.slice(i,s),c=o()(u,6),l=c[0],f=c[1],h=c[2],d=c[3],p=c[4],_=c[5],y=[[l,f],[h,d],[p,_]],m=triangleArea(y);if(m>0){var v=D([l,h,p]),g=D([f,d,_]);t.push(v*m),r.push(g*m),n.push(m)}}var b=_sumArray(n);return{x:_sumArray(t)/b,y:_sumArray(r)/b}}(i),r.push(s),n=a}),r}(e,t);default:throw new G("Invalid type argument, decoded geometry must have a point, line or polygon type.",U.INCORRECT_VALUE)}}function _sumArray(e){return e.reduce(function(e,t){return e+t},0)}function triangleArea(e){var t=o()(e[0],2),r=t[0],n=t[1],a=o()(e[1],2),i=a[0],s=a[1],u=o()(e[2],2),c=u[0],l=u[1];return Math.abs((r-c)*(s-n)-(r-i)*(l-n))/2}function _updateAABBForGeometry(e,t,r){switch(r){case W.LINE:return function _updateAABBLine(e,t){for(var r=e,n=e.length,a=0;a<n;a+=2)t.minx=Math.min(t.minx,r[a+0]),t.miny=Math.min(t.miny,r[a+1]),t.maxx=Math.max(t.maxx,r[a+0]),t.maxy=Math.max(t.maxy,r[a+1]);return t}(e,t);case W.POLYGON:return function _updateAABBPolygon(e,t){for(var r=[e.flat,e.holes[0]||e.flat.length/2],n=r[0],a=r[1],i=0;i<a;i++)t.minx=Math.min(t.minx,n[2*i+0]),t.miny=Math.min(t.miny,n[2*i+1]),t.maxx=Math.max(t.maxx,n[2*i+0]),t.maxy=Math.max(t.maxy,n[2*i+1]);return t}(e,t)}}var Y={intersect:function geometry_intersect(e,t,r,n){var a=e,i=r,o=geometry_sub(t,e),s=geometry_sub(n,r),u=perpendicular(o),c=perpendicular(s),l=geometry_dot(geometry_sub(i,a),c)/geometry_dot(o,c),f=geometry_dot(geometry_sub(a,i),u)/geometry_dot(s,u);if(l>=0&&l<=1&&f>=0&&f<=1)return[a[0]+l*o[0],a[1]+l*o[1]]},sub:geometry_sub,dot:geometry_dot,perpendicular:perpendicular,getLineNormal:getLineNormal,getJoinNormal:getJoinNormal,neg:neg,halfPlaneSign:halfPlaneSign,pointInTriangle:function pointInTriangle(e,t,r,n){if(equalPoints(t,r)||equalPoints(r,n)||equalPoints(n,t))return!1;var a=halfPlaneSign(e,t,r)<0,i=halfPlaneSign(e,r,n)<0,o=halfPlaneSign(e,n,t)<0;return a===i&&i===o},equalPoints:equalPoints,pointInCircle:function pointInCircle(e,t,r){var n=e.x-t.x,a=e.y-t.y;return n*n+a*a<=r*r},pointInRectangle:function pointInRectangle(e,t){if(null===t)return!1;var r=e.x.toFixed(2),n=e.y.toFixed(2);return t.minx<=r&&r<=t.maxx&&t.miny<=n&&n<=t.maxy}},Q=function Polygon(){h()(this,Polygon),this.flat=[],this.holes=[],this.clipped=[],this.clippedType=[]};function decodeLines(e,t){var r=[];return e.map(function(e){var n=[];e.map(function(e){n.push([2*e.x/t-1,2*(1-e.y/t)-1])}),r.push.apply(r,g()(function clipLine(e){var t=[],r=[];function clipType(e){for(var t=0,r=0;r<J;r++)t|=H[r].inside(e)?0:1<<r;return t}function intersect(e,t,r){for(var n=0;n<J;n++){var a=1<<n;if(r&a){var i=H[n].intersect(e,t);return r=clipType(i)&~a,[i,r]}}}for(var n=e[0],a=clipType(n),i=1;i<e.length;++i){for(var s=e[i],u=clipType(s),c=u,l=s;;){if(!(a|u)){var f,h;if((f=t).push.apply(f,g()(n)),u!==c)(h=t).push.apply(h,g()(s)),i<e.length-1&&(r.push(t),t=[]);else if(i===e.length-1){var d;(d=t).push.apply(d,g()(s))}break}if(a&u)break;if(a){var p=intersect(n,s,a),_=o()(p,2);n=_[0],a=_[1]}else{var y=intersect(n,s,u),m=o()(y,2);s=m[0],u=m[1]}}n=l,a=c}(t=function _removeDuplicatedVerticesOnLine(e){for(var t,r,n=[],a=0;a<e.length;a+=2){var i=e[a],o=e[a+1];i===t&&o===r||(n.push(i,o),t=i,r=o)}return n}(t)).length>0&&r.push(t);return r}(n)))}),r}function decodePolygons(e,t){var r,n=null,a=[];return e.forEach(function(e){var i=function signedPolygonArea(e){for(var t=0,r=0;r<e.length;r++){var n=(r+1)%e.length;t+=e[r].x*e[n].y,t-=e[n].x*e[r].y}return t/2}(e);if(0!==i){void 0===r&&(r=i>0);var o=r?i>0:i<0,s=function _getPreClippedVertices(e,t){return e.map(function(e){var r=e.x,n=e.y;return[r=2*r/t-1,n=2*(1-n/t)-1]})}(e,t);o&&(n&&a.push(n),n=new Q),n=function clipPolygon(e,t,r){for(var n={},a=function _loop(t){for(var r=[],a={},i=function setClippedType(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,i=0;t>=0&&(i=n[t]||0),r>=0&&(i|=1<<r),i&&(a[e]=i)},o=0;o<e.length-1;o++){var s=e[o],u=e[o+1],c=H[t].inside(s),l=H[t].inside(u);if(c&&l)i(r.length,o+1),r.push(u);else if(c){var f=H[t].intersect(s,u);i(r.length,o+1,t),r.push(f)}else if(l){var h=H[t].intersect(s,u);i(r.length,o,t),r.push(h),i(r.length,o+1),r.push(u)}}r.length&&(a[0]&&(a[r.length]=a[0]),r.push(r[0])),e=r,n=a},i=0;i<J;i++)a(i);e.length>=4&&(r&&t.holes.push(t.flat.length/2),e.forEach(function(e){t.flat.push(e[0],e[1])}),Object.keys(n).forEach(function(e){t.clipped.push(2*Number(e)),t.clippedType.push(n[e])}));return t}(s,n,!o)}}),n&&a.push(n),a}var H=[{inside:function inside(e){return e[0]<=1},intersect:function intersect(e,t){return Y.intersect(e,t,[1,-100],[1,100])}},{inside:function inside(e){return e[1]<=1},intersect:function intersect(e,t){return Y.intersect(e,t,[-100,1],[100,1])}},{inside:function inside(e){return e[0]>=-1},intersect:function intersect(e,t){return Y.intersect(e,t,[-1,-100],[-1,100])}},{inside:function inside(e){return e[1]>=-1},intersect:function intersect(e,t){return Y.intersect(e,t,[-100,-1],[100,-1])}}],J=H.length;var $=function(e){function CartoRuntimeError(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:K.DEFAULT;return h()(this,CartoRuntimeError),(t=V()(this,B()(CartoRuntimeError).call(this,{message:e,type:r}))).name="CartoRuntimeError",t}return Z()(CartoRuntimeError,e),CartoRuntimeError}(j),K={DEFAULT:"[Error]",NOT_SUPPORTED:"[Not supported]",WEB_GL:"[WebGL]",MVT:"[MVT]"},X=function(){function BaseCodec(e,t){h()(this,BaseCodec),e&&t&&(this._baseName=e.baseName(t))}return p()(BaseCodec,[{key:"isRange",value:function isRange(){return!1}},{key:"isIdentity",value:function isIdentity(){return!1}},{key:"sourceToInternal",value:function sourceToInternal(e,t){return t}},{key:"internalToExternal",value:function internalToExternal(e,t){return t}},{key:"externalToSource",value:function externalToSource(e,t){return t}},{key:"sourceToExternal",value:function sourceToExternal(e,t){return this.internalToExternal(e,this.sourceToInternal(e,t))}},{key:"externalToInternal",value:function externalToInternal(e,t){return this.sourceToInternal(e,this.externalToSource(e,t))}},{key:"inlineInternalMatch",value:function inlineInternalMatch(e,t){return"".concat(e)}}]),BaseCodec}(),ee=function(e){function IdentityCodec(){return h()(this,IdentityCodec),V()(this,B()(IdentityCodec).apply(this,arguments))}return Z()(IdentityCodec,e),p()(IdentityCodec,[{key:"isIdentity",value:function isIdentity(){return!0}},{key:"sourceToInternal",value:function sourceToInternal(e,t){return t}},{key:"internalToExternal",value:function internalToExternal(e,t){return t}},{key:"sourceToExternal",value:function sourceToExternal(e,t){return t}},{key:"externalToSource",value:function externalToSource(e,t){return t}},{key:"externalToInternal",value:function externalToInternal(e,t){return t}}]),IdentityCodec}(X),te=4096,re="cartodb_id",ne=function(){function Metadata(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{properties:{}},r=t.properties,n=t.featureCount,a=t.sample,i=t.geomType,o=t.isAggregated,s=t.idProperty,u=t.extent;h()(this,Metadata),this.properties=r,this.featureCount=n,this.sample=a,this.geomType=i,this.isAggregated=o,this.idProperty=s||re,this.properties.hasOwnProperty(this.idProperty)||(this.properties[this.idProperty]={type:"number"}),this.categoryToID=new Map,this.IDToCategory=new Map,this.numCategories=0,this.extent=u||te,Object.values(r).map(function(t){t.categories=t.categories||[],t.categories.map(function(r){return e.categorizeString(t,r.name,!0)})}),this.propertyKeys=Object.keys(r)}return p()(Metadata,[{key:"setCodecs",value:function setCodecs(){throw new $('You must call "setCodecs" once you have determined the proper subclass')}},{key:"categorizeString",value:function categorizeString(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===t&&(t=null),this.categoryToID.has(t))return this.categoryToID.get(t);r||null===t||this.properties[e].categories.push({name:t,frequency:Number.NaN});var n=null===t?-(1<<24):this.numCategories;return this.categoryToID.set(t,n),this.IDToCategory.set(n,t),this.numCategories++,n}},{key:"decodedProperties",value:function decodedProperties(e){return[e]}},{key:"baseName",value:function baseName(e){return e}},{key:"sourcePropertyName",value:function sourcePropertyName(e){return e}},{key:"stats",value:function stats(e){return this.properties[e]}},{key:"codec",value:function codec(e){var t=this.baseName(e);return this.properties[t]&&this.properties[t].codec?this.properties[t].codec:new ee}}]),Metadata}(),ae=r(10),ie=r.n(ae),oe=r(11),se=r.n(oe),ue=function(e){function NumberCodec(){return h()(this,NumberCodec),V()(this,B()(NumberCodec).apply(this,arguments))}return Z()(NumberCodec,e),p()(NumberCodec,[{key:"sourceToInternal",value:function sourceToInternal(e,t){return(isNaN(t)||null==t)&&(t=-(1<<24)),t}},{key:"internalToExternal",value:function internalToExternal(e,t){return t===-(1<<24)&&(t=null),t}},{key:"externalToInternal",value:function externalToInternal(e,t){return null===t&&(t=-(1<<24)),t}}]),NumberCodec}(ee),ce=function(e){function MVTNumberCodec(){return h()(this,MVTNumberCodec),V()(this,B()(MVTNumberCodec).apply(this,arguments))}return Z()(MVTNumberCodec,e),p()(MVTNumberCodec,[{key:"sourceToInternal",value:function sourceToInternal(e,t){var r=ie()(t);if(null!==t&&"undefined"!==r&&"number"!==r)throw new $("MVT decoding error. Metadata property '".concat(this._baseName,"' is of type 'number' but the MVT tile contained a feature property of type '").concat(r,"': '").concat(t,"'"),K.MVT);return se()(B()(MVTNumberCodec.prototype),"sourceToInternal",this).call(this,e,t)}}]),MVTNumberCodec}(ue),le=function(e){function CategoryCodec(){return h()(this,CategoryCodec),V()(this,B()(CategoryCodec).apply(this,arguments))}return Z()(CategoryCodec,e),p()(CategoryCodec,[{key:"sourceToInternal",value:function sourceToInternal(e,t){return e.categorizeString(this._baseName,t)}},{key:"internalToExternal",value:function internalToExternal(e,t){return e.IDToCategory.get(t)}},{key:"sourceToExternal",value:function sourceToExternal(e,t){return t}},{key:"externalToSource",value:function externalToSource(e,t){return t}}]),CategoryCodec}(X),fe=function(e){function MVTCategoryCodec(){return h()(this,MVTCategoryCodec),V()(this,B()(MVTCategoryCodec).apply(this,arguments))}return Z()(MVTCategoryCodec,e),p()(MVTCategoryCodec,[{key:"sourceToInternal",value:function sourceToInternal(e,t){var r=ie()(t);if(null!==t&&"undefined"!==r&&"string"!==r)throw new $("MVT decoding error. Metadata property '".concat(this._baseName,"' is of type 'category' but the MVT tile contained a feature property of type '").concat(r,"': '").concat(t,"'"),K.MVT);return se()(B()(MVTCategoryCodec.prototype),"sourceToInternal",this).call(this,e,t)}}]),MVTCategoryCodec}(le);var he=function(e){function MVTMetadata(){return h()(this,MVTMetadata),V()(this,B()(MVTMetadata).apply(this,arguments))}return Z()(MVTMetadata,e),p()(MVTMetadata,[{key:"setCodecs",value:function setCodecs(){var e=this;Object.keys(this.properties).forEach(function(t){var r=e.properties[t],n=r.type;"geometry"!==n&&(r.codec=function MVTCodecFactory(e,t,r){switch(t){case"number":return new ce(e,r);case"category":return new fe(e,r);default:throw new $("MVT decoding error. Feature property value of type '".concat(t,"' cannot be decoded."),K.MVT)}}(e,n,t))})}}]),MVTMetadata}(ne);function addLineString(e,t,r,n,a){var i,o,s,u,c;if(e.length>=4){i=[e[0],e[1]];for(var l=2;l<=e.length;l+=2)if(o=[e[l],e[l+1]],i[0]!==o[0]||i[1]!==o[1]){l+=2;break}for(s=getLineNormal(i,o);l<=e.length;l+=2){c=!(a&&a(l));var f=void 0;if(l<=e.length-2?f=[e[l],e[l+1]]:n&&(f=[e[2],e[3]]),!c||i[0]===o[0]&&i[1]===o[1]||(t.vertices[r]=i[0],t.normals[r++]=-s[0],t.vertices[r]=i[1],t.normals[r++]=-s[1],t.vertices[r]=i[0],t.normals[r++]=s[0],t.vertices[r]=i[1],t.normals[r++]=s[1],t.vertices[r]=o[0],t.normals[r++]=s[0],t.vertices[r]=o[1],t.normals[r++]=s[1],t.vertices[r]=i[0],t.normals[r++]=-s[0],t.vertices[r]=i[1],t.normals[r++]=-s[1],t.vertices[r]=o[0],t.normals[r++]=s[0],t.vertices[r]=o[1],t.normals[r++]=s[1],t.vertices[r]=o[0],t.normals[r++]=-s[0],t.vertices[r]=o[1],t.normals[r++]=-s[1]),!f||f[0]===o[0]&&f[1]===o[1])u=s;else if(u=getLineNormal(o,f),c){var h=getJoinNormal(s,u),d=h.turnLeft,p=h.joinNormal,_=d?s:neg(u),y=d?u:neg(s);t.vertices[r]=o[0],t.normals[r++]=0,t.vertices[r]=o[1],t.normals[r++]=n?1e-37:0,t.vertices[r]=o[0],t.normals[r++]=_[0],t.vertices[r]=o[1],t.normals[r++]=_[1],t.vertices[r]=o[0],t.normals[r++]=y[0],t.vertices[r]=o[1],t.normals[r++]=y[1],p&&(t.vertices[r]=o[0],t.normals[r++]=p[0],t.vertices[r]=o[1],t.normals[r++]=p[1],t.vertices[r]=o[0],t.normals[r++]=y[0],t.vertices[r]=o[1],t.normals[r++]=y[1],t.vertices[r]=o[0],t.normals[r++]=_[0],t.vertices[r]=o[1],t.normals[r++]=_[1])}i=o,o=f,s=u}}return r}function resizeBuffer(e,t){var r=new Float32Array(t);return r.set(e),r}var de=24,pe=0,_e={vertices:new Float32Array(1048576),normals:new Float32Array(1048576)};function resizeBuffers(e){var t=pe+e;if(t>_e.vertices.length){var r=2*t;_e.vertices=resizeBuffer(_e.vertices,r),_e.normals=resizeBuffer(_e.normals,r)}}var ye=r(24),me=2,ve=24,ge=0,be={vertices:new Float32Array(2097152),normals:new Float32Array(2097152)};function polygonDecoder_resizeBuffers(e){var t=ge+e;if(t>be.vertices.length){var r=2*t;be.vertices=resizeBuffer(be.vertices,r),be.normals=resizeBuffer(be.normals,r)}}function addVertex(e,t){be.vertices[ge]=e[t],be.normals[ge++]=0,be.vertices[ge]=e[t+1],be.normals[ge++]=0}function isClipped(e,t,r){return!!(e.clipped.includes(t)&&e.clipped.includes(r)&&e.clippedType[e.clipped.indexOf(t)]&e.clippedType[e.clipped.indexOf(r)])}function decodeGeom(e,t){switch(e){case W.POINT:return function decodePoint(e){return{verticesArrayBuffer:e,vertices:new Float32Array(e),breakpoints:[]}}(t);case W.LINE:return function decodeLine(e){var t=[],r=new Map;pe=0;for(var n=0;n<e.length;n++){for(var a=e[n],i=0;i<a.length;i++)resizeBuffers(de*a[i].length),pe=addLineString(a[i],_e,pe);r.set(t.length,0===t.length?{start:0,end:pe}:{start:r.get(t.length-1).end,end:pe}),t.push(pe)}for(var o=new ArrayBuffer(4*pe),s=new ArrayBuffer(4*pe),u=new Float32Array(o),c=new Float32Array(s),l=0;l<pe;l++)u[l]=_e.vertices[l],c[l]=_e.normals[l];return{vertices:u,normals:c,verticesArrayBuffer:o,normalsArrayBuffer:s,featureIDToVertexIndex:r,breakpoints:t}}(t);case W.POLYGON:return function decodePolygon(e){var t=[],r=new Map;ge=0;for(var n=0;n<e.length;n++){for(var a=e[n],i=function _loop(e){var t=a[e],r=ye(t.flat,t.holes);polygonDecoder_resizeBuffers(me*r.length+ve*t.flat.length);for(var n=0;n<r.length;n++)addVertex(t.flat,2*r[n]);ge=addLineString(t.flat,be,ge,!0,function(e){return t.holes.includes((e-2)/2)||isClipped(t,e-4,e-2)})},o=0;o<a.length;o++)i(o);r.set(t.length,0===t.length?{start:0,end:ge}:{start:r.get(t.length-1).end,end:ge}),t.push(ge)}for(var s=new ArrayBuffer(4*ge),u=new ArrayBuffer(4*ge),c=new Float32Array(s),l=new Float32Array(u),f=0;f<ge;f++)c[f]=be.vertices[f],l[f]=be.normals[f];return{vertices:c,normals:l,verticesArrayBuffer:s,normalsArrayBuffer:u,featureIDToVertexIndex:r,breakpoints:t}}(t);default:throw new $("Unimplemented geometry type: '".concat(e,"'."),K.NOT_SUPPORTED)}}var xe=function DummyDataframe(e){var t=e.active,r=e.center,n=e.properties,a=e.propertiesArrayBuffer,i=e.scale,o=e.type,s=e.geom,u=e.size,c=e.metadata,l=e.x,f=e.y,d=e.z;h()(this,DummyDataframe),this.active=t,this.center=r,this.properties=n,this.propertiesArrayBuffer=a,this.scale=i,this.type=o,this.decodedGeom=decodeGeom(o,s),this.numVertex=o===W.POINT?3*u:this.decodedGeom.vertices.length/2,this.numFeatures=o===W.POINT?u:this.decodedGeom.breakpoints.length||this.numVertex,this.propertyTex=[],this.metadata=c,this.propertyCount=0,this.x=l,this.y=f,this.z=d,this._aabb=function computeAABB(e,t){switch(t){case W.POINT:return[];case W.LINE:case W.POLYGON:for(var r=[],n=0;n<e.length;n++){for(var a=e[n],i={minx:Number.POSITIVE_INFINITY,miny:Number.POSITIVE_INFINITY,maxx:Number.NEGATIVE_INFINITY,maxy:Number.NEGATIVE_INFINITY},o=0;o<a.length;o++)i=_updateAABBForGeometry(a[o],i,t);i.minx===Number.POSITIVE_INFINITY&&(i=null),r.push(i)}return r}}(s,o),this._centroids=computeCentroids(this.decodedGeom,o),this.t1=[.1,.1,.1,.1],this.t2=[.1,.1,.1,.1],this.t3=[.1,.1,.1,.1],this.t4=[.1,.1,.1,.1]},we=1,ke=2,Me=3,Te={1:W.POINT,2:W.LINE,3:W.POLYGON},Pe=function(){function MVTWorker(){h()(this,MVTWorker)}return p()(MVTWorker,[{key:"onmessage",value:function onmessage(e){this.processEvent(e).then(function(e){var t=[];e.dataframe.empty||(t.push(e.dataframe.propertiesArrayBuffer),t.push(e.dataframe.decodedGeom.verticesArrayBuffer),e.dataframe.decodedGeom.normalsArrayBuffer&&t.push(e.dataframe.decodedGeom.normalsArrayBuffer)),postMessage(e,t)})}},{key:"processEvent",value:function(){var e=l()(u.a.mark(function _callee(e){var t,r;return u.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return(t=e.data).metadata&&(this.castMetadata(t.metadata),this.metadata=t.metadata),n.next=4,this._requestDataframe(t.x,t.y,t.z,t.url,t.layerID,this.metadata);case 4:return r=n.sent,n.abrupt("return",{mID:t.mID,dataframe:r});case 6:case"end":return n.stop()}},_callee,this)}));return function processEvent(t){return e.apply(this,arguments)}}()},{key:"castMetadata",value:function castMetadata(e){Object.setPrototypeOf(e,he.prototype),e.setCodecs()}},{key:"_requestDataframe",value:function(){var e=l()(u.a.mark(function _callee2(e,t,r,n,a,i){var o,s;return u.a.wrap(function _callee2$(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,fetch(n);case 2:return o=u.sent,u.next=5,this.urlToDataframeTransformer(o,e,t,r,a,i);case 5:return s=u.sent,u.abrupt("return",s);case 7:case"end":return u.stop()}},_callee2,this)}));return function _requestDataframe(t,r,n,a,i,o){return e.apply(this,arguments)}}()},{key:"urlToDataframeTransformer",value:function(){var e=l()(u.a.mark(function _callee3(e,t,r,n,a,i){var o,s,c,l,f,h,d,p,y,v,g;return u.a.wrap(function _callee3$(u){for(;;)switch(u.prev=u.next){case 0:return o=i.extent,u.next=3,e.arrayBuffer();case 3:if(0!==(s=u.sent).byteLength&&"null"!==e){u.next=6;break}return u.abrupt("return",{empty:!0});case 6:if(c=new _.VectorTile(new m(s)),!(Object.keys(c.layers).length>1)||a){u.next=9;break}throw new G("LayerID parameter wasn't specified and the MVT tile contains multiple layers: ".concat(JSON.stringify(Object.keys(c.layers)),"."),U.MISSING_REQUIRED);case 9:if(l=c.layers[a||Object.keys(c.layers)[0]]){u.next=12;break}return u.abrupt("return",{empty:!0});case 12:return f=this._decodeMVTLayer(l,i,o),h=f.geometries,d=f.properties,p=f.propertiesArrayBuffer,y=f.numFeatures,v=getRsysFromTile(t,r,n),g=this._generateDataFrame(v,h,d,p,y,i.geomType,i),u.abrupt("return",g);case 16:case"end":return u.stop()}},_callee3,this)}));return function urlToDataframeTransformer(t,r,n,a,i,o){return e.apply(this,arguments)}}()},{key:"_decodeMVTLayer",value:function _decodeMVTLayer(e,t,r){if(!e.length)return{properties:[],geometries:{},propertiesArrayBuffer:[],numFeatures:0};switch(t.geomType||(t.geomType=this._autoDiscoverType(e)),t.geomType){case W.POINT:var n=new ArrayBuffer(2*e.length*3*4);return this._decode(e,t,r,n);case W.LINE:return this._decode(e,t,r,[],decodeLines);case W.POLYGON:return this._decode(e,t,r,[],decodePolygons);default:throw new G("MVT: invalid geometry type '".concat(t.geomType,"'"),U.INCORRECT_TYPE)}}},{key:"_autoDiscoverType",value:function _autoDiscoverType(e){var t=e.feature(0).type;switch(t){case we:return W.POINT;case ke:return W.LINE;case Me:return W.POLYGON;default:throw new G("MVT: invalid geometry type '".concat(t,"'"),U.INCORRECT_TYPE)}}},{key:"_decode",value:function _decode(e,t,r,n,a){var i,o=0;n&&(i=new Float32Array(n));for(var s=this._initializePropertyArrays(t,e.length),u=s.properties,c=s.propertiesArrayBuffer,l=this._scalarPropertyCodecs(t),f=this._rangePropertyCodecs(t),h=0;h<e.length;h++){var d=e.feature(h);this._checkType(d,t.geomType);var p=d.loadGeometry();if(a){var _=a(p,r);n.push(_)}else{var y=2*p[0][0].x/r-1,m=2*(1-p[0][0].y/r)-1;if(y<-1||y>=1||m<-1||m>=1)continue;i[6*o+0]=y,i[6*o+1]=m,i[6*o+2]=y,i[6*o+3]=m,i[6*o+4]=y,i[6*o+5]=m}if(void 0===d.properties[t.idProperty])throw new $("MVT feature with undefined idProperty '".concat(t.idProperty,"'"),K.MVT);this._decodeProperties(t,l,f,u,d,o),o++}return{properties:u,propertiesArrayBuffer:c,geometries:n,numFeatures:o}}},{key:"_checkType",value:function _checkType(e,t){var r=e.type,n=Te[r];if(n!==t)throw new $("MVT: mixed geometry types in the same layer. Layer has type: ".concat(t," but feature was ").concat(n),K.MVT)}},{key:"_initializePropertyArrays",value:function _initializePropertyArrays(e,t){var r=this._getPropertyNamesFrom(e),n=this._getPropertiesFor(r,t);return{propertyNames:r,properties:n.properties,propertiesArrayBuffer:n.propertiesArrayBuffer}}},{key:"_getSourcePropertyNamesFrom",value:function _getSourcePropertyNamesFrom(e){return e.propertyKeys.filter(function(t){return"geometry"!==e.properties[e.baseName(t)].type})}},{key:"_getPropertyNamesFrom",value:function _getPropertyNamesFrom(e){var t=[];return this._getSourcePropertyNamesFrom(e).forEach(function(r){e.decodedProperties(r).forEach(function(e){t.push(e)})}),t}},{key:"_getPropertiesFor",value:function _getPropertiesFor(e,t){for(var r={},n=1024*Math.ceil(t/1024),a=new ArrayBuffer(4*n*e.length),i=a,o=0;o<e.length;o++){r[e[o]]=new Float32Array(a,4*o*n,n)}return{properties:r,propertiesArrayBuffer:i}}},{key:"_scalarPropertyCodecs",value:function _scalarPropertyCodecs(e){return this._getSourcePropertyNamesFrom(e).map(function(t){return[t,e.codec(t)]}).filter(function(e){var t=o()(e,2);t[0];return!t[1].isRange()})}},{key:"_rangePropertyCodecs",value:function _rangePropertyCodecs(e){return this._getSourcePropertyNamesFrom(e).map(function(t){return[t,e.decodedProperties(t),e.codec(t)]}).filter(function(e){var t=o()(e,3);t[0],t[1];return t[2].isRange()})}},{key:"_decodeProperties",value:function _decodeProperties(e,t,r,n,a,i){for(var s=t.length,u=0;u<s;u++){var c=o()(t[u],2),l=c[0],f=c[1],h=a.properties[l];n[l][i]=f.sourceToInternal(e,h)}s=r.length;for(var d=0;d<s;d++){var p=o()(r[d],3),_=(l=p[0],o()(p[1],2)),y=_[0],m=_[1],v=(f=p[2],a.properties[l]),g=f.sourceToInternal(e,v),b=o()(g,2),x=b[0],w=b[1];n[y][i]=x,n[m][i]=w}}},{key:"_generateDataFrame",value:function _generateDataFrame(e,t,r,n,a,i,o){return new xe({active:!1,center:e.center,geom:t,properties:r,propertiesArrayBuffer:n,scale:e.scale,size:a,type:i,metadata:o})}}]),MVTWorker}(),ze=["year","month","day","hour","minute","second"],Ie=[1,1,1,0,0,0],Se=0,Ee=1,Ne=2,Ce=3,Fe=4,Ae=5,De=864e5,Oe=36e5,Ve=6e4,Re=1e3;function startLevel(e){for(var t=ze.length-1;t>0&&e[ze[t]]===Ie[t];)--t;return t}function pad(e,t){return e.toString().padStart(t,"0")}function parsedValue(e){var t=msToDate(e);return{year:t.getUTCFullYear(),month:t.getUTCMonth()+1,day:t.getUTCDate(),hour:t.getUTCHours(),minute:t.getUTCMinutes(),second:t.getUTCSeconds()}}function invalidPeriod(e,t){throw new Error("Invalid period of ".concat(t," between ").concat(e.v1," and ").concat(e.v2))}function yearWeek(e,t){var r=function isoDow(e,t,r){var n=new Date(e,t-1,r).getDay();return 0===n?7:n}(e,1,1),n=r>4?9-r:2-r;return Math.abs(t-n)%7!=0?[]:t<n?yearWeek(e-1,t+=Math.round((Date.UTC(e,0,1)-Date.UTC(e-1,0,1))/De)):Date.UTC(e,0,1)+(t-1+3)*De>=Date.UTC(e+1,0,1)?yearWeek(e+1,t-=Math.round((Date.UTC(e+1,0,1)-Date.UTC(e,0,1))/De)):[e,1+Math.round((t-n)/7)]}function periodISO(e,t){var r=parsedValue(e),n=parsedValue(t),a=startLevel(r),i=startLevel(n),s={v1:e,v2:t,t1:r,t2:n};return Math.max(a,i)===Se?function yearsPeriod(e){var t=e.t2.year-e.t1.year;return 1e3===t&&(e.t1.year-1)%1e3==0?"M".concat(1+(e.t1.year-1)/1e3):100===t&&(e.t1.year-1)%100==0?"C".concat(1+(e.t1.year-1)/100):10===t&&e.t1.year%10==0?"D".concat(e.t1.year/10):1===t?pad(e.t1.year,4):void invalidPeriod("".concat(t," years"))}(s):Math.max(a,i)===Ee?function monthsPeriod(e){var t=12*e.t2.year+e.t2.month-12*e.t1.year-e.t1.month;return 6===t&&(e.t1.month-1)%6==0?"".concat(pad(e.t1.year,4),"S").concat(1+(e.t1.month-1)/6):4===t?"".concat(pad(e.t1.year,4),"t").concat(1+(e.t1.month-1)/4):3===t?"".concat(pad(e.t1.year,4),"-Q").concat(1+(e.t1.month-1)/3):1===t?"".concat(pad(e.t1.year,4),"-").concat(pad(e.t1.month,2)):void invalidPeriod("".concat(t," months"))}(s):Math.max(a,i)===Ne?function daysPeriod(e){var t=Math.round((e.v2-e.v1)/De);if(1===t)return"".concat(pad(e.t1.year,4),"-").concat(pad(e.t1.month,2),"-").concat(pad(e.t1.day,2));if(7===t){var r=e.t1.year,n=Date.UTC(r,0,1),a=yearWeek(r,1+Math.round((e.v1-n)/De)),i=o()(a,2),s=i[0],u=i[1];if(s&&u)return"".concat(pad(s,4),"-W").concat(pad(u,2));invalidPeriod("7 days")}else invalidPeriod("".concat(t," days"))}(s):Math.max(a,i)===Ce?function hoursPeriod(e){var t=Math.round((e.v2-e.v1)/Oe);if(1===t)return"".concat(pad(e.t1.year,4),"-").concat(pad(e.t1.month,2),"-").concat(pad(e.t1.day,2),"T").concat(pad(e.t1.hour,2));invalidPeriod("".concat(t," hours"))}(s):Math.max(a,i)===Fe?function minutesPeriod(e){var t=Math.round((e.v2-e.v1)/Ve);if(1===t)return"".concat(pad(e.t1.year,4),"-").concat(pad(e.t1.month,2),"-").concat(pad(e.t1.day,2),"T").concat(pad(e.t1.hour,2),":").concat(pad(e.t1.minute,2));invalidPeriod("".concat(t," minutes"))}(s):Math.max(a,i)===Ae?function secondsPeriod(e){var t=Math.round((e.v2-e.v1)/Re);if(1===t)return"".concat(pad(e.t1.year,4),"-").concat(pad(e.t1.month,2),"-").concat(pad(e.t1.day,2),"T").concat(pad(e.t1.hour,2),":").concat(pad(e.t1.minute,2),":").concat(pad(e.t1.second,2));invalidPeriod("".concat(t," seconds"))}(s):void invalidPeriod(s,"fractional seconds")}var Be=function(e){function CartoParsingError(e){var t;h()(this,CartoParsingError);return(t=V()(this,B()(CartoParsingError).call(this,{message:e,type:"[Error]"}))).name="CartoParsingError",t}return Z()(CartoParsingError,e),CartoParsingError}(j),Le=function(){function IsoParser(e){h()(this,IsoParser),this._format=e}return p()(IsoParser,[{key:"check",value:function check(e){return e.match(this._format)}}]),IsoParser}();function fieldDefault(e,t){return void 0===e?t:Number(e)}function dateFields(e){return{year:fieldDefault(e.year,1),month:fieldDefault(e.month,1),day:fieldDefault(e.day,1),hour:fieldDefault(e.hour,0),minute:fieldDefault(e.minute,0),second:fieldDefault(e.second,0)}}function fieldsFromMatch(e){return dateFields({year:e[1],month:e[2],day:e[3],hour:e[4],minute:e[5],second:e[6]})}var Ze=function(e){function YMDHMSParser(){return h()(this,YMDHMSParser),V()(this,B()(YMDHMSParser).call(this,/^(\d\d\d\d)(?:\-?(\d\d)(?:\-?(\d\d)(?:[T\s]?(\d\d)(?:\:(\d\d)(?:\:(\d\d))?)?)?)?)?$/))}return Z()(YMDHMSParser,e),p()(YMDHMSParser,[{key:"parse",value:function parse(e){var t=this.check(e)||[],r=t.slice(),n=[1,2,3,4,5,6].find(function(e){return void 0===r[e]})||7;return 1===n?r[1]=2:r[n-1]=Number(r[n-1])+1,[fieldsFromMatch(t),fieldsFromMatch(r)]}}]),YMDHMSParser}(Le),qe=function(e){function MillenniumParser(){return h()(this,MillenniumParser),V()(this,B()(MillenniumParser).call(this,/^M(\d+)$/))}return Z()(MillenniumParser,e),p()(MillenniumParser,[{key:"parse",value:function parse(e){var t=this.check(e),r=Number(t[1]),n=function year(e){return 1e3*(e-1)+1};return[dateFields({year:n(r)}),dateFields({year:n(r+1)})]}}]),MillenniumParser}(Le),je=function(e){function CenturyParser(){return h()(this,CenturyParser),V()(this,B()(CenturyParser).call(this,/^C(\d+)$/))}return Z()(CenturyParser,e),p()(CenturyParser,[{key:"parse",value:function parse(e){var t=this.check(e),r=Number(t[1]),n=function year(e){return 100*(e-1)+1};return[dateFields({year:n(r)}),dateFields({year:n(r+1)})]}}]),CenturyParser}(Le),Ge=function(e){function DecadeParser(){return h()(this,DecadeParser),V()(this,B()(DecadeParser).call(this,/^D(\d+)$/))}return Z()(DecadeParser,e),p()(DecadeParser,[{key:"parse",value:function parse(e){var t=this.check(e),r=Number(t[1]),n=function year(e){return 10*e};return[dateFields({year:n(r)}),dateFields({year:n(r+1)})]}}]),DecadeParser}(Le),Ue=function(e){function SemesterParser(){return h()(this,SemesterParser),V()(this,B()(SemesterParser).call(this,/^(\d\d\d\d)S(\d)$/))}return Z()(SemesterParser,e),p()(SemesterParser,[{key:"parse",value:function parse(e){var t=this.check(e),r=Number(t[1]),n=Number(t[2]),a=function month(e){return 6*(e-1)+1};return[dateFields({year:r,month:a(n)}),dateFields({year:r,month:a(n+1)})]}}]),SemesterParser}(Le),We=function(e){function TrimesterParser(){return h()(this,TrimesterParser),V()(this,B()(TrimesterParser).call(this,/^(\d\d\d\d)t(\d)$/))}return Z()(TrimesterParser,e),p()(TrimesterParser,[{key:"parse",value:function parse(e){var t=this.check(e),r=Number(t[1]),n=Number(t[2]),a=function month(e){return 4*(e-1)+1};return[dateFields({year:r,month:a(n)}),dateFields({year:r,month:a(n+1)})]}}]),TrimesterParser}(Le),Ye=function(e){function QuarterParser(){return h()(this,QuarterParser),V()(this,B()(QuarterParser).call(this,/^(\d\d\d\d)\-?Q(\d)$/))}return Z()(QuarterParser,e),p()(QuarterParser,[{key:"parse",value:function parse(e){var t=this.check(e),r=Number(t[1]),n=Number(t[2]),a=function month(e){return 3*(e-1)+1};return[dateFields({year:r,month:a(n)}),dateFields({year:r,month:a(n+1)})]}}]),QuarterParser}(Le);function startOfIsoWeek(e,t){var r=function parseISO_isoDow(e,t,r){var n=new Date(e,t-1,r).getDay();return 0===n?7:n}(e,1,1);return function addDays(e,t){var r=new Date(e.valueOf());return r.setDate(r.getDate()+t),r}(new Date(e,0,r>4?9-r:2-r),7*(t-1))}var Qe=function(e){function WeekParser(){return h()(this,WeekParser),V()(this,B()(WeekParser).call(this,/^(\d\d\d\d)\-?W(\d\d)$/))}return Z()(WeekParser,e),p()(WeekParser,[{key:"parse",value:function parse(e){var t=this.check(e),r=Number(t[1]),n=Number(t[2]),a=startOfIsoWeek(r,n),i=startOfIsoWeek(r,n+1),o=function fields(e){return{year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()}};return[dateFields(o(a)),dateFields(o(i))]}}]),WeekParser}(Le),He=[new qe,new je,new Ge,new Ue,new We,new Ye,new Qe,new Ze];function parseISO(e){var t=function findParser(e){return He.find(function(t){return t.check(e)})}(e=e||"");if(!t)throw new Be("No date parser found for ".concat(e));return t.parse(e)}var Je=function(){function TimeZoneDate(e,t){h()(this,TimeZoneDate),this._value=e,this._date=msToDate(e),this._timeZone=t}return p()(TimeZoneDate,[{key:"year",get:function get(){return this._date.getUTCFullYear()}},{key:"month",get:function get(){return this._date.getUTCMonth()+1}},{key:"day",get:function get(){return this._date.getUTCDate()}},{key:"hour",get:function get(){return this._date.getUTCHours()}},{key:"minute",get:function get(){return this._date.getUTCMinutes()}},{key:"second",get:function get(){return this._date.getUTCSeconds()}},{key:"text",get:function get(){return periodISO(this._date.getTime(),this._date.getTime()+1e3)}},{key:"timeZone",get:function get(){return this._timeZone}}],[{key:"fromValue",value:function fromValue(e,t){return new TimeZoneDate(e,t)}},{key:"from",value:function from(e,t,r,n,a,i,o){return this.fromValue(Date.UTC(e,(t||1)-1,r,n,a,i),o)}}]),TimeZoneDate}(),$e=function(){function TimeRange(e,t,r,n){if(h()(this,TimeRange),this._startValue=r,this._endValue=n,r&&n)this._iso=periodISO(r,n);else if(!r&&!n&&t){var a=function _startEndTimeValues(e){return parseISO(e).map(_timeValue)}(t);this._iso=t,this._startValue=a[0],this._endValue=a[1]}this._timeZone=e}return p()(TimeRange,[{key:"timeZone",get:function get(){return this._timeZone}},{key:"iso",get:function get(){return this._iso}},{key:"startValue",get:function get(){return this._startValue}},{key:"endValue",get:function get(){return this._endValue}},{key:"startDate",get:function get(){return Je.fromValue(this._startValue,this._timeZone)}},{key:"endDate",get:function get(){return Je.fromValue(this._endValue,this._timeZone)}}]),TimeRange}();function _timeValue(e){return Date.UTC(e.year,e.month-1,e.day,e.hour,e.minute,e.second)}Math.PI;var Ke=6378137;Math.PI;function msToDate(e){return new Date(e)}function castTimeRange(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return void 0===e||function isTimeRange(e){return e instanceof $e}(e)?e&&t?util_timeRange({iso:e._iso,timeZone:t}):e:"string"==typeof e?util_timeRange({iso:e,timeZone:t}):void 0}function util_timeRange(e){var t=e.start,r=e.end,n=e.iso,a=e.timeZone;return new $e(a,n,t,r)}var Xe=function(e){function WindshaftDateCodec(e,t){var r;h()(this,WindshaftDateCodec),r=V()(this,B()(WindshaftDateCodec).call(this,e,t));var n=e.stats(t).min;return r._min_ms=1e3*n,r._min_date=msToDate(r._min_ms),r}return Z()(WindshaftDateCodec,e),p()(WindshaftDateCodec,[{key:"sourceToInternal",value:function sourceToInternal(e,t){return msToDate(1e3*t)-this._min_date}},{key:"internalToExternal",value:function internalToExternal(e,t){var r=t;return msToDate(r+=this._min_ms)}},{key:"externalToSource",value:function externalToSource(e,t){return t.getTime()/1e3}},{key:"sourceToExternal",value:function sourceToExternal(e,t){return function asDate(e){if(e instanceof Date)return e;return msToDate(1e3*e)}(t)}},{key:"inlineInternalMatch",value:function inlineInternalMatch(e,t){var r=t._min_ms-this._min_ms;return"(".concat(e,"-").concat(r.toFixed(20),")")}}]),WindshaftDateCodec}(X);var et=function(e){function TimeRangeCodec(e,t){var r;h()(this,TimeRangeCodec),r=V()(this,B()(TimeRangeCodec).call(this,e,t));var n=e.stats(t),a=n.min,i=n.grouping&&n.grouping.timezone,o=util_timeRange({timeZone:i,iso:a});return r._min=o.startValue/1e3,r._timeZone=i,r}return Z()(TimeRangeCodec,e),p()(TimeRangeCodec,[{key:"isRange",value:function isRange(){return!0}},{key:"sourceToInternal",value:function sourceToInternal(e,t){var r=this,n=util_timeRange({iso:t});return[n.startValue/1e3,n.endValue/1e3].map(function(e){return e-r._min})}},{key:"internalToExternal",value:function internalToExternal(e,t){var r=o()(t,2),n=r[0],a=r[1];return util_timeRange({start:1e3*(n+this._min),end:1e3*(a+this._min),timeZone:this._timeZone})}},{key:"externalToSource",value:function externalToSource(e,t){return castTimeRange(t,this._timeZone)._iso}},{key:"sourceToExternal",value:function sourceToExternal(e,t){return util_timeRange({iso:t,timeZone:this._timeZone})}},{key:"inlineInternalMatch",value:function inlineInternalMatch(e,t){var r=t._min.getTime()-this._min.getTime();return"(".concat(e,"-").concat(r.toFixed(20),")")}}]),TimeRangeCodec}(X),tt=function(e){function CartoMapsAPIError(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rt.DEFAULT;return h()(this,CartoMapsAPIError),(t=V()(this,B()(CartoMapsAPIError).call(this,{message:e,type:r}))).name="CartoMapsAPIError",t}return Z()(CartoMapsAPIError,e),CartoMapsAPIError}(j),rt={DEFAULT:"[Error]",SQL:"[SQL]",NOT_SUPPORTED:"[Not supported]",SECURITY:"[Security]"};var nt=function(e){function WindshaftMetadata(){var e,t;h()(this,WindshaftMetadata);for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return(t=V()(this,(e=B()(WindshaftMetadata)).call.apply(e,[this].concat(n)))).propertyKeys=[],t.baseNames={},Object.keys(t.properties).forEach(function(e){var r=t.properties[e];r.aggregations?Object.values(r.aggregations).forEach(function(r){t._addProperty(e,r)}):r.dimension?r.dimension.range?(r.dimension.range.forEach(function(r){t._addProperty(e,r,!1)}),t._addProperty(e,r.dimension.propertyName)):t._addProperty(e,r.dimension.propertyName):t._addProperty(e,e)}),t}return Z()(WindshaftMetadata,e),p()(WindshaftMetadata,[{key:"_addProperty",value:function _addProperty(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.baseNames[t]=e,r&&this.propertyKeys.push(t)}},{key:"_dimensionInfo",value:function _dimensionInfo(e){var t=this.baseName(e)||e,r=this.properties[t],n=null;t!==e&&t!==e&&r.dimension&&(n=r.dimension);var a=r.type,i=n?function dimensionBaseType(e){return e.type}(n):a;return{baseName:t,column:r,dimension:n,dataframeType:n?function dimensionType(e,t){if(e.range)return"date";return e.type}(n):i,baseType:a,sourceType:i}}},{key:"baseName",value:function baseName(e){return this.baseNames[e]}},{key:"decodedProperties",value:function decodedProperties(e){var t=this._dimensionInfo(e).dimension;return t&&t.grouping&&t.range?t.range:se()(B()(WindshaftMetadata.prototype),"decodedProperties",this).call(this,e)}},{key:"stats",value:function stats(e){var t=this._dimensionInfo(e).dimension;return t&&t.grouping?t:se()(B()(WindshaftMetadata.prototype),"stats",this).call(this,e)}},{key:"setCodecs",value:function setCodecs(){!function setMetadataCodecs(e){Object.keys(e.properties).forEach(function(t){var r=e.properties[t],n=r.type;if("geometry"!==n){var a=r.dimension?r.dimension.type:null,i=a?r.dimension.propertyName:t,o="category"===a&&r.dimension.range?"timerange":a;r.codec=function windshaftCodecFactory(e,t,r){switch(t){case"number":return new ue(e,r);case"category":return new le(e,r);case"date":return new Xe(e,r);case"timerange":return new et(e,r);default:throw new tt("Windshaft MVT decoding error. Feature property value of type '".concat(t,"' cannot be decoded."),rt.NOT_SUPPORTED)}}(e,o||n,i||t)}})}(this)}},{key:"sourcePropertyName",value:function sourcePropertyName(e){var t=this.baseName(e),r=this.properties[t].dimension;return r&&r.range?r.propertyName:e}}]),WindshaftMetadata}(he);var at=function(e){function WindshaftWorker(){return h()(this,WindshaftWorker),V()(this,B()(WindshaftWorker).apply(this,arguments))}return Z()(WindshaftWorker,e),p()(WindshaftWorker,[{key:"castMetadata",value:function castMetadata(e){Object.setPrototypeOf(e,nt.prototype),e.setCodecs()}}]),WindshaftWorker}(Pe),it=function(){function BigQueryClient(e,t){h()(this,BigQueryClient),this._projectId=e,this._token=t,this._activeJobs={}}return p()(BigQueryClient,[{key:"list",value:function(){var e=l()(u.a.mark(function _callee(){return u.a.wrap(function _callee$(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.fetch("GET","jobs"));case 1:case"end":return e.stop()}},_callee,this)}));return function list(){return e.apply(this,arguments)}}()},{key:"insert",value:function(){var e=l()(u.a.mark(function _callee2(){return u.a.wrap(function _callee2$(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.fetch("POST","jobs"));case 1:case"end":return e.stop()}},_callee2,this)}));return function insert(){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=l()(u.a.mark(function _callee3(e){return u.a.wrap(function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.fetch("GET","jobs/".concat(e)));case 1:case"end":return t.stop()}},_callee3,this)}));return function get(t){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){var e=l()(u.a.mark(function _callee4(e){return u.a.wrap(function _callee4$(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.fetch("POST","jobs/".concat(e,"/cancel")));case 1:case"end":return t.stop()}},_callee4,this)}));return function cancel(t){return e.apply(this,arguments)}}()},{key:"query",value:function(){var e=l()(u.a.mark(function _callee5(e){return u.a.wrap(function _callee5$(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.fetch("POST","queries",{kind:"bigquery#queryRequest",query:e,useLegacySql:!1,timeoutMs:5e3,useQueryCache:!0}));case 1:case"end":return t.stop()}},_callee5,this)}));return function query(t){return e.apply(this,arguments)}}()},{key:"getQueryResults",value:function(){var e=l()(u.a.mark(function _callee6(e){return u.a.wrap(function _callee6$(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.fetch("GET","queries/".concat(e,"?timeoutMs=").concat(5e3)));case 1:case"end":return t.stop()}},_callee6,this)}));return function getQueryResults(t){return e.apply(this,arguments)}}()},{key:"execute",value:function(){var e=l()(u.a.mark(function _callee7(e){var t;return u.a.wrap(function _callee7$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.query(e);case 2:if(!(t=r.sent).error){r.next=5;break}throw Error("[".concat(t.error.status,"] ").concat(t.error.message));case 5:return r.abrupt("return",this._pollingQuery(t));case 6:case"end":return r.stop()}},_callee7,this)}));return function execute(t){return e.apply(this,arguments)}}()},{key:"_pollingQuery",value:function(){var e=l()(u.a.mark(function _callee8(e){var t=this;return u.a.wrap(function _callee8$(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise(function(r,n){if(e.jobComplete)r(e);else{var a=e.jobReference.jobId;t._updateJobTime(a),t._jobTimeout(a)?t._cancelJob(a,n):t._getJobResult(a,r)}}));case 1:case"end":return r.stop()}},_callee8,this)}));return function _pollingQuery(t){return e.apply(this,arguments)}}()},{key:"_jobTimeout",value:function _jobTimeout(e){return this._activeJobs[e]>=12e4}},{key:"_updateJobTime",value:function _updateJobTime(e){e in this._activeJobs?this._activeJobs[e]+=5e3:this._activeJobs[e]=5e3}},{key:"_cancelJob",value:function(){var e=l()(u.a.mark(function _callee9(e,t){var r;return u.a.wrap(function _callee9$(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.cancel(e);case 2:r=n.sent,delete this._activeJobs[e],t(r);case 5:case"end":return n.stop()}},_callee9,this)}));return function _cancelJob(t,r){return e.apply(this,arguments)}}()},{key:"_getJobResult",value:function(){var e=l()(u.a.mark(function _callee10(e,t){var r;return u.a.wrap(function _callee10$(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.getQueryResults(e);case 2:(r=n.sent).jobComplete?t(r):t(this._pollingQuery(r));case 4:case"end":return n.stop()}},_callee10,this)}));return function _getJobResult(t,r){return e.apply(this,arguments)}}()},{key:"fetch",value:function(e){function fetch(t,r,n){return e.apply(this,arguments)}return fetch.toString=function(){return e.toString()},fetch}(function(){var e=l()(u.a.mark(function _callee11(e,t,r){var n;return u.a.wrap(function _callee11$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch("".concat("https://bigquery.googleapis.com/bigquery/v2","/projects/").concat(this._projectId,"/").concat(t),{method:e,headers:{Authorization:"Bearer ".concat(this._token),"Content-Type":"application/json"},body:r&&JSON.stringify(r)});case 2:return n=a.sent,a.abrupt("return",n.json());case 4:case"end":return a.stop()}},_callee11,this)}));return function(t,r,n){return e.apply(this,arguments)}}())}]),BigQueryClient}(),ot=0;function gilbert2d_tile(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:x,y:y},t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;if(t<1||r<1)throw"Invalid Gilbert rectangle. Got: Width (".concat(t,"). Height: (").concat(r,")");var n={x:e.x,y:e.y,counter:0},a={x:0,y:r},i={x:t,y:0};return t>r&&(a={x:t,y:0},i={x:0,y:r}),function gilbert2d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:x,y:y},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:x,y:y},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:x,y:y},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{counter:counter,x:x,y:y},a=Math.sign(t.x),i=Math.sign(t.y),o=Math.sign(r.x),s=Math.sign(r.y),u=Math.min(e.x,e.x+t.x-a+r.x-o),c=Math.max(e.x,e.x+t.x-a+r.x-o),l=Math.min(e.y,e.y+t.y-i+r.y-s),f=Math.max(e.y,e.y+t.y-i+r.y-s);if(n.x<u||n.x>c||n.y<l||n.y>f)return n.counter+=(c-u+1)*(f-l+1),-1;var h=Math.abs(t.x+t.y),d=Math.abs(r.x+r.y);if(1==h||1==d)return n.counter+=Math.abs(e.x-n.x+(e.y-n.y)),n.counter;var p={x:Math.floor(t.x/2),y:Math.floor(t.y/2)};if(2*h>3*d){Math.abs(p.x+p.y)%2&&h>2&&(p.x+=a,p.y+=i);var _=gilbert2d({x:e.x,y:e.y},p,r,n);return-1!==_?_:gilbert2d({x:e.x+p.x,y:e.y+p.y},{x:t.x-p.x,y:t.y-p.y},r,n)}var m={x:Math.floor(r.x/2),y:Math.floor(r.y/2)};Math.abs(m.x+m.y)%2&&d>2&&(m.x+=o,m.y+=s);var v=gilbert2d({x:e.x,y:e.y},m,p,n);if(-1!==v)return v;var g=gilbert2d({x:e.x+m.x,y:e.y+m.y},t,{x:r.x-m.x,y:r.y-m.y},n);return-1!==g?g:gilbert2d({x:e.x+(t.x-a)+(m.x-o),y:e.y+(t.y-i)+(m.y-s)},{x:-m.x,y:-m.y},{x:-(t.x-p.x),y:-(t.y-p.y)},n)}({x:0,y:0},a,i,n)}var st=function(){function GilbertPartition(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{zmin:zmin,zmax:zmax,zstep:zstep},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{xmin:xmin,xmax:xmax,ymin:ymin,ymax:ymax};if(h()(this,GilbertPartition),this.partition_count=parseInt(e),this.z_range={zmin:parseInt(t.zmin),zmax:parseInt(t.zmax),zstep:parseInt(t.zstep)},this.zmax_bbox={xmin:parseInt(r.xmin),xmax:parseInt(r.xmax),ymin:parseInt(r.ymin),ymax:parseInt(r.ymax)},!e||e<1)throw"Unexpected partition count. Expected a positive integer. Got ".concat(e);if(!this.z_range)throw"Missing z_range";if(isNaN(this.z_range.zmin)||isNaN(this.z_range.zmax)||isNaN(this.z_range.zstep))throw"Invalid z_range. Both zmin, zmax and zstep need to be defined. Got ".concat(JSON.stringify(t));if(this.z_range.zmin>this.z_range.zmax||this.z_range.zmin<0||this.zstep<1)throw"Invalid z_range received. Got (".concat(JSON.stringify(t),")");if(!this.zmax_bbox)throw"Missing zmax_bbox";if(isNaN(this.zmax_bbox.xmin)||isNaN(this.zmax_bbox.xmax)||isNaN(this.zmax_bbox.ymin)||isNaN(this.zmax_bbox.ymax))throw"Invalid zmax_bbox. All xmin, xmax, ymin and ymax need to be defined. Got (".concat(JSON.stringify(r),")");if(this.zmax_bbox.xmin>this.zmax_bbox.xmax||this.zmax_bbox.xmin<0||this.zmax_bbox.ymin>this.zmax_bbox.ymax||this.zmax_bbox.ymin<0)throw"Invalid bbox received. Got (".concat(JSON.stringify(r),")")}return p()(GilbertPartition,[{key:"getPartition",value:function getPartition(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{z:0,x:0,y:0},t=this.zmax_bbox.xmin>>this.z_range.zmax-e.z,r=this.zmax_bbox.xmax>>this.z_range.zmax-e.z,n=this.zmax_bbox.ymin>>this.z_range.zmax-e.z,a=this.zmax_bbox.ymax>>this.z_range.zmax-e.z;if(e.z<this.z_range.zmin||e.z>this.z_range.zmax||e.x<t||e.x>r||e.y<n||e.y>a)return ot;var i=function partition_range_by_zoom(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{z:z,zmin:zmin,zmax:zmax,zstep:zstep};return function(){if(t.z<0||t.zmin<0||t.zmax<0||t.zstep<1||t.z<t.zmin||t.z>t.zmax||t.partition_count<1||t.z!=t.zmin&&(t.z-t.zmin)%t.zstep!=0)return{min:ot,max:ot};var r=t.zstep,n=t.zmax-t.zmin;n-=n%r;var a=t.z-t.zmin,i=a-r+1,o=e;if(0==n||1==o)return{min:1,max:o};var s,u=0;if(0==a)u=4*o/Math.pow(4,n+1),s=0;else{for(var c=i;c<=a;c++)u+=3*o/Math.pow(4,n-c+1);s=o/Math.pow(4,n-i+1)}var l=s+u;return{min:(s=Math.round(s))+1,max:Math.min(o,Math.max(Math.floor(l),s)+1)}}()}(this.partition_count,{z:e.z,zmin:this.z_range.zmin,zmax:this.z_range.zmax,zstep:this.z_range.zstep}),o=i.max-i.min+1;if(1==o)return i.min;var s=e.x-t,u=e.y-n,c=r-t+1,l=a-n+1,f=c*l,h=gilbert2d_tile({x:s,y:u},c,l);if(-1===h||h>=c*l)throw"Unexpected gilbert partition (".concat(h,") for tile ").concat(e.z,"/").concat(e.x,"/").concat(e.y," ")+"=> ".concat(s,"/").concat(u," : ").concat(c,", ").concat(l,")");return i.min+Math.floor(o*h/f)}}]),GilbertPartition}(),ut=r(25),ct=r(26),lt=null,ft=function(){function BigQueryTilesetClient(e,t){h()(this,BigQueryTilesetClient),this._client=new it(e,t)}return p()(BigQueryTilesetClient,[{key:"fetchMetadata",value:function(){var e=l()(u.a.mark(function _callee(e,t){var r,n,a,i,o;return u.a.wrap(function _callee$(s){for(;;)switch(s.prev=s.next){case 0:return r="\n            SELECT name, value\n            FROM `".concat(e,".metadata`\n            WHERE table_name = '").concat(t,"'"),s.next=3,this._execute(r);case 3:if(n=s.sent,a={},n&&n.rows)for(i=0;i<n.rows.length;i++)(o=n.rows[i]).f&&2===o.f.length&&(a[o.f[0].v]=o.f[1].v);return s.abrupt("return",a);case 7:case"end":return s.stop()}},_callee,this)}));return function fetchMetadata(t,r){return e.apply(this,arguments)}}()},{key:"fetchTiles",value:function(){var e=l()(u.a.mark(function _callee2(e,t,r,n){var a,i,o,s,c,l,f,h,d,p,_;return u.a.wrap(function _callee2$(u){for(;;)switch(u.prev=u.next){case 0:return lt||(a=JSON.parse(n.carto_quadkey_zoom),lt=initializePartitioner(a)),i=getParentQuadkeysFromTiles(e),o=i.length?"carto_quadkey IN (".concat(i,")"):"TRUE",s=e.map(function(e){return tileFilter(e)}).join(" OR "),c="\n            SELECT zoom_level, tile_column, tile_row, tile_data\n            FROM `".concat(t,".").concat(r,"`\n            WHERE (").concat(o,") AND (").concat(s,")"),u.next=7,this._execute(c);case 7:if(l=u.sent,f=[],h=Object.assign(e,{}),!l||!l.rows){u.next=18;break}for(d=0;d<l.rows.length;d++)(p=l.rows[d]).f&&4===p.f.length&&function(){var e=parseInt(p.f[0].v),t=parseInt(p.f[1].v),r=parseInt(p.f[2].v),a="gzip"===n.compression?Object(ct.inflate)(atob(p.f[3].v)):Object(ut.decode)(p.f[3].v);f.push({z:e,x:t,y:r,buffer:a}),h=h.filter(function(n){return!(n.z===e&&n.x===t&&n.y===r)})}();if(console.log("".concat(f.length,"/").concat(l.totalRows)),!(l.totalRows>f.length)){u.next=18;break}return u.next=16,this.fetchTiles(h,t,r,n);case 16:_=u.sent,f=f.concat(_);case 18:return u.abrupt("return",f);case 19:case"end":return u.stop()}},_callee2,this)}));return function fetchTiles(t,r,n,a){return e.apply(this,arguments)}}()},{key:"_execute",value:function(){var e=l()(u.a.mark(function _callee3(e){var t,r,n;return u.a.wrap(function _callee3$(a){for(;;)switch(a.prev=a.next){case 0:return console.log(">"),t=(new Date).getTime(),a.next=4,this._client.execute(e);case 4:return r=a.sent,n=(new Date).getTime(),console.log("<",n-t),a.abrupt("return",r);case 8:case"end":return a.stop()}},_callee3,this)}));return function _execute(t){return e.apply(this,arguments)}}()}]),BigQueryTilesetClient}();function initializePartitioner(e){if(1!==e.version)throw new Error("Unknown quadkey version");var t={zmin:e.zmin,zmax:e.zmax,zstep:e.zstep},r={xmin:e.xmin,xmax:e.xmax,ymin:e.ymin,ymax:e.ymax},n=e.partitions;return new st(n,t,r)}function getParentQuadkeysFromTiles(e){var t=new Set,r=!0,n=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var s=i.value;t.add(lt.getPartition({z:s.z,x:s.x,y:s.y}))}}catch(e){n=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw a}}return g()(t).filter(function(e){return null!==e})}function tileFilter(e){return"(zoom_level = ".concat(e.z," AND tile_column = ").concat(e.x," AND tile_row = ").concat(e.y,")")}var ht=1,dt=2,pt=3,_t={1:W.POINT,2:W.LINE,3:W.POLYGON},yt=function(){function BigQueryTilesetWorker(){h()(this,BigQueryTilesetWorker)}return p()(BigQueryTilesetWorker,[{key:"onmessage",value:function onmessage(e){this.processEvent(e).then(postMessage)}},{key:"processEvent",value:function(){var e=l()(u.a.mark(function _callee(e){var t,r;return u.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return(t=e.data).metadata&&(this.castMetadata(t.metadata),this.metadata=t.metadata),n.next=4,this._requestDataframes(t.tiles,t.tilesetData,t.tilesetMetadata,this.metadata);case 4:return r=n.sent,n.abrupt("return",{mID:t.mID,dataframes:r});case 6:case"end":return n.stop()}},_callee,this)}));return function processEvent(t){return e.apply(this,arguments)}}()},{key:"castMetadata",value:function castMetadata(e){Object.setPrototypeOf(e,he.prototype),e.setCodecs()}},{key:"_requestDataframes",value:function(){var e=l()(u.a.mark(function _callee2(e,t,r,n){var a,i,o,s=this;return u.a.wrap(function _callee2$(u){for(;;)switch(u.prev=u.next){case 0:return a=new ft(t.project,t.token),u.next=3,a.fetchTiles(e,t.dataset,t.tileset,r);case 3:return i=u.sent,u.next=6,Promise.all(e.map(function(e){var t=i&&i.find(function(t){return t.x===e.x&&t.y===e.y&&t.z===e.z});return t?s.responseToDataframeTransformer(t,n):{x:e.x,y:e.y,z:e.z,empty:!0}}));case 6:return o=u.sent,u.abrupt("return",o);case 8:case"end":return u.stop()}},_callee2,this)}));return function _requestDataframes(t,r,n,a){return e.apply(this,arguments)}}()},{key:"responseToDataframeTransformer",value:function responseToDataframeTransformer(e,t){var r=this,n=e.x,a=e.y,i=e.z,o=e.buffer;return new Promise(function(e){var s=t.extent;if(0===o.byteLength)return e({x:n,y:a,z:i,empty:!0});var u=new _.VectorTile(new m(o));if(Object.keys(u.layers).length>1)throw new G("LayerID parameter wasn't specified and the MVT tile contains multiple layers: ".concat(JSON.stringify(Object.keys(u.layers)),"."),U.MISSING_REQUIRED);var c=u.layers[Object.keys(u.layers)[0]];if(!c)return e({empty:!0});var l=r._decodeMVTLayer(c,t,s),f=l.geometries,h=l.properties,d=l.propertiesArrayBuffer,p=l.numFeatures,y=getRsysFromTile(n,a,i);e(r._generateDataFrame(y,f,h,d,p,t.geomType,t,n,a,i))})}},{key:"_decodeMVTLayer",value:function _decodeMVTLayer(e,t,r){if(!e.length)return{properties:[],geometries:{},propertiesArrayBuffer:[],numFeatures:0};switch(t.geomType||(t.geomType=this._autoDiscoverType(e)),t.geomType){case W.POINT:var n=new ArrayBuffer(2*e.length*3*4);return this._decode(e,t,r,n);case W.LINE:return this._decode(e,t,r,[],decodeLines);case W.POLYGON:return this._decode(e,t,r,[],decodePolygons);default:throw new G("MVT: invalid geometry type '".concat(t.geomType,"'"),U.INCORRECT_TYPE)}}},{key:"_autoDiscoverType",value:function _autoDiscoverType(e){var t=e.feature(0).type;switch(t){case ht:return W.POINT;case dt:return W.LINE;case pt:return W.POLYGON;default:throw new G("MVT: invalid geometry type '".concat(t,"'"),U.INCORRECT_TYPE)}}},{key:"_decode",value:function _decode(e,t,r,n,a){var i,o=0;n&&(i=new Float32Array(n));for(var s=this._initializePropertyArrays(t,e.length),u=s.properties,c=s.propertiesArrayBuffer,l=this._scalarPropertyCodecs(t),f=this._rangePropertyCodecs(t),h=0;h<e.length;h++){var d=e.feature(h);this._checkType(d,t.geomType);var p=d.loadGeometry();if(a){var _=a(p,r);n.push(_)}else{var y=2*p[0][0].x/r-1,m=2*(1-p[0][0].y/r)-1;if(y<-1||y>=1||m<-1||m>=1)continue;i[6*o+0]=y,i[6*o+1]=m,i[6*o+2]=y,i[6*o+3]=m,i[6*o+4]=y,i[6*o+5]=m}this._decodeProperties(t,l,f,u,d,o),o++}return{properties:u,propertiesArrayBuffer:c,geometries:n,numFeatures:o}}},{key:"_checkType",value:function _checkType(e,t){var r=e.type,n=_t[r];if(n!==t)throw new $("MVT: mixed geometry types in the same layer. Layer has type: ".concat(t," but feature was ").concat(n),K.MVT)}},{key:"_initializePropertyArrays",value:function _initializePropertyArrays(e,t){var r=this._getPropertyNamesFrom(e),n=this._getPropertiesFor(r,t);return{propertyNames:r,properties:n.properties,propertiesArrayBuffer:n.propertiesArrayBuffer}}},{key:"_getSourcePropertyNamesFrom",value:function _getSourcePropertyNamesFrom(e){return e.propertyKeys.filter(function(t){return"geometry"!==e.properties[e.baseName(t)].type})}},{key:"_getPropertyNamesFrom",value:function _getPropertyNamesFrom(e){var t=[];return this._getSourcePropertyNamesFrom(e).forEach(function(r){e.decodedProperties(r).forEach(function(e){t.push(e)})}),t}},{key:"_getPropertiesFor",value:function _getPropertiesFor(e,t){for(var r={},n=1024*Math.ceil(t/1024),a=new ArrayBuffer(4*n*e.length),i=a,o=0;o<e.length;o++){r[e[o]]=new Float32Array(a,4*o*n,n)}return{properties:r,propertiesArrayBuffer:i}}},{key:"_scalarPropertyCodecs",value:function _scalarPropertyCodecs(e){return this._getSourcePropertyNamesFrom(e).map(function(t){return[t,e.codec(t)]}).filter(function(e){var t=o()(e,2);t[0];return!t[1].isRange()})}},{key:"_rangePropertyCodecs",value:function _rangePropertyCodecs(e){return this._getSourcePropertyNamesFrom(e).map(function(t){return[t,e.decodedProperties(t),e.codec(t)]}).filter(function(e){var t=o()(e,3);t[0],t[1];return t[2].isRange()})}},{key:"_decodeProperties",value:function _decodeProperties(e,t,r,n,a,i){for(var s=t.length,u=0;u<s;u++){var c=o()(t[u],2),l=c[0],f=c[1],h="___id"===l?a.id:a.properties[l];n[l][i]=f.sourceToInternal(e,h)}s=r.length;for(var d=0;d<s;d++){var p=o()(r[d],3),_=(l=p[0],o()(p[1],2)),y=_[0],m=_[1],v=(f=p[2],a.properties[l]),g=f.sourceToInternal(e,v),b=o()(g,2),x=b[0],w=b[1];n[y][i]=x,n[m][i]=w}}},{key:"_generateDataFrame",value:function _generateDataFrame(e,t,r,n,a,i,o,s,u,c){return new xe({active:!1,center:e.center,geom:t,properties:r,propertiesArrayBuffer:n,scale:e.scale,size:a,type:i,metadata:o,x:s,y:u,z:c})}}]),BigQueryTilesetWorker}();const mt={MVT:new Pe,windshaft:new at,BigQueryTileset:new yt};onmessage=function(e){return mt[e.data.workerName].onmessage(e)}}]);