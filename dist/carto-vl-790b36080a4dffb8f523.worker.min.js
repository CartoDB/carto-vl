/*!
 * CARTO VL js https://carto.com/
 * Version: 1.4.4
 * 
 */!function(e){var t={};function __webpack_require__(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,__webpack_require__),n.l=!0,n.exports}__webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,r){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(__webpack_require__.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)__webpack_require__.d(r,n,function(t){return e[t]}.bind(null,n));return r},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=49)}([function(e,t){e.exports=function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function _getPrototypeOf(t){return e.exports=_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(t)}e.exports=_getPrototypeOf},function(e,t){function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}},function(e,t,r){e.exports=r(35)},function(e,t,r){var n=r(9),i=r(38);e.exports=function _possibleConstructorReturn(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?i(e):t}},function(e,t,r){var n=r(14);e.exports=function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}},function(e,t,r){var n=r(32),i=r(33),o=r(34);e.exports=function _slicedToArray(e,t){return n(e)||i(e,t)||o()}},function(e,t){function asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}e.exports=function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(o,n,i,_next,_throw,"throw",e)}_next(void 0)})}}},function(e,t,r){var n=r(42),i=r(43),o=r(44);e.exports=function _toConsumableArray(e){return n(e)||i(e)||o()}},function(e,t){function _typeof2(e){return(_typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof2(e){return typeof e}:function _typeof2(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(t){return"function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?e.exports=_typeof=function _typeof(e){return _typeof2(e)}:e.exports=_typeof=function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)},_typeof(t)}e.exports=_typeof},function(e,t,r){r(1);var n=r(41);function _get(t,r,i){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=_get=Reflect.get:e.exports=_get=function _get(e,t,r){var i=n(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(r):o.value}},_get(t,r,i||t)}e.exports=_get},function(e,t,r){e.exports.VectorTile=r(37),e.exports.VectorTileFeature=r(16),e.exports.VectorTileLayer=r(15)},function(e,t,r){"use strict";e.exports=Pbf;var n=r(17);function Pbf(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Pbf.Varint=0,Pbf.Fixed64=1,Pbf.Bytes=2,Pbf.Fixed32=5;var i="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function readPackedEnd(e){return e.type===Pbf.Bytes?e.readVarint()+e.pos:e.pos+1}function toNum(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function makeRoomForExtraLength(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;i>=e;i--)r.buf[i+n]=r.buf[i]}function writePackedVarint(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function writePackedSVarint(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function writePackedFloat(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function writePackedDouble(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function writePackedBoolean(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function writePackedFixed32(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function writePackedSFixed32(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function writePackedFixed64(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function writePackedSFixed64(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function readUInt32(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function writeInt32(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function readInt32(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}Pbf.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=7&n,e(i,t,this),this.pos===o&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=readUInt32(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=readInt32(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=readUInt32(this.buf,this.pos)+4294967296*readUInt32(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=readUInt32(this.buf,this.pos)+4294967296*readInt32(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,n=this.buf;return t=127&(r=n[this.pos++]),r<128?t:(t|=(127&(r=n[this.pos++]))<<7,r<128?t:(t|=(127&(r=n[this.pos++]))<<14,r<128?t:(t|=(127&(r=n[this.pos++]))<<21,r<128?t:function readVarintRemainder(e,t,r){var n,i,o=r.buf;if(i=o[r.pos++],n=(112&i)>>4,i<128)return toNum(e,n,t);if(i=o[r.pos++],n|=(127&i)<<3,i<128)return toNum(e,n,t);if(i=o[r.pos++],n|=(127&i)<<10,i<128)return toNum(e,n,t);if(i=o[r.pos++],n|=(127&i)<<17,i<128)return toNum(e,n,t);if(i=o[r.pos++],n|=(127&i)<<24,i<128)return toNum(e,n,t);if(i=o[r.pos++],n|=(1&i)<<31,i<128)return toNum(e,n,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=n[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&i?function readUtf8TextDecoder(e,t,r){return i.decode(e.subarray(t,r))}(this.buf,t,e):function readUtf8(e,t,r){var n="",i=t;for(;i<r;){var o,a,s,u=e[i],c=null,f=u>239?4:u>223?3:u>191?2:1;if(i+f>r)break;1===f?u<128&&(c=u):2===f?128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)<=127&&(c=null):3===f?(o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&((c=(15&u)<<12|(63&o)<<6|63&a)<=2047||c>=55296&&c<=57343)&&(c=null)):4===f&&(o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,f=1):c>65535&&(c-=65536,n+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),n+=String.fromCharCode(c),i+=f}return n}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Pbf.Bytes)return e.push(this.readVarint(t));var r=readPackedEnd(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readSVarint());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readBoolean());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readFloat());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readDouble());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readFixed32());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readSFixed32());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readFixed64());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readSFixed64());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Pbf.Varint)for(;this.buf[this.pos++]>127;);else if(t===Pbf.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Pbf.Fixed32)this.pos+=4;else{if(t!==Pbf.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),writeInt32(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),writeInt32(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),writeInt32(this.buf,-1&e,this.pos),writeInt32(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),writeInt32(this.buf,-1&e,this.pos),writeInt32(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function writeBigVarint(e,t){var r,n;e>=0?(r=e%4294967296|0,n=e/4294967296|0):(n=~(-e/4294967296),4294967295^(r=~(-e%4294967296))?r=r+1|0:(r=0,n=n+1|0));if(e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function writeBigVarintLow(e,t,r){r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos]=127&e}(r,0,t),function writeBigVarintHigh(e,t){var r=(7&e)<<4;if(t.buf[t.pos++]|=r|((e>>>=3)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;t.buf[t.pos++]=127&e}(n,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function writeUtf8(e,t,r){for(var n,i,o=0;o<t.length;o++){if((n=t.charCodeAt(o))>55295&&n<57344){if(!i){n>56319||o+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):i=n;continue}if(n<56320){e[r++]=239,e[r++]=191,e[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(e[r++]=239,e[r++]=191,e[r++]=189,i=null);n<128?e[r++]=n:(n<2048?e[r++]=n>>6|192:(n<65536?e[r++]=n>>12|224:(e[r++]=n>>18|240,e[r++]=n>>12&63|128),e[r++]=n>>6&63|128),e[r++]=63&n|128)}return r}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&makeRoomForExtraLength(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),n.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),n.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var n=this.pos-r;n>=128&&makeRoomForExtraLength(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,r){this.writeTag(e,Pbf.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,writePackedVarint,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,writePackedSVarint,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,writePackedBoolean,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,writePackedFloat,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,writePackedDouble,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,writePackedFixed32,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,writePackedSFixed32,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,writePackedFixed64,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,writePackedSFixed64,t)},writeBytesField:function(e,t){this.writeTag(e,Pbf.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Pbf.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Pbf.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Pbf.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Pbf.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Pbf.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Pbf.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Pbf.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Pbf.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Pbf.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}}},function(e,t,r){"use strict";function Point(e,t){this.x=e,this.y=t}e.exports=Point,Point.prototype={clone:function(){return new Point(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,i=r*this.x+t*this.y;return this.x=n,this.y=i,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),i=t.x+r*(this.x-t.x)-n*(this.y-t.y),o=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Point.convert=function(e){return e instanceof Point?e:Array.isArray(e)?new Point(e[0],e[1]):e}},function(e,t){function _setPrototypeOf(t,r){return e.exports=_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e},_setPrototypeOf(t,r)}e.exports=_setPrototypeOf},function(e,t,r){"use strict";var n=r(16);function VectorTileLayer(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(readLayer,this,t),this.length=this._features.length}function readLayer(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function readValueMessage(e){var t=null,r=e.readVarint()+e.pos;for(;e.pos<r;){var n=e.readVarint()>>3;t=1===n?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null}return t}(r))}e.exports=VectorTileLayer,VectorTileLayer.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new n(this._pbf,t,this.extent,this._keys,this._values)}},function(e,t,r){"use strict";var n=r(13);function VectorTileFeature(e,t,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=i,e.readFields(readFeature,this,t)}function readFeature(e,t,r){1==e?t.id=r.readVarint():2==e?function readTag(e,t){var r=e.readVarint()+e.pos;for(;e.pos<r;){var n=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[n]=i}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function signedArea(e){for(var t,r,n=0,i=0,o=e.length,a=o-1;i<o;a=i++)t=e[i],n+=((r=e[a]).x-t.x)*(t.y+r.y);return n}e.exports=VectorTileFeature,VectorTileFeature.types=["Unknown","Point","LineString","Polygon"],VectorTileFeature.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,i=1,o=0,a=0,s=0,u=[];e.pos<r;){if(o<=0){var c=e.readVarint();i=7&c,o=c>>3}if(o--,1===i||2===i)a+=e.readSVarint(),s+=e.readSVarint(),1===i&&(t&&u.push(t),t=[]),t.push(new n(a,s));else{if(7!==i)throw new Error("unknown command "+i);t&&t.push(t[0].clone())}}return t&&u.push(t),u},VectorTileFeature.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,i=0,o=0,a=1/0,s=-1/0,u=1/0,c=-1/0;e.pos<t;){if(n<=0){var f=e.readVarint();r=7&f,n=f>>3}if(n--,1===r||2===r)i+=e.readSVarint(),o+=e.readSVarint(),i<a&&(a=i),i>s&&(s=i),o<u&&(u=o),o>c&&(c=o);else if(7!==r)throw new Error("unknown command "+r)}return[a,u,s,c]},VectorTileFeature.prototype.toGeoJSON=function(e,t,r){var n,i,o=this.extent*Math.pow(2,r),a=this.extent*e,s=this.extent*t,u=this.loadGeometry(),c=VectorTileFeature.types[this.type];function project(e){for(var t=0;t<e.length;t++){var r=e[t],n=180-360*(r.y+s)/o;e[t]=[360*(r.x+a)/o-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}}switch(this.type){case 1:var f=[];for(n=0;n<u.length;n++)f[n]=u[n][0];project(u=f);break;case 2:for(n=0;n<u.length;n++)project(u[n]);break;case 3:for(u=function classifyRings(e){var t=e.length;if(t<=1)return[e];for(var r,n,i=[],o=0;o<t;o++){var a=signedArea(e[o]);0!==a&&(void 0===n&&(n=a<0),n===a<0?(r&&i.push(r),r=[e[o]]):r.push(e[o]))}r&&i.push(r);return i}(u),n=0;n<u.length;n++)for(i=0;i<u[n].length;i++)project(u[n][i])}1===u.length?u=u[0]:c="Multi"+c;var l={type:"Feature",geometry:{type:c,coordinates:u},properties:this.properties};return"id"in this&&(l.id=this.id),l}},function(e,t){t.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,c=u>>1,f=-7,l=r?i-1:0,h=r?-1:1,p=e[t+l];for(l+=h,o=p&(1<<-f)-1,p>>=-f,f+=s;f>0;o=256*o+e[t+l],l+=h,f-=8);for(a=o&(1<<-f)-1,o>>=-f,f+=n;f>0;a=256*a+e[t+l],l+=h,f-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),o-=c}return(p?-1:1)*a*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var a,s,u,c=8*o-i-1,f=(1<<c)-1,l=f>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=f):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+l>=1?h/u:h*Math.pow(2,1-l))*u>=2&&(a++,u/=2),a+l>=f?(s=0,a=f):a+l>=1?(s=(t*u-1)*Math.pow(2,i),a+=l):(s=t*Math.pow(2,l-1)*Math.pow(2,i),a=0));i>=8;e[r+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+p]=255&a,p+=d,a/=256,c-=8);e[r+p-d]|=128*y}},function(e,t,r){"use strict";var n=r(19);function VectorTileLayer(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(readLayer,this,t),this.length=this._features.length}function readLayer(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function readValueMessage(e){var t=null,r=e.readVarint()+e.pos;for(;e.pos<r;){var n=e.readVarint()>>3;t=1===n?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null}return t}(r))}e.exports=VectorTileLayer,VectorTileLayer.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new n(this._pbf,t,this.extent,this._keys,this._values)}},function(e,t,r){"use strict";var n=r(13);function VectorTileFeature(e,t,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=i,e.readFields(readFeature,this,t)}function readFeature(e,t,r){1==e?t.id=r.readVarint():2==e?function readTag(e,t){var r=e.readVarint()+e.pos;for(;e.pos<r;){var n=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[n]=i}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function signedArea(e){for(var t,r,n=0,i=0,o=e.length,a=o-1;i<o;a=i++)t=e[i],n+=((r=e[a]).x-t.x)*(t.y+r.y);return n}e.exports=VectorTileFeature,VectorTileFeature.types=["Unknown","Point","LineString","Polygon"],VectorTileFeature.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,i=1,o=0,a=0,s=0,u=[];e.pos<r;){if(o<=0){var c=e.readVarint();i=7&c,o=c>>3}if(o--,1===i||2===i)a+=e.readSVarint(),s+=e.readSVarint(),1===i&&(t&&u.push(t),t=[]),t.push(new n(a,s));else{if(7!==i)throw new Error("unknown command "+i);t&&t.push(t[0].clone())}}return t&&u.push(t),u},VectorTileFeature.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,i=0,o=0,a=1/0,s=-1/0,u=1/0,c=-1/0;e.pos<t;){if(n<=0){var f=e.readVarint();r=7&f,n=f>>3}if(n--,1===r||2===r)i+=e.readSVarint(),o+=e.readSVarint(),i<a&&(a=i),i>s&&(s=i),o<u&&(u=o),o>c&&(c=o);else if(7!==r)throw new Error("unknown command "+r)}return[a,u,s,c]},VectorTileFeature.prototype.toGeoJSON=function(e,t,r){var n,i,o=this.extent*Math.pow(2,r),a=this.extent*e,s=this.extent*t,u=this.loadGeometry(),c=VectorTileFeature.types[this.type];function project(e){for(var t=0;t<e.length;t++){var r=e[t],n=180-360*(r.y+s)/o;e[t]=[360*(r.x+a)/o-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}}switch(this.type){case 1:var f=[];for(n=0;n<u.length;n++)f[n]=u[n][0];project(u=f);break;case 2:for(n=0;n<u.length;n++)project(u[n]);break;case 3:for(u=function classifyRings(e){var t=e.length;if(t<=1)return[e];for(var r,n,i=[],o=0;o<t;o++){var a=signedArea(e[o]);0!==a&&(void 0===n&&(n=a<0),n===a<0?(r&&i.push(r),r=[e[o]]):r.push(e[o]))}r&&i.push(r);return i}(u),n=0;n<u.length;n++)for(i=0;i<u[n].length;i++)project(u[n][i])}1===u.length?u=u[0]:c="Multi"+c;var l={type:"Feature",geometry:{type:c,coordinates:u},properties:this.properties};return"id"in this&&(l.id=this.id),l}},function(e,t,r){var n=r(1),i=r(14),o=r(39),a=r(40);function _wrapNativeSuper(t){var r="function"==typeof Map?new Map:void 0;return e.exports=_wrapNativeSuper=function _wrapNativeSuper(e){if(null===e||!o(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,Wrapper)}function Wrapper(){return a(e,arguments,n(this).constructor)}return Wrapper.prototype=Object.create(e.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),i(Wrapper,e)},_wrapNativeSuper(t)}e.exports=_wrapNativeSuper},function(e,t,r){"use strict";function earcut(e,t,r){r=r||2;var n,i,o,a,s,u,c,f=t&&t.length,l=f?t[0]*r:e.length,h=linkedList(e,0,l,r,!0),p=[];if(!h)return p;if(f&&(h=function eliminateHoles(e,t,r,n){var i,o,a,s,u,c=[];for(i=0,o=t.length;i<o;i++)a=t[i]*n,s=i<o-1?t[i+1]*n:e.length,(u=linkedList(e,a,s,n,!1))===u.next&&(u.steiner=!0),c.push(getLeftmost(u));for(c.sort(compareX),i=0;i<c.length;i++)eliminateHole(c[i],r),r=filterPoints(r,r.next);return r}(e,t,h,r)),e.length>80*r){n=o=e[0],i=a=e[1];for(var d=r;d<l;d+=r)s=e[d],u=e[d+1],s<n&&(n=s),u<i&&(i=u),s>o&&(o=s),u>a&&(a=u);c=0!==(c=Math.max(o-n,a-i))?1/c:0}return earcutLinked(h,p,r,n,i,c),p}function linkedList(e,t,r,n,i){var o,a;if(i===signedArea(e,t,r,n)>0)for(o=t;o<r;o+=n)a=insertNode(o,e[o],e[o+1],a);else for(o=r-n;o>=t;o-=n)a=insertNode(o,e[o],e[o+1],a);return a&&equals(a,a.next)&&(removeNode(a),a=a.next),a}function filterPoints(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!equals(n,n.next)&&0!==area(n.prev,n,n.next))n=n.next;else{if(removeNode(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function earcutLinked(e,t,r,n,i,o,a){if(e){!a&&o&&function indexCurve(e,t,r,n){var i=e;do{null===i.z&&(i.z=zOrder(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function sortLinked(e){var t,r,n,i,o,a,s,u,c=1;do{for(r=e,e=null,o=null,a=0;r;){for(a++,n=r,s=0,t=0;t<c&&(s++,n=n.nextZ);t++);for(u=c;s>0||u>0&&n;)0!==s&&(0===u||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,u--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;r=n}o.nextZ=null,c*=2}while(a>1);return e}(i)}(e,n,i,o);for(var s,u,c=e;e.prev!==e.next;)if(s=e.prev,u=e.next,o?isEarHashed(e,n,i,o):isEar(e))t.push(s.i/r),t.push(e.i/r),t.push(u.i/r),removeNode(e),e=u.next,c=u.next;else if((e=u)===c){a?1===a?earcutLinked(e=cureLocalIntersections(e,t,r),t,r,n,i,o,2):2===a&&splitEarcut(e,t,r,n,i,o):earcutLinked(filterPoints(e),t,r,n,i,o,1);break}}}function isEar(e){var t=e.prev,r=e,n=e.next;if(area(t,r,n)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(pointInTriangle(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&area(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function isEarHashed(e,t,r,n){var i=e.prev,o=e,a=e.next;if(area(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,c=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,f=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,l=zOrder(s,u,t,r,n),h=zOrder(c,f,t,r,n),p=e.prevZ,d=e.nextZ;p&&p.z>=l&&d&&d.z<=h;){if(p!==e.prev&&p!==e.next&&pointInTriangle(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,d!==e.prev&&d!==e.next&&pointInTriangle(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&area(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;p&&p.z>=l;){if(p!==e.prev&&p!==e.next&&pointInTriangle(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;d&&d.z<=h;){if(d!==e.prev&&d!==e.next&&pointInTriangle(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&area(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function cureLocalIntersections(e,t,r){var n=e;do{var i=n.prev,o=n.next.next;!equals(i,o)&&intersects(i,n,n.next,o)&&locallyInside(i,o)&&locallyInside(o,i)&&(t.push(i.i/r),t.push(n.i/r),t.push(o.i/r),removeNode(n),removeNode(n.next),n=e=o),n=n.next}while(n!==e);return n}function splitEarcut(e,t,r,n,i,o){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&isValidDiagonal(a,s)){var u=splitPolygon(a,s);return a=filterPoints(a,a.next),u=filterPoints(u,u.next),earcutLinked(a,t,r,n,i,o),void earcutLinked(u,t,r,n,i,o)}s=s.next}a=a.next}while(a!==e)}function compareX(e,t){return e.x-t.x}function eliminateHole(e,t){if(t=function findHoleBridge(e,t){var r,n=t,i=e.x,o=e.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>a){if(a=s,s===i){if(o===n.y)return n;if(o===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===a)return r.prev;var u,c=r,f=r.x,l=r.y,h=1/0;n=r.next;for(;n!==c;)i>=n.x&&n.x>=f&&i!==n.x&&pointInTriangle(o<l?i:a,o,f,l,o<l?a:i,o,n.x,n.y)&&((u=Math.abs(o-n.y)/(i-n.x))<h||u===h&&n.x>r.x)&&locallyInside(n,e)&&(r=n,h=u),n=n.next;return r}(e,t)){var r=splitPolygon(t,e);filterPoints(r,r.next)}}function zOrder(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function getLeftmost(e){var t=e,r=e;do{t.x<r.x&&(r=t),t=t.next}while(t!==e);return r}function pointInTriangle(e,t,r,n,i,o,a,s){return(i-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(n-s)-(r-a)*(t-s)>=0&&(r-a)*(o-s)-(i-a)*(n-s)>=0}function isValidDiagonal(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function intersectsPolygon(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&intersects(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&locallyInside(e,t)&&locallyInside(t,e)&&function middleInside(e,t){var r=e,n=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)}function area(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function equals(e,t){return e.x===t.x&&e.y===t.y}function intersects(e,t,r,n){return!!(equals(e,t)&&equals(r,n)||equals(e,n)&&equals(r,t))||area(e,t,r)>0!=area(e,t,n)>0&&area(r,n,e)>0!=area(r,n,t)>0}function locallyInside(e,t){return area(e.prev,e,e.next)<0?area(e,t,e.next)>=0&&area(e,e.prev,t)>=0:area(e,t,e.prev)<0||area(e,e.next,t)<0}function splitPolygon(e,t){var r=new Node(e.i,e.x,e.y),n=new Node(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function insertNode(e,t,r,n){var i=new Node(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function removeNode(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Node(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(e,t,r,n){for(var i=0,o=t,a=r-n;o<r;o+=n)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}e.exports=earcut,e.exports.default=earcut,earcut.deviation=function(e,t,r,n){var i=t&&t.length,o=i?t[0]*r:e.length,a=Math.abs(signedArea(e,0,o,r));if(i)for(var s=0,u=t.length;s<u;s++){var c=t[s]*r,f=s<u-1?t[s+1]*r:e.length;a-=Math.abs(signedArea(e,c,f,r))}var l=0;for(s=0;s<n.length;s+=3){var h=n[s]*r,p=n[s+1]*r,d=n[s+2]*r;l+=Math.abs((e[h]-e[d])*(e[p+1]-e[h+1])-(e[h]-e[p])*(e[d+1]-e[h+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},earcut.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)r.vertices.push(e[i][o][a]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r}},function(e,t){e.exports=parse,e.exports.parse=parse,e.exports.stringify=function stringify(e){"Feature"===e.type&&(e=e.geometry);function pairWKT(e){return e.join(" ")}function ringWKT(e){return e.map(pairWKT).join(", ")}function ringsWKT(e){return e.map(ringWKT).map(wrapParens).join(", ")}function wrapParens(e){return"("+e+")"}switch(e.type){case"Point":return"POINT ("+pairWKT(e.coordinates)+")";case"LineString":return"LINESTRING ("+ringWKT(e.coordinates)+")";case"Polygon":return"POLYGON ("+ringsWKT(e.coordinates)+")";case"MultiPoint":return"MULTIPOINT ("+ringWKT(e.coordinates)+")";case"MultiPolygon":return"MULTIPOLYGON ("+function multiRingsWKT(e){return e.map(ringsWKT).map(wrapParens).join(", ")}(e.coordinates)+")";case"MultiLineString":return"MULTILINESTRING ("+ringsWKT(e.coordinates)+")";case"GeometryCollection":return"GEOMETRYCOLLECTION ("+e.geometries.map(stringify).join(", ")+")";default:throw new Error("stringify requires a valid GeoJSON Feature or geometry object as input")}};var r=/[-+]?([0-9]*\.[0-9]+|[0-9]+)([eE][-+]?[0-9]+)?/,n=new RegExp("^"+r.source+"(\\s"+r.source+"){1,}");function parse(e){var t=e.split(";"),r=t.pop(),i=(t.shift()||"").split("=").pop(),o=0;function $(e){var t=r.substring(o).match(e);return t?(o+=t[0].length,t[0]):null}function white(){$(/^\s*/)}function multicoords(){white();for(var e,t=0,r=[],i=[r],o=r;e=$(/^(\()/)||$(/^(\))/)||$(/^(,)/)||$(n);){if("("===e)i.push(o),o=[],i[i.length-1].push(o),t++;else if(")"===e){if(0===o.length)return null;if(!(o=i.pop()))return null;if(0===--t)break}else if(","===e)o=[],i[i.length-1].push(o);else{if(e.split(/\s/g).some(isNaN))return null;Array.prototype.push.apply(o,e.split(/\s/g).map(parseFloat))}white()}return 0!==t?null:r}function coords(){for(var e,t,r=[];t=$(n)||$(/^(,)/);)","===t?(r.push(e),e=[]):t.split(/\s/g).some(isNaN)||(e||(e=[]),Array.prototype.push.apply(e,t.split(/\s/g).map(parseFloat))),white();return e?(r.push(e),r.length?r:null):null}function root(){return function point(){if(!$(/^(point(\sz)?)/i))return null;if(white(),!$(/^(\()/))return null;var e=coords();return e?(white(),$(/^(\))/)?{type:"Point",coordinates:e[0]}:null):null}()||function linestring(){if(!$(/^(linestring(\sz)?)/i))return null;if(white(),!$(/^(\()/))return null;var e=coords();return e&&$(/^(\))/)?{type:"LineString",coordinates:e}:null}()||function polygon(){if(!$(/^(polygon(\sz)?)/i))return null;white();var e=multicoords();return e?{type:"Polygon",coordinates:e}:null}()||function multipoint(){if(!$(/^(multipoint)/i))return null;white();var e=r.substring(r.indexOf("(")+1,r.length-1).replace(/\(/g,"").replace(/\)/g,"");r="MULTIPOINT ("+e+")";var t=multicoords();return t?(white(),{type:"MultiPoint",coordinates:t}):null}()||function multilinestring(){if(!$(/^(multilinestring)/i))return null;white();var e=multicoords();return e?(white(),{type:"MultiLineString",coordinates:e}):null}()||function multipolygon(){if(!$(/^(multipolygon)/i))return null;white();var e=multicoords();return e?{type:"MultiPolygon",coordinates:e}:null}()||function geometrycollection(){var e,t=[];if(!$(/^(geometrycollection)/i))return null;if(white(),!$(/^(\()/))return null;for(;e=root();)t.push(e),white(),$(/^(,)/),white();return $(/^(\))/)?{type:"GeometryCollection",geometries:t}:null}()}return function crs(e){return e&&i.match(/\d+/)&&(e.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+i}}),e}(root())}},function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(256),n=0;n<e.length;n++)r[e.charCodeAt(n)]=n;t.encode=function(t){var r,n=new Uint8Array(t),i=n.length,o="";for(r=0;r<i;r+=3)o+=e[n[r]>>2],o+=e[(3&n[r])<<4|n[r+1]>>4],o+=e[(15&n[r+1])<<2|n[r+2]>>6],o+=e[63&n[r+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(e){var t,n,i,o,a,s=.75*e.length,u=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var f=new ArrayBuffer(s),l=new Uint8Array(f);for(t=0;t<u;t+=4)n=r[e.charCodeAt(t)],i=r[e.charCodeAt(t+1)],o=r[e.charCodeAt(t+2)],a=r[e.charCodeAt(t+3)],l[c++]=n<<2|i>>4,l[c++]=(15&i)<<4|o>>2,l[c++]=(3&o)<<6|63&a;return f}}()},function(e,t,r){var n=r(45),i=r(46);function fromVectorTileJs(e){var t=new n;return function writeTile(e,t){for(var r in e.layers)t.writeMessage(3,writeLayer,e.layers[r])}(e,t),t.finish()}function writeLayer(e,t){var r;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var n={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<e.length;r++)n.feature=e.feature(r),t.writeMessage(2,writeFeature,n);var i=n.keys;for(r=0;r<i.length;r++)t.writeStringField(3,i[r]);var o=n.values;for(r=0;r<o.length;r++)t.writeMessage(4,writeValue,o[r])}function writeFeature(e,t){var r=e.feature;void 0!==r.id&&t.writeVarintField(1,r.id),t.writeMessage(2,writeProperties,e),t.writeVarintField(3,r.type),t.writeMessage(4,writeGeometry,r)}function writeProperties(e,t){var r=e.feature,n=e.keys,i=e.values,o=e.keycache,a=e.valuecache;for(var s in r.properties){var u=o[s];void 0===u&&(n.push(s),u=n.length-1,o[s]=u),t.writeVarint(u);var c=r.properties[s],f=typeof c;"string"!==f&&"boolean"!==f&&"number"!==f&&(c=JSON.stringify(c));var l=f+":"+c,h=a[l];void 0===h&&(i.push(c),h=i.length-1,a[l]=h),t.writeVarint(h)}}function command(e,t){return(t<<3)+(7&e)}function zigzag(e){return e<<1^e>>31}function writeGeometry(e,t){for(var r=e.loadGeometry(),n=e.type,i=0,o=0,a=r.length,s=0;s<a;s++){var u=r[s],c=1;1===n&&(c=u.length),t.writeVarint(command(1,c));for(var f=3===n?u.length-1:u.length,l=0;l<f;l++){1===l&&1!==n&&t.writeVarint(command(2,f-1));var h=u[l].x-i,p=u[l].y-o;t.writeVarint(zigzag(h)),t.writeVarint(zigzag(p)),i+=h,o+=p}3===n&&t.writeVarint(command(7,1))}}function writeValue(e,t){var r=typeof e;"string"===r?t.writeStringField(1,e):"boolean"===r?t.writeBooleanField(7,e):"number"===r&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}e.exports=fromVectorTileJs,e.exports.fromVectorTileJs=fromVectorTileJs,e.exports.fromGeojsonVt=function fromGeojsonVt(e,t){t=t||{};var r={};for(var n in e)r[n]=new i(e[n].features,t),r[n].name=n,r[n].version=t.version,r[n].extent=t.extent;return fromVectorTileJs({layers:r})},e.exports.GeoJSONWrapper=i},,,,,,,,function(e,t){e.exports=function _arrayWithHoles(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function _iterableToArrayLimit(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}},function(e,t){e.exports=function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(e,t,r){var n=function(){return this||"object"==typeof self&&self}()||Function("return this")(),i=n.regeneratorRuntime&&Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime")>=0,o=i&&n.regeneratorRuntime;if(n.regeneratorRuntime=void 0,e.exports=r(36),i)n.regeneratorRuntime=o;else try{delete n.regeneratorRuntime}catch(e){n.regeneratorRuntime=void 0}},function(e,t){!function(t){"use strict";var r,n=Object.prototype,i=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag",c="object"==typeof e,f=t.regeneratorRuntime;if(f)c&&(e.exports=f);else{(f=t.regeneratorRuntime=c?e.exports:{}).wrap=wrap;var l="suspendedStart",h="suspendedYield",p="executing",d="completed",y={},v={};v[a]=function(){return this};var m=Object.getPrototypeOf,g=m&&m(m(values([])));g&&g!==n&&i.call(g,a)&&(v=g);var x=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(v);GeneratorFunction.prototype=x.constructor=GeneratorFunctionPrototype,GeneratorFunctionPrototype.constructor=GeneratorFunction,GeneratorFunctionPrototype[u]=GeneratorFunction.displayName="GeneratorFunction",f.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},f.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,u in e||(e[u]="GeneratorFunction")),e.prototype=Object.create(x),e},f.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),AsyncIterator.prototype[s]=function(){return this},f.AsyncIterator=AsyncIterator,f.async=function(e,t,r,n){var i=new AsyncIterator(wrap(e,t,r,n));return f.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},defineIteratorMethods(x),x[u]="Generator",x[a]=function(){return this},x.toString=function(){return"[object Generator]"},f.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function next(){for(;t.length;){var r=t.pop();if(r in e)return next.value=r,next.done=!1,next}return next.done=!0,next}},f.values=values,Context.prototype={constructor:Context,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(resetTryEntry),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function handle(n,i){return a.type="throw",a.arg=e,t.next=n,i&&(t.method="next",t.arg=r),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],a=o.completion;if("root"===o.tryLoc)return handle("end");if(o.tryLoc<=this.prev){var s=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return handle(o.catchLoc,!0);if(this.prev<o.finallyLoc)return handle(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return handle(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return handle(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;resetTryEntry(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:values(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=r),y}}}function wrap(e,t,r,n){var i=t&&t.prototype instanceof Generator?t:Generator,o=Object.create(i.prototype),a=new Context(n||[]);return o._invoke=function makeInvokeMethod(e,t,r){var n=l;return function invoke(i,o){if(n===p)throw new Error("Generator is already running");if(n===d){if("throw"===i)throw o;return doneResult()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=maybeInvokeDelegate(a,r);if(s){if(s===y)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===l)throw n=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var u=tryCatch(e,t,r);if("normal"===u.type){if(n=r.done?d:h,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=d,r.method="throw",r.arg=u.arg)}}}(e,r,a),o}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}function defineIteratorMethods(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function AsyncIterator(e){var t;this._invoke=function enqueue(r,n){function callInvokeWithMethodAndArg(){return new Promise(function(t,o){!function invoke(t,r,n,o){var a=tryCatch(e[t],e,r);if("throw"!==a.type){var s=a.arg,u=s.value;return u&&"object"==typeof u&&i.call(u,"__await")?Promise.resolve(u.__await).then(function(e){invoke("next",e,n,o)},function(e){invoke("throw",e,n,o)}):Promise.resolve(u).then(function(e){s.value=e,n(s)},function(e){return invoke("throw",e,n,o)})}o(a.arg)}(r,n,t,o)})}return t=t?t.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}}function maybeInvokeDelegate(e,t){var n=e.iterator[t.method];if(n===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=r,maybeInvokeDelegate(e,t),"throw"===t.method))return y;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var i=tryCatch(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,y;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,y):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,y)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function next(){for(;++n<e.length;)if(i.call(e,n))return next.value=e[n],next.done=!1,next;return next.value=r,next.done=!0,next};return o.next=o}}return{next:doneResult}}function doneResult(){return{value:r,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},function(e,t,r){"use strict";var n=r(15);function readTile(e,t,r){if(3===e){var i=new n(r,r.readVarint()+r.pos);i.length&&(t[i.name]=i)}}e.exports=function VectorTile(e,t){this.layers=e.readFields(readTile,{},t)}},function(e,t){e.exports=function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){e.exports=function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}},function(e,t,r){var n=r(14);function _construct(t,r,i){return!function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?e.exports=_construct=function _construct(e,t,r){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return r&&n(o,r.prototype),o}:e.exports=_construct=Reflect.construct,_construct.apply(null,arguments)}e.exports=_construct},function(e,t,r){var n=r(1);e.exports=function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e}},function(e,t){e.exports=function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}},function(e,t){e.exports=function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},function(e,t){e.exports=function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(e,t,r){"use strict";e.exports=Pbf;var n=r(17);function Pbf(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Pbf.Varint=0,Pbf.Fixed64=1,Pbf.Bytes=2,Pbf.Fixed32=5;var i="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function readPackedEnd(e){return e.type===Pbf.Bytes?e.readVarint()+e.pos:e.pos+1}function toNum(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function makeRoomForExtraLength(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;i>=e;i--)r.buf[i+n]=r.buf[i]}function writePackedVarint(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function writePackedSVarint(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function writePackedFloat(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function writePackedDouble(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function writePackedBoolean(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function writePackedFixed32(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function writePackedSFixed32(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function writePackedFixed64(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function writePackedSFixed64(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function readUInt32(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function writeInt32(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function readInt32(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}Pbf.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=7&n,e(i,t,this),this.pos===o&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=readUInt32(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=readInt32(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=readUInt32(this.buf,this.pos)+4294967296*readUInt32(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=readUInt32(this.buf,this.pos)+4294967296*readInt32(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,n=this.buf;return t=127&(r=n[this.pos++]),r<128?t:(t|=(127&(r=n[this.pos++]))<<7,r<128?t:(t|=(127&(r=n[this.pos++]))<<14,r<128?t:(t|=(127&(r=n[this.pos++]))<<21,r<128?t:function readVarintRemainder(e,t,r){var n,i,o=r.buf;if(i=o[r.pos++],n=(112&i)>>4,i<128)return toNum(e,n,t);if(i=o[r.pos++],n|=(127&i)<<3,i<128)return toNum(e,n,t);if(i=o[r.pos++],n|=(127&i)<<10,i<128)return toNum(e,n,t);if(i=o[r.pos++],n|=(127&i)<<17,i<128)return toNum(e,n,t);if(i=o[r.pos++],n|=(127&i)<<24,i<128)return toNum(e,n,t);if(i=o[r.pos++],n|=(1&i)<<31,i<128)return toNum(e,n,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=n[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&i?function readUtf8TextDecoder(e,t,r){return i.decode(e.subarray(t,r))}(this.buf,t,e):function readUtf8(e,t,r){var n="",i=t;for(;i<r;){var o,a,s,u=e[i],c=null,f=u>239?4:u>223?3:u>191?2:1;if(i+f>r)break;1===f?u<128&&(c=u):2===f?128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)<=127&&(c=null):3===f?(o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&((c=(15&u)<<12|(63&o)<<6|63&a)<=2047||c>=55296&&c<=57343)&&(c=null)):4===f&&(o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,f=1):c>65535&&(c-=65536,n+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),n+=String.fromCharCode(c),i+=f}return n}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Pbf.Bytes)return e.push(this.readVarint(t));var r=readPackedEnd(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readSVarint());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readBoolean());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readFloat());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readDouble());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readFixed32());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readSFixed32());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readFixed64());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readSFixed64());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Pbf.Varint)for(;this.buf[this.pos++]>127;);else if(t===Pbf.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Pbf.Fixed32)this.pos+=4;else{if(t!==Pbf.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),writeInt32(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),writeInt32(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),writeInt32(this.buf,-1&e,this.pos),writeInt32(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),writeInt32(this.buf,-1&e,this.pos),writeInt32(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function writeBigVarint(e,t){var r,n;e>=0?(r=e%4294967296|0,n=e/4294967296|0):(n=~(-e/4294967296),4294967295^(r=~(-e%4294967296))?r=r+1|0:(r=0,n=n+1|0));if(e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function writeBigVarintLow(e,t,r){r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos]=127&e}(r,0,t),function writeBigVarintHigh(e,t){var r=(7&e)<<4;if(t.buf[t.pos++]|=r|((e>>>=3)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;t.buf[t.pos++]=127&e}(n,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function writeUtf8(e,t,r){for(var n,i,o=0;o<t.length;o++){if((n=t.charCodeAt(o))>55295&&n<57344){if(!i){n>56319||o+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):i=n;continue}if(n<56320){e[r++]=239,e[r++]=191,e[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(e[r++]=239,e[r++]=191,e[r++]=189,i=null);n<128?e[r++]=n:(n<2048?e[r++]=n>>6|192:(n<65536?e[r++]=n>>12|224:(e[r++]=n>>18|240,e[r++]=n>>12&63|128),e[r++]=n>>6&63|128),e[r++]=63&n|128)}return r}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&makeRoomForExtraLength(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),n.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),n.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var n=this.pos-r;n>=128&&makeRoomForExtraLength(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,r){this.writeTag(e,Pbf.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,writePackedVarint,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,writePackedSVarint,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,writePackedBoolean,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,writePackedFloat,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,writePackedDouble,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,writePackedFixed32,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,writePackedSFixed32,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,writePackedFixed64,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,writePackedSFixed64,t)},writeBytesField:function(e,t){this.writeTag(e,Pbf.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Pbf.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Pbf.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Pbf.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Pbf.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Pbf.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Pbf.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Pbf.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Pbf.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Pbf.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}}},function(e,t,r){"use strict";var n=r(13),i=r(47).VectorTileFeature;function GeoJSONWrapper(e,t){this.options=t||{},this.features=e,this.length=e.length}function FeatureWrapper(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}e.exports=GeoJSONWrapper,GeoJSONWrapper.prototype.feature=function(e){return new FeatureWrapper(this.features[e],this.options.extent)},FeatureWrapper.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var t=0;t<e.length;t++){for(var r=e[t],i=[],o=0;o<r.length;o++)i.push(new n(r[o][0],r[o][1]));this.geometry.push(i)}return this.geometry},FeatureWrapper.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,r=-1/0,n=1/0,i=-1/0,o=0;o<e.length;o++)for(var a=e[o],s=0;s<a.length;s++){var u=a[s];t=Math.min(t,u.x),r=Math.max(r,u.x),n=Math.min(n,u.y),i=Math.max(i,u.y)}return[t,n,r,i]},FeatureWrapper.prototype.toGeoJSON=i.prototype.toGeoJSON},function(e,t,r){e.exports.VectorTile=r(48),e.exports.VectorTileFeature=r(19),e.exports.VectorTileLayer=r(18)},function(e,t,r){"use strict";var n=r(18);function readTile(e,t,r){if(3===e){var i=new n(r,r.readVarint()+r.pos);i.length&&(t[i.name]=i)}}e.exports=function VectorTile(e,t){this.layers=e.readFields(readTile,{},t)}},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"create",function(){return create}),r.d(n,"clone",function(){return clone}),r.d(n,"copy",function(){return copy}),r.d(n,"fromValues",function(){return fromValues}),r.d(n,"set",function(){return set}),r.d(n,"identity",function(){return identity}),r.d(n,"transpose",function(){return transpose}),r.d(n,"invert",function(){return invert}),r.d(n,"adjoint",function(){return adjoint}),r.d(n,"determinant",function(){return determinant}),r.d(n,"multiply",function(){return multiply}),r.d(n,"translate",function(){return translate}),r.d(n,"scale",function(){return mat4_scale}),r.d(n,"rotate",function(){return rotate}),r.d(n,"rotateX",function(){return rotateX}),r.d(n,"rotateY",function(){return rotateY}),r.d(n,"rotateZ",function(){return rotateZ}),r.d(n,"fromTranslation",function(){return fromTranslation}),r.d(n,"fromScaling",function(){return fromScaling}),r.d(n,"fromRotation",function(){return fromRotation}),r.d(n,"fromXRotation",function(){return fromXRotation}),r.d(n,"fromYRotation",function(){return fromYRotation}),r.d(n,"fromZRotation",function(){return fromZRotation}),r.d(n,"fromRotationTranslation",function(){return fromRotationTranslation}),r.d(n,"fromQuat2",function(){return fromQuat2}),r.d(n,"getTranslation",function(){return getTranslation}),r.d(n,"getScaling",function(){return getScaling}),r.d(n,"getRotation",function(){return getRotation}),r.d(n,"fromRotationTranslationScale",function(){return fromRotationTranslationScale}),r.d(n,"fromRotationTranslationScaleOrigin",function(){return fromRotationTranslationScaleOrigin}),r.d(n,"fromQuat",function(){return fromQuat}),r.d(n,"frustum",function(){return frustum}),r.d(n,"perspective",function(){return perspective}),r.d(n,"perspectiveFromFieldOfView",function(){return perspectiveFromFieldOfView}),r.d(n,"ortho",function(){return ortho}),r.d(n,"lookAt",function(){return lookAt}),r.d(n,"targetTo",function(){return targetTo}),r.d(n,"str",function(){return str}),r.d(n,"frob",function(){return frob}),r.d(n,"add",function(){return add}),r.d(n,"subtract",function(){return subtract}),r.d(n,"multiplyScalar",function(){return multiplyScalar}),r.d(n,"multiplyScalarAndAdd",function(){return multiplyScalarAndAdd}),r.d(n,"exactEquals",function(){return exactEquals}),r.d(n,"equals",function(){return mat4_equals}),r.d(n,"mul",function(){return _}),r.d(n,"sub",function(){return P});var i={};r.r(i),r.d(i,"create",function(){return vec4_create}),r.d(i,"clone",function(){return vec4_clone}),r.d(i,"fromValues",function(){return vec4_fromValues}),r.d(i,"copy",function(){return vec4_copy}),r.d(i,"set",function(){return vec4_set}),r.d(i,"add",function(){return vec4_add}),r.d(i,"subtract",function(){return vec4_subtract}),r.d(i,"multiply",function(){return vec4_multiply}),r.d(i,"divide",function(){return divide}),r.d(i,"ceil",function(){return ceil}),r.d(i,"floor",function(){return floor}),r.d(i,"min",function(){return vec4_min}),r.d(i,"max",function(){return vec4_max}),r.d(i,"round",function(){return round}),r.d(i,"scale",function(){return vec4_scale}),r.d(i,"scaleAndAdd",function(){return scaleAndAdd}),r.d(i,"distance",function(){return distance}),r.d(i,"squaredDistance",function(){return squaredDistance}),r.d(i,"length",function(){return vec4_length}),r.d(i,"squaredLength",function(){return squaredLength}),r.d(i,"negate",function(){return negate}),r.d(i,"inverse",function(){return inverse}),r.d(i,"normalize",function(){return normalize}),r.d(i,"dot",function(){return dot}),r.d(i,"lerp",function(){return lerp}),r.d(i,"random",function(){return random}),r.d(i,"transformMat4",function(){return transformMat4}),r.d(i,"transformQuat",function(){return transformQuat}),r.d(i,"str",function(){return vec4_str}),r.d(i,"exactEquals",function(){return vec4_exactEquals}),r.d(i,"equals",function(){return vec4_equals}),r.d(i,"sub",function(){return M}),r.d(i,"mul",function(){return T}),r.d(i,"div",function(){return k}),r.d(i,"dist",function(){return F}),r.d(i,"sqrDist",function(){return V}),r.d(i,"len",function(){return S}),r.d(i,"sqrLen",function(){return I}),r.d(i,"forEach",function(){return E});var o=r(6),a=r.n(o),s=r(3),u=r.n(s),c=r(7),f=r.n(c),l=r(0),h=r.n(l),p=r(2),d=r.n(p),y=r(11),v=r(12);function getRsysFromTile(e,t,r){return{center:{x:(e+.5)/Math.pow(2,r)*2-1,y:2*(1-(t+.5)/Math.pow(2,r))-1},scale:1/Math.pow(2,r)}}var m=r(8),g=r.n(m),x=1e-6,w="undefined"!=typeof Float32Array?Float32Array:Array,b=Math.random;Math.PI;function create(){var e=new w(16);return w!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function clone(e){var t=new w(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function copy(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function fromValues(e,t,r,n,i,o,a,s,u,c,f,l,h,p,d,y){var v=new w(16);return v[0]=e,v[1]=t,v[2]=r,v[3]=n,v[4]=i,v[5]=o,v[6]=a,v[7]=s,v[8]=u,v[9]=c,v[10]=f,v[11]=l,v[12]=h,v[13]=p,v[14]=d,v[15]=y,v}function set(e,t,r,n,i,o,a,s,u,c,f,l,h,p,d,y,v){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=u,e[8]=c,e[9]=f,e[10]=l,e[11]=h,e[12]=p,e[13]=d,e[14]=y,e[15]=v,e}function identity(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function transpose(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function invert(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],f=t[8],l=t[9],h=t[10],p=t[11],d=t[12],y=t[13],v=t[14],m=t[15],g=r*s-n*a,x=r*u-i*a,w=r*c-o*a,b=n*u-i*s,_=n*c-o*s,P=i*c-o*u,M=f*y-l*d,T=f*v-h*d,k=f*m-p*d,F=l*v-h*y,V=l*m-p*y,S=h*m-p*v,I=g*S-x*V+w*F+b*k-_*T+P*M;return I?(I=1/I,e[0]=(s*S-u*V+c*F)*I,e[1]=(i*V-n*S-o*F)*I,e[2]=(y*P-v*_+m*b)*I,e[3]=(h*_-l*P-p*b)*I,e[4]=(u*k-a*S-c*T)*I,e[5]=(r*S-i*k+o*T)*I,e[6]=(v*w-d*P-m*x)*I,e[7]=(f*P-h*w+p*x)*I,e[8]=(a*V-s*k+c*M)*I,e[9]=(n*k-r*V-o*M)*I,e[10]=(d*_-y*w+m*g)*I,e[11]=(l*w-f*_-p*g)*I,e[12]=(s*T-a*F-u*M)*I,e[13]=(r*F-n*T+i*M)*I,e[14]=(y*x-d*b-v*g)*I,e[15]=(f*b-l*x+h*g)*I,e):null}function adjoint(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],f=t[8],l=t[9],h=t[10],p=t[11],d=t[12],y=t[13],v=t[14],m=t[15];return e[0]=s*(h*m-p*v)-l*(u*m-c*v)+y*(u*p-c*h),e[1]=-(n*(h*m-p*v)-l*(i*m-o*v)+y*(i*p-o*h)),e[2]=n*(u*m-c*v)-s*(i*m-o*v)+y*(i*c-o*u),e[3]=-(n*(u*p-c*h)-s*(i*p-o*h)+l*(i*c-o*u)),e[4]=-(a*(h*m-p*v)-f*(u*m-c*v)+d*(u*p-c*h)),e[5]=r*(h*m-p*v)-f*(i*m-o*v)+d*(i*p-o*h),e[6]=-(r*(u*m-c*v)-a*(i*m-o*v)+d*(i*c-o*u)),e[7]=r*(u*p-c*h)-a*(i*p-o*h)+f*(i*c-o*u),e[8]=a*(l*m-p*y)-f*(s*m-c*y)+d*(s*p-c*l),e[9]=-(r*(l*m-p*y)-f*(n*m-o*y)+d*(n*p-o*l)),e[10]=r*(s*m-c*y)-a*(n*m-o*y)+d*(n*c-o*s),e[11]=-(r*(s*p-c*l)-a*(n*p-o*l)+f*(n*c-o*s)),e[12]=-(a*(l*v-h*y)-f*(s*v-u*y)+d*(s*h-u*l)),e[13]=r*(l*v-h*y)-f*(n*v-i*y)+d*(n*h-i*l),e[14]=-(r*(s*v-u*y)-a*(n*v-i*y)+d*(n*u-i*s)),e[15]=r*(s*h-u*l)-a*(n*h-i*l)+f*(n*u-i*s),e}function determinant(e){var t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],f=e[9],l=e[10],h=e[11],p=e[12],d=e[13],y=e[14],v=e[15];return(t*a-r*o)*(l*v-h*y)-(t*s-n*o)*(f*v-h*d)+(t*u-i*o)*(f*y-l*d)+(r*s-n*a)*(c*v-h*p)-(r*u-i*a)*(c*y-l*p)+(n*u-i*s)*(c*d-f*p)}function multiply(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],f=t[7],l=t[8],h=t[9],p=t[10],d=t[11],y=t[12],v=t[13],m=t[14],g=t[15],x=r[0],w=r[1],b=r[2],_=r[3];return e[0]=x*n+w*s+b*l+_*y,e[1]=x*i+w*u+b*h+_*v,e[2]=x*o+w*c+b*p+_*m,e[3]=x*a+w*f+b*d+_*g,x=r[4],w=r[5],b=r[6],_=r[7],e[4]=x*n+w*s+b*l+_*y,e[5]=x*i+w*u+b*h+_*v,e[6]=x*o+w*c+b*p+_*m,e[7]=x*a+w*f+b*d+_*g,x=r[8],w=r[9],b=r[10],_=r[11],e[8]=x*n+w*s+b*l+_*y,e[9]=x*i+w*u+b*h+_*v,e[10]=x*o+w*c+b*p+_*m,e[11]=x*a+w*f+b*d+_*g,x=r[12],w=r[13],b=r[14],_=r[15],e[12]=x*n+w*s+b*l+_*y,e[13]=x*i+w*u+b*h+_*v,e[14]=x*o+w*c+b*p+_*m,e[15]=x*a+w*f+b*d+_*g,e}function translate(e,t,r){var n=r[0],i=r[1],o=r[2],a=void 0,s=void 0,u=void 0,c=void 0,f=void 0,l=void 0,h=void 0,p=void 0,d=void 0,y=void 0,v=void 0,m=void 0;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*o+t[12],e[13]=t[1]*n+t[5]*i+t[9]*o+t[13],e[14]=t[2]*n+t[6]*i+t[10]*o+t[14],e[15]=t[3]*n+t[7]*i+t[11]*o+t[15]):(a=t[0],s=t[1],u=t[2],c=t[3],f=t[4],l=t[5],h=t[6],p=t[7],d=t[8],y=t[9],v=t[10],m=t[11],e[0]=a,e[1]=s,e[2]=u,e[3]=c,e[4]=f,e[5]=l,e[6]=h,e[7]=p,e[8]=d,e[9]=y,e[10]=v,e[11]=m,e[12]=a*n+f*i+d*o+t[12],e[13]=s*n+l*i+y*o+t[13],e[14]=u*n+h*i+v*o+t[14],e[15]=c*n+p*i+m*o+t[15]),e}function mat4_scale(e,t,r){var n=r[0],i=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function rotate(e,t,r,n){var i,o,a,s,u,c,f,l,h,p,d,y,v,m,g,w,b,_,P,M,T,k,F,V,S=n[0],I=n[1],E=n[2],N=Math.sqrt(S*S+I*I+E*E);return N<x?null:(S*=N=1/N,I*=N,E*=N,i=Math.sin(r),a=1-(o=Math.cos(r)),s=t[0],u=t[1],c=t[2],f=t[3],l=t[4],h=t[5],p=t[6],d=t[7],y=t[8],v=t[9],m=t[10],g=t[11],w=S*S*a+o,b=I*S*a+E*i,_=E*S*a-I*i,P=S*I*a-E*i,M=I*I*a+o,T=E*I*a+S*i,k=S*E*a+I*i,F=I*E*a-S*i,V=E*E*a+o,e[0]=s*w+l*b+y*_,e[1]=u*w+h*b+v*_,e[2]=c*w+p*b+m*_,e[3]=f*w+d*b+g*_,e[4]=s*P+l*M+y*T,e[5]=u*P+h*M+v*T,e[6]=c*P+p*M+m*T,e[7]=f*P+d*M+g*T,e[8]=s*k+l*F+y*V,e[9]=u*k+h*F+v*V,e[10]=c*k+p*F+m*V,e[11]=f*k+d*F+g*V,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function rotateX(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],f=t[9],l=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*n,e[5]=a*i+f*n,e[6]=s*i+l*n,e[7]=u*i+h*n,e[8]=c*i-o*n,e[9]=f*i-a*n,e[10]=l*i-s*n,e[11]=h*i-u*n,e}function rotateY(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],u=t[3],c=t[8],f=t[9],l=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*n,e[1]=a*i-f*n,e[2]=s*i-l*n,e[3]=u*i-h*n,e[8]=o*n+c*i,e[9]=a*n+f*i,e[10]=s*n+l*i,e[11]=u*n+h*i,e}function rotateZ(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],u=t[3],c=t[4],f=t[5],l=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+c*n,e[1]=a*i+f*n,e[2]=s*i+l*n,e[3]=u*i+h*n,e[4]=c*i-o*n,e[5]=f*i-a*n,e[6]=l*i-s*n,e[7]=h*i-u*n,e}function fromTranslation(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function fromScaling(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fromRotation(e,t,r){var n,i,o,a=r[0],s=r[1],u=r[2],c=Math.sqrt(a*a+s*s+u*u);return c<x?null:(a*=c=1/c,s*=c,u*=c,n=Math.sin(t),o=1-(i=Math.cos(t)),e[0]=a*a*o+i,e[1]=s*a*o+u*n,e[2]=u*a*o-s*n,e[3]=0,e[4]=a*s*o-u*n,e[5]=s*s*o+i,e[6]=u*s*o+a*n,e[7]=0,e[8]=a*u*o+s*n,e[9]=s*u*o-a*n,e[10]=u*u*o+i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function fromXRotation(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fromYRotation(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fromZRotation(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fromRotationTranslation(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=n+n,u=i+i,c=o+o,f=n*s,l=n*u,h=n*c,p=i*u,d=i*c,y=o*c,v=a*s,m=a*u,g=a*c;return e[0]=1-(p+y),e[1]=l+g,e[2]=h-m,e[3]=0,e[4]=l-g,e[5]=1-(f+y),e[6]=d+v,e[7]=0,e[8]=h+m,e[9]=d-v,e[10]=1-(f+p),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function fromQuat2(e,t){var r=new w(3),n=-t[0],i=-t[1],o=-t[2],a=t[3],s=t[4],u=t[5],c=t[6],f=t[7],l=n*n+i*i+o*o+a*a;return l>0?(r[0]=2*(s*a+f*n+u*o-c*i)/l,r[1]=2*(u*a+f*i+c*n-s*o)/l,r[2]=2*(c*a+f*o+s*i-u*n)/l):(r[0]=2*(s*a+f*n+u*o-c*i),r[1]=2*(u*a+f*i+c*n-s*o),r[2]=2*(c*a+f*o+s*i-u*n)),fromRotationTranslation(e,t,r),e}function getTranslation(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function getScaling(e,t){var r=t[0],n=t[1],i=t[2],o=t[4],a=t[5],s=t[6],u=t[8],c=t[9],f=t[10];return e[0]=Math.sqrt(r*r+n*n+i*i),e[1]=Math.sqrt(o*o+a*a+s*s),e[2]=Math.sqrt(u*u+c*c+f*f),e}function getRotation(e,t){var r=t[0]+t[5]+t[10],n=0;return r>0?(n=2*Math.sqrt(r+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n),e}function fromRotationTranslationScale(e,t,r,n){var i=t[0],o=t[1],a=t[2],s=t[3],u=i+i,c=o+o,f=a+a,l=i*u,h=i*c,p=i*f,d=o*c,y=o*f,v=a*f,m=s*u,g=s*c,x=s*f,w=n[0],b=n[1],_=n[2];return e[0]=(1-(d+v))*w,e[1]=(h+x)*w,e[2]=(p-g)*w,e[3]=0,e[4]=(h-x)*b,e[5]=(1-(l+v))*b,e[6]=(y+m)*b,e[7]=0,e[8]=(p+g)*_,e[9]=(y-m)*_,e[10]=(1-(l+d))*_,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function fromRotationTranslationScaleOrigin(e,t,r,n,i){var o=t[0],a=t[1],s=t[2],u=t[3],c=o+o,f=a+a,l=s+s,h=o*c,p=o*f,d=o*l,y=a*f,v=a*l,m=s*l,g=u*c,x=u*f,w=u*l,b=n[0],_=n[1],P=n[2],M=i[0],T=i[1],k=i[2],F=(1-(y+m))*b,V=(p+w)*b,S=(d-x)*b,I=(p-w)*_,E=(1-(h+m))*_,N=(v+g)*_,C=(d+x)*P,L=(v-g)*P,O=(1-(h+y))*P;return e[0]=F,e[1]=V,e[2]=S,e[3]=0,e[4]=I,e[5]=E,e[6]=N,e[7]=0,e[8]=C,e[9]=L,e[10]=O,e[11]=0,e[12]=r[0]+M-(F*M+I*T+C*k),e[13]=r[1]+T-(V*M+E*T+L*k),e[14]=r[2]+k-(S*M+N*T+O*k),e[15]=1,e}function fromQuat(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r+r,s=n+n,u=i+i,c=r*a,f=n*a,l=n*s,h=i*a,p=i*s,d=i*u,y=o*a,v=o*s,m=o*u;return e[0]=1-l-d,e[1]=f+m,e[2]=h-v,e[3]=0,e[4]=f-m,e[5]=1-c-d,e[6]=p+y,e[7]=0,e[8]=h+v,e[9]=p-y,e[10]=1-c-l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function frustum(e,t,r,n,i,o,a){var s=1/(r-t),u=1/(i-n),c=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(i+n)*u,e[10]=(a+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*c,e[15]=0,e}function perspective(e,t,r,n,i){var o=1/Math.tan(t/2),a=void 0;return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(a=1/(n-i),e[10]=(i+n)*a,e[14]=2*i*n*a):(e[10]=-1,e[14]=-2*n),e}function perspectiveFromFieldOfView(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(i+o);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(a-s)*u*.5,e[9]=(i-o)*c*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function ortho(e,t,r,n,i,o,a){var s=1/(t-r),u=1/(n-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*u,e[14]=(a+o)*c,e[15]=1,e}function lookAt(e,t,r,n){var i=void 0,o=void 0,a=void 0,s=void 0,u=void 0,c=void 0,f=void 0,l=void 0,h=void 0,p=void 0,d=t[0],y=t[1],v=t[2],m=n[0],g=n[1],w=n[2],b=r[0],_=r[1],P=r[2];return Math.abs(d-b)<x&&Math.abs(y-_)<x&&Math.abs(v-P)<x?identity(e):(f=d-b,l=y-_,h=v-P,i=g*(h*=p=1/Math.sqrt(f*f+l*l+h*h))-w*(l*=p),o=w*(f*=p)-m*h,a=m*l-g*f,(p=Math.sqrt(i*i+o*o+a*a))?(i*=p=1/p,o*=p,a*=p):(i=0,o=0,a=0),s=l*a-h*o,u=h*i-f*a,c=f*o-l*i,(p=Math.sqrt(s*s+u*u+c*c))?(s*=p=1/p,u*=p,c*=p):(s=0,u=0,c=0),e[0]=i,e[1]=s,e[2]=f,e[3]=0,e[4]=o,e[5]=u,e[6]=l,e[7]=0,e[8]=a,e[9]=c,e[10]=h,e[11]=0,e[12]=-(i*d+o*y+a*v),e[13]=-(s*d+u*y+c*v),e[14]=-(f*d+l*y+h*v),e[15]=1,e)}function targetTo(e,t,r,n){var i=t[0],o=t[1],a=t[2],s=n[0],u=n[1],c=n[2],f=i-r[0],l=o-r[1],h=a-r[2],p=f*f+l*l+h*h;p>0&&(f*=p=1/Math.sqrt(p),l*=p,h*=p);var d=u*h-c*l,y=c*f-s*h,v=s*l-u*f;return(p=d*d+y*y+v*v)>0&&(d*=p=1/Math.sqrt(p),y*=p,v*=p),e[0]=d,e[1]=y,e[2]=v,e[3]=0,e[4]=l*v-h*y,e[5]=h*d-f*v,e[6]=f*y-l*d,e[7]=0,e[8]=f,e[9]=l,e[10]=h,e[11]=0,e[12]=i,e[13]=o,e[14]=a,e[15]=1,e}function str(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function frob(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))}function add(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function subtract(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function multiplyScalar(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function multiplyScalarAndAdd(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function exactEquals(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function mat4_equals(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],f=e[8],l=e[9],h=e[10],p=e[11],d=e[12],y=e[13],v=e[14],m=e[15],g=t[0],w=t[1],b=t[2],_=t[3],P=t[4],M=t[5],T=t[6],k=t[7],F=t[8],V=t[9],S=t[10],I=t[11],E=t[12],N=t[13],C=t[14],L=t[15];return Math.abs(r-g)<=x*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(n-w)<=x*Math.max(1,Math.abs(n),Math.abs(w))&&Math.abs(i-b)<=x*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(o-_)<=x*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(a-P)<=x*Math.max(1,Math.abs(a),Math.abs(P))&&Math.abs(s-M)<=x*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(u-T)<=x*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(c-k)<=x*Math.max(1,Math.abs(c),Math.abs(k))&&Math.abs(f-F)<=x*Math.max(1,Math.abs(f),Math.abs(F))&&Math.abs(l-V)<=x*Math.max(1,Math.abs(l),Math.abs(V))&&Math.abs(h-S)<=x*Math.max(1,Math.abs(h),Math.abs(S))&&Math.abs(p-I)<=x*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(d-E)<=x*Math.max(1,Math.abs(d),Math.abs(E))&&Math.abs(y-N)<=x*Math.max(1,Math.abs(y),Math.abs(N))&&Math.abs(v-C)<=x*Math.max(1,Math.abs(v),Math.abs(C))&&Math.abs(m-L)<=x*Math.max(1,Math.abs(m),Math.abs(L))}var _=multiply,P=subtract;function vec4_create(){var e=new w(4);return w!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function vec4_clone(e){var t=new w(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function vec4_fromValues(e,t,r,n){var i=new w(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function vec4_copy(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function vec4_set(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function vec4_add(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function vec4_subtract(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function vec4_multiply(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function divide(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function ceil(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function floor(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function vec4_min(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function vec4_max(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function round(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function vec4_scale(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function scaleAndAdd(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}function distance(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(r*r+n*n+i*i+o*o)}function squaredDistance(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return r*r+n*n+i*i+o*o}function vec4_length(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)}function squaredLength(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function negate(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function inverse(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function normalize(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r*r+n*n+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=r*a,e[1]=n*a,e[2]=i*a,e[3]=o*a),e}function dot(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function lerp(e,t,r,n){var i=t[0],o=t[1],a=t[2],s=t[3];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=a+n*(r[2]-a),e[3]=s+n*(r[3]-s),e}function random(e,t){var r,n,i,o,a,s;t=t||1;do{a=(r=2*b()-1)*r+(n=2*b()-1)*n}while(a>=1);do{s=(i=2*b()-1)*i+(o=2*b()-1)*o}while(s>=1);var u=Math.sqrt((1-a)/s);return e[0]=t*r,e[1]=t*n,e[2]=t*i*u,e[3]=t*o*u,e}function transformMat4(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,e[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,e[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,e[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,e}function transformQuat(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[0],s=r[1],u=r[2],c=r[3],f=c*n+s*o-u*i,l=c*i+u*n-a*o,h=c*o+a*i-s*n,p=-a*n-s*i-u*o;return e[0]=f*c+p*-a+l*-u-h*-s,e[1]=l*c+p*-s+h*-a-f*-u,e[2]=h*c+p*-u+f*-s-l*-a,e[3]=t[3],e}function vec4_str(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function vec4_exactEquals(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function vec4_equals(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],a=t[0],s=t[1],u=t[2],c=t[3];return Math.abs(r-a)<=x*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=x*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=x*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=x*Math.max(1,Math.abs(o),Math.abs(c))}var M=vec4_subtract,T=vec4_multiply,k=divide,F=distance,V=squaredDistance,S=vec4_length,I=squaredLength,E=function(){var e=vec4_create();return function(t,r,n,i,o,a){var s=void 0,u=void 0;for(r||(r=4),n||(n=0),u=i?Math.min(i*r+n,t.length):t.length,s=n;s<u;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}(),N=function average(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t/e.length},C=r(4),L=r.n(C),O=r(1),D=r.n(O),A=r(5),B=r.n(A),R=r(20),G=function(e){function CartoError(e){var t;if(h()(this,CartoError),!e)throw Error("Invalid CartoError, a message is mandatory");if(!e.message)throw Error("Invalid CartoError, a message is mandatory");if(!e.type)throw Error("Invalid CartoError, a type is mandatory");return(t=L()(this,D()(CartoError).call(this,"".concat(e.type," ").concat(e.message)))).name="CartoError",t.type=e.type,t.originalError=e,t}return B()(CartoError,e),CartoError}(r.n(R)()(Error)),q=function(e){function CartoValidationError(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j.DEFAULT;return h()(this,CartoValidationError),(t=L()(this,D()(CartoValidationError).call(this,{message:e,type:r}))).name="CartoValidationError",t}return B()(CartoValidationError,e),CartoValidationError}(G),j={DEFAULT:"[Error]",MISSING_REQUIRED:"[Missing required property]",INCORRECT_TYPE:"[Property with an incorrect type]",INCORRECT_VALUE:"[Incorrect value]",TOO_MANY_ARGS:"[Too many arguments]",NOT_ENOUGH_ARGS:"[Not enough arguments]",WRONG_NUMBER_ARGS:"[Wrong number of arguments]"},W={UNKNOWN:"unknown",POINT:"point",LINE:"line",POLYGON:"polygon"};function geometry_sub(e,t){var r=a()(e,2),n=r[0],i=r[1],o=a()(t,2);return[n-o[0],i-o[1]]}function geometry_dot(e,t){var r=a()(e,2),n=r[0],i=r[1],o=a()(t,2);return n*o[0]+i*o[1]}function perpendicular(e){var t=a()(e,2),r=t[0];return[-t[1],r]}function getLineNormal(e,t){var r=function geometry_normalize(e,t){var r=Math.hypot(e,t);return[e/r,t/r]}(e[0]-t[0],e[1]-t[1]);return[-r[1],r[0]]}function getJoinNormal(e,t){var r=[e[1],-e[0]],n=[-t[1],t[0]],i=n[0]*r[1]-n[1]*r[0],o=n[0]*r[0]+n[1]*r[1],a=Math.abs(i);return{turnLeft:i>0,joinNormal:!(a<.866&&o>.5)&&neg([(r[0]+n[0])/a,(r[1]+n[1])/a])}}function neg(e){return[-e[0],-e[1]]}function halfPlaneSign(e,t,r){return(e.x-r.x)*(t.y-r.y)-(t.x-r.x)*(e.y-r.y)}function equalPoints(e,t){return e.x===t.x&&e.y===t.y}function computeCentroids(e,t){switch(t){case W.POINT:return function _computeCentroidsForPoints(e){for(var t=[],r=0;r<e.vertices.length/6;r++){var n=6*r,i=n+6,o=e.vertices.slice(n,i),s=a()(o,6),u=s[4],c=s[5];t.push({x:u,y:c})}return t}(e);case W.LINE:case W.POLYGON:return function _computeCentroidsForLinesOrPolygons(e,t){var r=[],n=0;return e.breakpoints.forEach(function(i){var o=e.vertices.slice(n,i),s=null;s=t===W.LINE?function _centroidForLines(e){for(var t=[],r=[],n=0;n<e.length/6;n++){var i=6*n,o=i+6,s=e.slice(i,o),u=a()(s,6),c=u[0],f=u[1],l=u[2],h=u[3],p=u[4],d=u[5],y=c===l&&f===h,v=l===p&&h===d;if(!y||!v){var m=[c,f],g=y?[p,d]:[l,h];t.push(m[0]),t.push(g[0]),r.push(m[1]),r.push(g[1])}}return{x:N(t),y:N(r)}}(o):function _centroidForPolygons(e){for(var t=[],r=[],n=[],i=0;i<e.length/6;i++){var o=6*i,s=o+6,u=e.slice(o,s),c=a()(u,6),f=c[0],l=c[1],h=c[2],p=c[3],d=c[4],y=c[5],v=[[f,l],[h,p],[d,y]],m=triangleArea(v);if(m>0){var g=N([f,h,d]),x=N([l,p,y]);t.push(g*m),r.push(x*m),n.push(m)}}var w=_sumArray(n);return{x:_sumArray(t)/w,y:_sumArray(r)/w}}(o),r.push(s),n=i}),r}(e,t);default:throw new q("Invalid type argument, decoded geometry must have a point, line or polygon type.",j.INCORRECT_VALUE)}}function _sumArray(e){return e.reduce(function(e,t){return e+t},0)}function triangleArea(e){var t=a()(e[0],2),r=t[0],n=t[1],i=a()(e[1],2),o=i[0],s=i[1],u=a()(e[2],2),c=u[0],f=u[1];return Math.abs((r-c)*(s-n)-(r-o)*(f-n))/2}function _updateAABBForGeometry(e,t,r){switch(r){case W.LINE:return function _updateAABBLine(e,t){for(var r=e,n=e.length,i=0;i<n;i+=2)t.minx=Math.min(t.minx,r[i+0]),t.miny=Math.min(t.miny,r[i+1]),t.maxx=Math.max(t.maxx,r[i+0]),t.maxy=Math.max(t.maxy,r[i+1]);return t}(e,t);case W.POLYGON:return function _updateAABBPolygon(e,t){for(var r=[e.flat,e.holes[0]||e.flat.length/2],n=r[0],i=r[1],o=0;o<i;o++)t.minx=Math.min(t.minx,n[2*o+0]),t.miny=Math.min(t.miny,n[2*o+1]),t.maxx=Math.max(t.maxx,n[2*o+0]),t.maxy=Math.max(t.maxy,n[2*o+1]);return t}(e,t)}}var z={intersect:function geometry_intersect(e,t,r,n){var i=e,o=r,a=geometry_sub(t,e),s=geometry_sub(n,r),u=perpendicular(a),c=perpendicular(s),f=geometry_dot(geometry_sub(o,i),c)/geometry_dot(a,c),l=geometry_dot(geometry_sub(i,o),u)/geometry_dot(s,u);if(f>=0&&f<=1&&l>=0&&l<=1)return[i[0]+f*a[0],i[1]+f*a[1]]},sub:geometry_sub,dot:geometry_dot,perpendicular:perpendicular,getLineNormal:getLineNormal,getJoinNormal:getJoinNormal,neg:neg,halfPlaneSign:halfPlaneSign,pointInTriangle:function pointInTriangle(e,t,r,n){if(equalPoints(t,r)||equalPoints(r,n)||equalPoints(n,t))return!1;var i=halfPlaneSign(e,t,r)<0,o=halfPlaneSign(e,r,n)<0,a=halfPlaneSign(e,n,t)<0;return i===o&&o===a},equalPoints:equalPoints,pointInCircle:function pointInCircle(e,t,r){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i<=r*r},pointInRectangle:function pointInRectangle(e,t){if(null===t)return!1;var r=e.x.toFixed(2),n=e.y.toFixed(2);return t.minx<=r&&r<=t.maxx&&t.miny<=n&&n<=t.maxy}},Y=function Polygon(){h()(this,Polygon),this.flat=[],this.holes=[],this.clipped=[],this.clippedType=[]};function decodeLines(e,t){var r=[];return e.map(function(e){var n=[];e.map(function(e){n.push([2*e.x/t-1,2*(1-e.y/t)-1])}),r.push.apply(r,g()(function clipLine(e){var t=[],r=[];function clipType(e){for(var t=0,r=0;r<Z;r++)t|=U[r].inside(e)?0:1<<r;return t}function intersect(e,t,r){for(var n=0;n<Z;n++){var i=1<<n;if(r&i){var o=U[n].intersect(e,t);return r=clipType(o)&~i,[o,r]}}}for(var n=e[0],i=clipType(n),o=1;o<e.length;++o){for(var s=e[o],u=clipType(s),c=u,f=s;;){if(!(i|u)){var l,h;if((l=t).push.apply(l,g()(n)),u!==c)(h=t).push.apply(h,g()(s)),o<e.length-1&&(r.push(t),t=[]);else if(o===e.length-1){var p;(p=t).push.apply(p,g()(s))}break}if(i&u)break;if(i){var d=intersect(n,s,i),y=a()(d,2);n=y[0],i=y[1]}else{var v=intersect(n,s,u),m=a()(v,2);s=m[0],u=m[1]}}n=f,i=c}(t=function _removeDuplicatedVerticesOnLine(e){for(var t,r,n=[],i=0;i<e.length;i+=2){var o=e[i],a=e[i+1];o===t&&a===r||(n.push(o,a),t=o,r=a)}return n}(t)).length>0&&r.push(t);return r}(n)))}),r}function decodePolygons(e,t){var r,n=null,i=[];return e.forEach(function(e){var o=function signedPolygonArea(e){for(var t=0,r=0;r<e.length;r++){var n=(r+1)%e.length;t+=e[r].x*e[n].y,t-=e[n].x*e[r].y}return t/2}(e);if(0!==o){void 0===r&&(r=o>0);var a=r?o>0:o<0,s=function _getPreClippedVertices(e,t){return e.map(function(e){var r=e.x,n=e.y;return[r=2*r/t-1,n=2*(1-n/t)-1]})}(e,t);a&&(n&&i.push(n),n=new Y),n=function clipPolygon(e,t,r){for(var n={},i=function _loop(t){for(var r=[],i={},o=function setClippedType(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,o=0;t>=0&&(o=n[t]||0),r>=0&&(o|=1<<r),o&&(i[e]=o)},a=0;a<e.length-1;a++){var s=e[a],u=e[a+1],c=U[t].inside(s),f=U[t].inside(u);if(c&&f)o(r.length,a+1),r.push(u);else if(c){var l=U[t].intersect(s,u);o(r.length,a+1,t),r.push(l)}else if(f){var h=U[t].intersect(s,u);o(r.length,a,t),r.push(h),o(r.length,a+1),r.push(u)}}r.length&&(i[0]&&(i[r.length]=i[0]),r.push(r[0])),e=r,n=i},o=0;o<Z;o++)i(o);e.length>=4&&(r&&t.holes.push(t.flat.length/2),e.forEach(function(e){t.flat.push(e[0],e[1])}),Object.keys(n).forEach(function(e){t.clipped.push(2*Number(e)),t.clippedType.push(n[e])}));return t}(s,n,!a)}}),n&&i.push(n),i}var U=[{inside:function inside(e){return e[0]<=1},intersect:function intersect(e,t){return z.intersect(e,t,[1,-100],[1,100])}},{inside:function inside(e){return e[1]<=1},intersect:function intersect(e,t){return z.intersect(e,t,[-100,1],[100,1])}},{inside:function inside(e){return e[0]>=-1},intersect:function intersect(e,t){return z.intersect(e,t,[-1,-100],[-1,100])}},{inside:function inside(e){return e[1]>=-1},intersect:function intersect(e,t){return z.intersect(e,t,[-100,-1],[100,-1])}}],Z=U.length;var $=function(e){function CartoRuntimeError(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q.DEFAULT;return h()(this,CartoRuntimeError),(t=L()(this,D()(CartoRuntimeError).call(this,{message:e,type:r}))).name="CartoRuntimeError",t}return B()(CartoRuntimeError,e),CartoRuntimeError}(G),Q={DEFAULT:"[Error]",NOT_SUPPORTED:"[Not supported]",WEB_GL:"[WebGL]",MVT:"[MVT]"},X=function(){function BaseCodec(e,t){h()(this,BaseCodec),e&&t&&(this._baseName=e.baseName(t))}return d()(BaseCodec,[{key:"isRange",value:function isRange(){return!1}},{key:"isIdentity",value:function isIdentity(){return!1}},{key:"sourceToInternal",value:function sourceToInternal(e,t){return t}},{key:"internalToExternal",value:function internalToExternal(e,t){return t}},{key:"externalToSource",value:function externalToSource(e,t){return t}},{key:"sourceToExternal",value:function sourceToExternal(e,t){return this.internalToExternal(e,this.sourceToInternal(e,t))}},{key:"externalToInternal",value:function externalToInternal(e,t){return this.sourceToInternal(e,this.externalToSource(e,t))}},{key:"inlineInternalMatch",value:function inlineInternalMatch(e,t){return"".concat(e)}}]),BaseCodec}(),J=function(e){function IdentityCodec(){return h()(this,IdentityCodec),L()(this,D()(IdentityCodec).apply(this,arguments))}return B()(IdentityCodec,e),d()(IdentityCodec,[{key:"isIdentity",value:function isIdentity(){return!0}},{key:"sourceToInternal",value:function sourceToInternal(e,t){return t}},{key:"internalToExternal",value:function internalToExternal(e,t){return t}},{key:"sourceToExternal",value:function sourceToExternal(e,t){return t}},{key:"externalToSource",value:function externalToSource(e,t){return t}},{key:"externalToInternal",value:function externalToInternal(e,t){return t}}]),IdentityCodec}(X),H=4096,K="cartodb_id",ee=function(){function Metadata(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{properties:{}},r=t.properties,n=t.featureCount,i=t.sample,o=t.geomType,a=t.isAggregated,s=t.idProperty,u=t.extent;h()(this,Metadata),this.properties=r,this.featureCount=n,this.sample=i,this.geomType=o,this.isAggregated=a,this.idProperty=s||K,this.properties.hasOwnProperty(this.idProperty)||(this.properties[this.idProperty]={type:"number"}),this.categoryToID=new Map,this.IDToCategory=new Map,this.numCategories=0,this.extent=u||H,Object.values(r).map(function(t){t.categories=t.categories||[],t.categories.map(function(r){return e.categorizeString(t,r.name,!0)})}),this.propertyKeys=Object.keys(r)}return d()(Metadata,[{key:"setCodecs",value:function setCodecs(){throw new $('You must call "setCodecs" once you have determined the proper subclass')}},{key:"categorizeString",value:function categorizeString(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===t&&(t=null),this.categoryToID.has(t))return this.categoryToID.get(t);r||null===t||this.properties[e].categories.push({name:t,frequency:Number.NaN});var n=null===t?-(1<<24):this.numCategories;return this.categoryToID.set(t,n),this.IDToCategory.set(n,t),this.numCategories++,n}},{key:"decodedProperties",value:function decodedProperties(e){return[e]}},{key:"baseName",value:function baseName(e){return e}},{key:"sourcePropertyName",value:function sourcePropertyName(e){return e}},{key:"stats",value:function stats(e){return this.properties[e]}},{key:"codec",value:function codec(e){var t=this.baseName(e);return this.properties[t]&&this.properties[t].codec?this.properties[t].codec:new J}}]),Metadata}(),te=r(9),re=r.n(te),ne=r(10),ie=r.n(ne),oe=function(e){function NumberCodec(){return h()(this,NumberCodec),L()(this,D()(NumberCodec).apply(this,arguments))}return B()(NumberCodec,e),d()(NumberCodec,[{key:"sourceToInternal",value:function sourceToInternal(e,t){return(isNaN(t)||null==t)&&(t=-(1<<24)),t}},{key:"internalToExternal",value:function internalToExternal(e,t){return t===-(1<<24)&&(t=null),t}},{key:"externalToInternal",value:function externalToInternal(e,t){return null===t&&(t=-(1<<24)),t}}]),NumberCodec}(J),ae=function(e){function MVTNumberCodec(){return h()(this,MVTNumberCodec),L()(this,D()(MVTNumberCodec).apply(this,arguments))}return B()(MVTNumberCodec,e),d()(MVTNumberCodec,[{key:"sourceToInternal",value:function sourceToInternal(e,t){var r=re()(t);if(null!==t&&"undefined"!==r&&"number"!==r)throw new $("MVT decoding error. Metadata property '".concat(this._baseName,"' is of type 'number' but the MVT tile contained a feature property of type '").concat(r,"': '").concat(t,"'"),Q.MVT);return ie()(D()(MVTNumberCodec.prototype),"sourceToInternal",this).call(this,e,t)}}]),MVTNumberCodec}(oe),se=function(e){function CategoryCodec(){return h()(this,CategoryCodec),L()(this,D()(CategoryCodec).apply(this,arguments))}return B()(CategoryCodec,e),d()(CategoryCodec,[{key:"sourceToInternal",value:function sourceToInternal(e,t){return e.categorizeString(this._baseName,t)}},{key:"internalToExternal",value:function internalToExternal(e,t){return e.IDToCategory.get(t)}},{key:"sourceToExternal",value:function sourceToExternal(e,t){return t}},{key:"externalToSource",value:function externalToSource(e,t){return t}}]),CategoryCodec}(X),ue=function(e){function MVTCategoryCodec(){return h()(this,MVTCategoryCodec),L()(this,D()(MVTCategoryCodec).apply(this,arguments))}return B()(MVTCategoryCodec,e),d()(MVTCategoryCodec,[{key:"sourceToInternal",value:function sourceToInternal(e,t){var r=re()(t);if(null!==t&&"undefined"!==r&&"string"!==r)throw new $("MVT decoding error. Metadata property '".concat(this._baseName,"' is of type 'category' but the MVT tile contained a feature property of type '").concat(r,"': '").concat(t,"'"),Q.MVT);return ie()(D()(MVTCategoryCodec.prototype),"sourceToInternal",this).call(this,e,t)}}]),MVTCategoryCodec}(se);var ce=function(e){function MVTMetadata(){return h()(this,MVTMetadata),L()(this,D()(MVTMetadata).apply(this,arguments))}return B()(MVTMetadata,e),d()(MVTMetadata,[{key:"setCodecs",value:function setCodecs(){var e=this;Object.keys(this.properties).forEach(function(t){var r=e.properties[t],n=r.type;"geometry"!==n&&(r.codec=function MVTCodecFactory(e,t,r){switch(t){case"number":return new ae(e,r);case"category":return new ue(e,r);default:throw new $("MVT decoding error. Feature property value of type '".concat(t,"' cannot be decoded."),Q.MVT)}}(e,n,t))})}}]),MVTMetadata}(ee);function addLineString(e,t,r,n,i){var o,a,s,u,c;if(e.length>=4){o=[e[0],e[1]];for(var f=2;f<=e.length;f+=2)if(a=[e[f],e[f+1]],o[0]!==a[0]||o[1]!==a[1]){f+=2;break}for(s=getLineNormal(o,a);f<=e.length;f+=2){c=!(i&&i(f));var l=void 0;if(f<=e.length-2?l=[e[f],e[f+1]]:n&&(l=[e[2],e[3]]),!c||o[0]===a[0]&&o[1]===a[1]||(t.vertices[r]=o[0],t.normals[r++]=-s[0],t.vertices[r]=o[1],t.normals[r++]=-s[1],t.vertices[r]=o[0],t.normals[r++]=s[0],t.vertices[r]=o[1],t.normals[r++]=s[1],t.vertices[r]=a[0],t.normals[r++]=s[0],t.vertices[r]=a[1],t.normals[r++]=s[1],t.vertices[r]=o[0],t.normals[r++]=-s[0],t.vertices[r]=o[1],t.normals[r++]=-s[1],t.vertices[r]=a[0],t.normals[r++]=s[0],t.vertices[r]=a[1],t.normals[r++]=s[1],t.vertices[r]=a[0],t.normals[r++]=-s[0],t.vertices[r]=a[1],t.normals[r++]=-s[1]),!l||l[0]===a[0]&&l[1]===a[1])u=s;else if(u=getLineNormal(a,l),c){var h=getJoinNormal(s,u),p=h.turnLeft,d=h.joinNormal,y=p?s:neg(u),v=p?u:neg(s);t.vertices[r]=a[0],t.normals[r++]=0,t.vertices[r]=a[1],t.normals[r++]=n?1e-37:0,t.vertices[r]=a[0],t.normals[r++]=y[0],t.vertices[r]=a[1],t.normals[r++]=y[1],t.vertices[r]=a[0],t.normals[r++]=v[0],t.vertices[r]=a[1],t.normals[r++]=v[1],d&&(t.vertices[r]=a[0],t.normals[r++]=d[0],t.vertices[r]=a[1],t.normals[r++]=d[1],t.vertices[r]=a[0],t.normals[r++]=v[0],t.vertices[r]=a[1],t.normals[r++]=v[1],t.vertices[r]=a[0],t.normals[r++]=y[0],t.vertices[r]=a[1],t.normals[r++]=y[1])}o=a,a=l,s=u}}return r}function resizeBuffer(e,t){var r=new Float32Array(t);return r.set(e),r}var fe=24,le=0,he={vertices:new Float32Array(1048576),normals:new Float32Array(1048576)};function resizeBuffers(e){var t=le+e;if(t>he.vertices.length){var r=2*t;he.vertices=resizeBuffer(he.vertices,r),he.normals=resizeBuffer(he.normals,r)}}var pe=r(21),de=2,ye=24,ve=0,me={vertices:new Float32Array(2097152),normals:new Float32Array(2097152)};function polygonDecoder_resizeBuffers(e){var t=ve+e;if(t>me.vertices.length){var r=2*t;me.vertices=resizeBuffer(me.vertices,r),me.normals=resizeBuffer(me.normals,r)}}function addVertex(e,t){me.vertices[ve]=e[t],me.normals[ve++]=0,me.vertices[ve]=e[t+1],me.normals[ve++]=0}function isClipped(e,t,r){return!!(e.clipped.includes(t)&&e.clipped.includes(r)&&e.clippedType[e.clipped.indexOf(t)]&e.clippedType[e.clipped.indexOf(r)])}function decodeGeom(e,t){switch(e){case W.POINT:return function decodePoint(e){return{verticesArrayBuffer:e,vertices:new Float32Array(e),breakpoints:[]}}(t);case W.LINE:return function decodeLine(e){var t=[],r=new Map;le=0;for(var n=0;n<e.length;n++){for(var i=e[n],o=0;o<i.length;o++)resizeBuffers(fe*i[o].length),le=addLineString(i[o],he,le);r.set(t.length,0===t.length?{start:0,end:le}:{start:r.get(t.length-1).end,end:le}),t.push(le)}for(var a=new ArrayBuffer(4*le),s=new ArrayBuffer(4*le),u=new Float32Array(a),c=new Float32Array(s),f=0;f<le;f++)u[f]=he.vertices[f],c[f]=he.normals[f];return{vertices:u,normals:c,verticesArrayBuffer:a,normalsArrayBuffer:s,featureIDToVertexIndex:r,breakpoints:t}}(t);case W.POLYGON:return function decodePolygon(e){var t=[],r=new Map;ve=0;for(var n=0;n<e.length;n++){for(var i=e[n],o=function _loop(e){var t=i[e],r=pe(t.flat,t.holes);polygonDecoder_resizeBuffers(de*r.length+ye*t.flat.length);for(var n=0;n<r.length;n++)addVertex(t.flat,2*r[n]);ve=addLineString(t.flat,me,ve,!0,function(e){return t.holes.includes((e-2)/2)||isClipped(t,e-4,e-2)})},a=0;a<i.length;a++)o(a);r.set(t.length,0===t.length?{start:0,end:ve}:{start:r.get(t.length-1).end,end:ve}),t.push(ve)}for(var s=new ArrayBuffer(4*ve),u=new ArrayBuffer(4*ve),c=new Float32Array(s),f=new Float32Array(u),l=0;l<ve;l++)c[l]=me.vertices[l],f[l]=me.normals[l];return{vertices:c,normals:f,verticesArrayBuffer:s,normalsArrayBuffer:u,featureIDToVertexIndex:r,breakpoints:t}}(t);default:throw new $("Unimplemented geometry type: '".concat(e,"'."),Q.NOT_SUPPORTED)}}var ge=function DummyDataframe(e){var t=e.active,r=e.center,n=e.properties,i=e.propertiesArrayBuffer,o=e.scale,a=e.type,s=e.geom,u=e.size,c=e.metadata,f=e.x,l=e.y,p=e.z;h()(this,DummyDataframe),this.active=t,this.center=r,this.properties=n,this.propertiesArrayBuffer=i,this.scale=o,this.type=a,this.decodedGeom=decodeGeom(a,s),this.numVertex=a===W.POINT?3*u:this.decodedGeom.vertices.length/2,this.numFeatures=a===W.POINT?u:this.decodedGeom.breakpoints.length||this.numVertex,this.propertyTex=[],this.metadata=c,this.propertyCount=0,this.x=f,this.y=l,this.z=p,this._aabb=function computeAABB(e,t){switch(t){case W.POINT:return[];case W.LINE:case W.POLYGON:for(var r=[],n=0;n<e.length;n++){for(var i=e[n],o={minx:Number.POSITIVE_INFINITY,miny:Number.POSITIVE_INFINITY,maxx:Number.NEGATIVE_INFINITY,maxy:Number.NEGATIVE_INFINITY},a=0;a<i.length;a++)o=_updateAABBForGeometry(i[a],o,t);o.minx===Number.POSITIVE_INFINITY&&(o=null),r.push(o)}return r}}(s,a),this._centroids=computeCentroids(this.decodedGeom,a),this.t1=[.1,.1,.1,.1],this.t2=[.1,.1,.1,.1],this.t3=[.1,.1,.1,.1],this.t4=[.1,.1,.1,.1]},xe=1,we=2,be=3,_e={1:W.POINT,2:W.LINE,3:W.POLYGON},Pe=function(){function MVTWorker(){h()(this,MVTWorker)}return d()(MVTWorker,[{key:"onmessage",value:function onmessage(e){this.processEvent(e).then(function(e){var t=[];e.dataframe.empty||(t.push(e.dataframe.propertiesArrayBuffer),t.push(e.dataframe.decodedGeom.verticesArrayBuffer),e.dataframe.decodedGeom.normalsArrayBuffer&&t.push(e.dataframe.decodedGeom.normalsArrayBuffer)),postMessage(e,t)})}},{key:"processEvent",value:function(){var e=f()(u.a.mark(function _callee(e){var t,r;return u.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return(t=e.data).metadata&&(this.castMetadata(t.metadata),this.metadata=t.metadata),n.next=4,this._requestDataframe(t.x,t.y,t.z,t.url,t.layerID,this.metadata);case 4:return r=n.sent,n.abrupt("return",{mID:t.mID,dataframe:r});case 6:case"end":return n.stop()}},_callee,this)}));return function processEvent(t){return e.apply(this,arguments)}}()},{key:"castMetadata",value:function castMetadata(e){Object.setPrototypeOf(e,ce.prototype),e.setCodecs()}},{key:"_requestDataframe",value:function(){var e=f()(u.a.mark(function _callee2(e,t,r,n,i,o){var a,s;return u.a.wrap(function _callee2$(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,fetch(n);case 2:return a=u.sent,u.next=5,this.urlToDataframeTransformer(a,e,t,r,i,o);case 5:return s=u.sent,u.abrupt("return",s);case 7:case"end":return u.stop()}},_callee2,this)}));return function _requestDataframe(t,r,n,i,o,a){return e.apply(this,arguments)}}()},{key:"urlToDataframeTransformer",value:function(){var e=f()(u.a.mark(function _callee3(e,t,r,n,i,o){var a,s,c,f,l,h,p,d,m,g,x;return u.a.wrap(function _callee3$(u){for(;;)switch(u.prev=u.next){case 0:return a=o.extent,u.next=3,e.arrayBuffer();case 3:if(0!==(s=u.sent).byteLength&&"null"!==e){u.next=6;break}return u.abrupt("return",{empty:!0});case 6:if(c=new y.VectorTile(new v(s)),!(Object.keys(c.layers).length>1)||i){u.next=9;break}throw new q("LayerID parameter wasn't specified and the MVT tile contains multiple layers: ".concat(JSON.stringify(Object.keys(c.layers)),"."),j.MISSING_REQUIRED);case 9:if(f=c.layers[i||Object.keys(c.layers)[0]]){u.next=12;break}return u.abrupt("return",{empty:!0});case 12:return l=this._decodeMVTLayer(f,o,a),h=l.geometries,p=l.properties,d=l.propertiesArrayBuffer,m=l.numFeatures,g=getRsysFromTile(t,r,n),x=this._generateDataFrame(g,h,p,d,m,o.geomType,o),u.abrupt("return",x);case 16:case"end":return u.stop()}},_callee3,this)}));return function urlToDataframeTransformer(t,r,n,i,o,a){return e.apply(this,arguments)}}()},{key:"_decodeMVTLayer",value:function _decodeMVTLayer(e,t,r){if(!e.length)return{properties:[],geometries:{},propertiesArrayBuffer:[],numFeatures:0};switch(t.geomType||(t.geomType=this._autoDiscoverType(e)),t.geomType){case W.POINT:var n=new ArrayBuffer(2*e.length*3*4);return this._decode(e,t,r,n);case W.LINE:return this._decode(e,t,r,[],decodeLines);case W.POLYGON:return this._decode(e,t,r,[],decodePolygons);default:throw new q("MVT: invalid geometry type '".concat(t.geomType,"'"),j.INCORRECT_TYPE)}}},{key:"_autoDiscoverType",value:function _autoDiscoverType(e){var t=e.feature(0).type;switch(t){case xe:return W.POINT;case we:return W.LINE;case be:return W.POLYGON;default:throw new q("MVT: invalid geometry type '".concat(t,"'"),j.INCORRECT_TYPE)}}},{key:"_decode",value:function _decode(e,t,r,n,i){var o,a=0;n&&(o=new Float32Array(n));for(var s=this._initializePropertyArrays(t,e.length),u=s.properties,c=s.propertiesArrayBuffer,f=this._scalarPropertyCodecs(t),l=this._rangePropertyCodecs(t),h=0;h<e.length;h++){var p=e.feature(h);this._checkType(p,t.geomType);var d=p.loadGeometry();if(i){var y=i(d,r);n.push(y)}else{var v=2*d[0][0].x/r-1,m=2*(1-d[0][0].y/r)-1;if(v<-1||v>=1||m<-1||m>=1)continue;o[6*a+0]=v,o[6*a+1]=m,o[6*a+2]=v,o[6*a+3]=m,o[6*a+4]=v,o[6*a+5]=m}if(void 0===p.properties[t.idProperty])throw new $("MVT feature with undefined idProperty '".concat(t.idProperty,"'"),Q.MVT);this._decodeProperties(t,f,l,u,p,a),a++}return{properties:u,propertiesArrayBuffer:c,geometries:n,numFeatures:a}}},{key:"_checkType",value:function _checkType(e,t){var r=e.type,n=_e[r];if(n!==t)throw new $("MVT: mixed geometry types in the same layer. Layer has type: ".concat(t," but feature was ").concat(n),Q.MVT)}},{key:"_initializePropertyArrays",value:function _initializePropertyArrays(e,t){var r=this._getPropertyNamesFrom(e),n=this._getPropertiesFor(r,t);return{propertyNames:r,properties:n.properties,propertiesArrayBuffer:n.propertiesArrayBuffer}}},{key:"_getSourcePropertyNamesFrom",value:function _getSourcePropertyNamesFrom(e){return e.propertyKeys.filter(function(t){return"geometry"!==e.properties[e.baseName(t)].type})}},{key:"_getPropertyNamesFrom",value:function _getPropertyNamesFrom(e){var t=[];return this._getSourcePropertyNamesFrom(e).forEach(function(r){e.decodedProperties(r).forEach(function(e){t.push(e)})}),t}},{key:"_getPropertiesFor",value:function _getPropertiesFor(e,t){for(var r={},n=1024*Math.ceil(t/1024),i=new ArrayBuffer(4*n*e.length),o=i,a=0;a<e.length;a++){r[e[a]]=new Float32Array(i,4*a*n,n)}return{properties:r,propertiesArrayBuffer:o}}},{key:"_scalarPropertyCodecs",value:function _scalarPropertyCodecs(e){return this._getSourcePropertyNamesFrom(e).map(function(t){return[t,e.codec(t)]}).filter(function(e){var t=a()(e,2);t[0];return!t[1].isRange()})}},{key:"_rangePropertyCodecs",value:function _rangePropertyCodecs(e){return this._getSourcePropertyNamesFrom(e).map(function(t){return[t,e.decodedProperties(t),e.codec(t)]}).filter(function(e){var t=a()(e,3);t[0],t[1];return t[2].isRange()})}},{key:"_decodeProperties",value:function _decodeProperties(e,t,r,n,i,o){for(var s=t.length,u=0;u<s;u++){var c=a()(t[u],2),f=c[0],l=c[1],h=i.properties[f];n[f][o]=l.sourceToInternal(e,h)}s=r.length;for(var p=0;p<s;p++){var d=a()(r[p],3),y=(f=d[0],a()(d[1],2)),v=y[0],m=y[1],g=(l=d[2],i.properties[f]),x=l.sourceToInternal(e,g),w=a()(x,2),b=w[0],_=w[1];n[v][o]=b,n[m][o]=_}}},{key:"_generateDataFrame",value:function _generateDataFrame(e,t,r,n,i,o,a){return new ge({active:!1,center:e.center,geom:t,properties:r,propertiesArrayBuffer:n,scale:e.scale,size:i,type:o,metadata:a})}}]),MVTWorker}(),Me=r(22),Te=r(23),ke=r(24);function getSqSegDist(e,t,r,n,i,o){var a=i-r,s=o-n;if(0!==a||0!==s){var u=((e-r)*a+(t-n)*s)/(a*a+s*s);u>1?(r=i,n=o):u>0&&(r+=a*u,n+=s*u)}return(a=e-r)*a+(s=t-n)*s}function createFeature(e,t,r,n){var i={id:void 0===e?null:e,type:t,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function calcBBox(e){var t=e.geometry,r=e.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)calcLineBBox(e,t);else if("Polygon"===r||"MultiLineString"===r)for(var n=0;n<t.length;n++)calcLineBBox(e,t[n]);else if("MultiPolygon"===r)for(n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)calcLineBBox(e,t[n][i])}(i),i}function calcLineBBox(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function convertFeature(e,t,r,n){if(t.geometry){var i=t.geometry.coordinates,o=t.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],u=t.id;if(r.promoteId?u=t.properties[r.promoteId]:r.generateId&&(u=n||0),"Point"===o)convertPoint(i,s);else if("MultiPoint"===o)for(var c=0;c<i.length;c++)convertPoint(i[c],s);else if("LineString"===o)convertLine(i,s,a,!1);else if("MultiLineString"===o){if(r.lineMetrics){for(c=0;c<i.length;c++)s=[],convertLine(i[c],s,a,!1),e.push(createFeature(u,"LineString",s,t.properties));return}convertLines(i,s,a,!1)}else if("Polygon"===o)convertLines(i,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(c=0;c<t.geometry.geometries.length;c++)convertFeature(e,{id:u,geometry:t.geometry.geometries[c],properties:t.properties},r,n);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<i.length;c++){var f=[];convertLines(i[c],f,a,!0),s.push(f)}}e.push(createFeature(u,o,s,t.properties))}}function convertPoint(e,t){t.push(projectX(e[0])),t.push(projectY(e[1])),t.push(0)}function convertLine(e,t,r,n){for(var i,o,a=0,s=0;s<e.length;s++){var u=projectX(e[s][0]),c=projectY(e[s][1]);t.push(u),t.push(c),t.push(0),s>0&&(a+=n?(i*c-u*o)/2:Math.sqrt(Math.pow(u-i,2)+Math.pow(c-o,2))),i=u,o=c}var f=t.length-3;t[2]=1,function simplify(e,t,r,n){for(var i,o=n,a=r-t>>1,s=r-t,u=e[t],c=e[t+1],f=e[r],l=e[r+1],h=t+3;h<r;h+=3){var p=getSqSegDist(e[h],e[h+1],u,c,f,l);if(p>o)i=h,o=p;else if(p===o){var d=Math.abs(h-a);d<s&&(i=h,s=d)}}o>n&&(i-t>3&&simplify(e,t,i,n),e[i+2]=o,r-i>3&&simplify(e,i,r,n))}(t,0,f,r),t[f+2]=1,t.size=Math.abs(a),t.start=0,t.end=t.size}function convertLines(e,t,r,n){for(var i=0;i<e.length;i++){var o=[];convertLine(e[i],o,r,n),t.push(o)}}function projectX(e){return e/360+.5}function projectY(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function clip(e,t,r,n,i,o,a,s){if(n/=t,o>=(r/=t)&&a<n)return e;if(a<r||o>=n)return null;for(var u=[],c=0;c<e.length;c++){var f=e[c],l=f.geometry,h=f.type,p=0===i?f.minX:f.minY,d=0===i?f.maxX:f.maxY;if(p>=r&&d<n)u.push(f);else if(!(d<r||p>=n)){var y=[];if("Point"===h||"MultiPoint"===h)clipPoints(l,y,r,n,i);else if("LineString"===h)clip_clipLine(l,y,r,n,i,!1,s.lineMetrics);else if("MultiLineString"===h)clipLines(l,y,r,n,i,!1);else if("Polygon"===h)clipLines(l,y,r,n,i,!0);else if("MultiPolygon"===h)for(var v=0;v<l.length;v++){var m=[];clipLines(l[v],m,r,n,i,!0),m.length&&y.push(m)}if(y.length){if(s.lineMetrics&&"LineString"===h){for(v=0;v<y.length;v++)u.push(createFeature(f.id,h,y[v],f.tags));continue}"LineString"!==h&&"MultiLineString"!==h||(1===y.length?(h="LineString",y=y[0]):h="MultiLineString"),"Point"!==h&&"MultiPoint"!==h||(h=3===y.length?"Point":"MultiPoint"),u.push(createFeature(f.id,h,y,f.tags))}}}return u.length?u:null}function clipPoints(e,t,r,n,i){for(var o=0;o<e.length;o+=3){var a=e[o+i];a>=r&&a<=n&&(t.push(e[o]),t.push(e[o+1]),t.push(e[o+2]))}}function clip_clipLine(e,t,r,n,i,o,a){for(var s,u,c=newSlice(e),f=0===i?intersectX:intersectY,l=e.start,h=0;h<e.length-3;h+=3){var p=e[h],d=e[h+1],y=e[h+2],v=e[h+3],m=e[h+4],g=0===i?p:d,x=0===i?v:m,w=!1;a&&(s=Math.sqrt(Math.pow(p-v,2)+Math.pow(d-m,2))),g<r?x>r&&(u=f(c,p,d,v,m,r),a&&(c.start=l+s*u)):g>n?x<n&&(u=f(c,p,d,v,m,n),a&&(c.start=l+s*u)):addPoint(c,p,d,y),x<r&&g>=r&&(u=f(c,p,d,v,m,r),w=!0),x>n&&g<=n&&(u=f(c,p,d,v,m,n),w=!0),!o&&w&&(a&&(c.end=l+s*u),t.push(c),c=newSlice(e)),a&&(l+=s)}var b=e.length-3;p=e[b],d=e[b+1],y=e[b+2],(g=0===i?p:d)>=r&&g<=n&&addPoint(c,p,d,y),b=c.length-3,o&&b>=3&&(c[b]!==c[0]||c[b+1]!==c[1])&&addPoint(c,c[0],c[1],c[2]),c.length&&t.push(c)}function newSlice(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function clipLines(e,t,r,n,i,o){for(var a=0;a<e.length;a++)clip_clipLine(e[a],t,r,n,i,o,!1)}function addPoint(e,t,r,n){e.push(t),e.push(r),e.push(n)}function intersectX(e,t,r,n,i,o){var a=(o-t)/(n-t);return e.push(o),e.push(r+(i-r)*a),e.push(1),a}function intersectY(e,t,r,n,i,o){var a=(o-r)/(i-r);return e.push(t+(n-t)*a),e.push(o),e.push(1),a}function shiftFeatureCoords(e,t){for(var r=[],n=0;n<e.length;n++){var i,o=e[n],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)i=shiftCoords(o.geometry,t);else if("MultiLineString"===a||"Polygon"===a){i=[];for(var s=0;s<o.geometry.length;s++)i.push(shiftCoords(o.geometry[s],t))}else if("MultiPolygon"===a)for(i=[],s=0;s<o.geometry.length;s++){for(var u=[],c=0;c<o.geometry[s].length;c++)u.push(shiftCoords(o.geometry[s][c],t));i.push(u)}r.push(createFeature(o.id,a,i,o.tags))}return r}function shiftCoords(e,t){var r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(var n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}function transformTile(e,t){if(e.transformed)return e;var r,n,i,o=1<<e.z,a=e.x,s=e.y;for(r=0;r<e.features.length;r++){var u=e.features[r],c=u.geometry,f=u.type;if(u.geometry=[],1===f)for(n=0;n<c.length;n+=2)u.geometry.push(transformPoint(c[n],c[n+1],t,o,a,s));else for(n=0;n<c.length;n++){var l=[];for(i=0;i<c[n].length;i+=2)l.push(transformPoint(c[n][i],c[n][i+1],t,o,a,s));u.geometry.push(l)}}return e.transformed=!0,e}function transformPoint(e,t,r,n,i,o){return[Math.round(r*(e*n-i)),Math.round(r*(t*n-o))]}function createTile(e,t,r,n,i){for(var o=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){a.numFeatures++,addFeature(a,e[s],o,i);var u=e[s].minX,c=e[s].minY,f=e[s].maxX,l=e[s].maxY;u<a.minX&&(a.minX=u),c<a.minY&&(a.minY=c),f>a.maxX&&(a.maxX=f),l>a.maxY&&(a.maxY=l)}return a}function addFeature(e,t,r,n){var i=t.geometry,o=t.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),e.numPoints++,e.numSimplified++;else if("LineString"===o)addLine(a,i,e,r,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<i.length;s++)addLine(a,i[s],e,r,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var u=0;u<i.length;u++){var c=i[u];for(s=0;s<c.length;s++)addLine(a,c[s],e,r,!0,0===s)}if(a.length){var f=t.tags||null;if("LineString"===o&&n.lineMetrics){for(var l in f={},t.tags)f[l]=t.tags[l];f.mapbox_clip_start=i.start/i.size,f.mapbox_clip_end=i.end/i.size}var h={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:f};null!==t.id&&(h.id=t.id),e.features.push(h)}}function addLine(e,t,r,n,i,o){var a=n*n;if(n>0&&t.size<(i?a:n))r.numPoints+=t.length/3;else{for(var s=[],u=0;u<t.length;u+=3)(0===n||t[u+2]>a)&&(r.numSimplified++,s.push(t[u]),s.push(t[u+1])),r.numPoints++;i&&function rewind(e,t){for(var r=0,n=0,i=e.length,o=i-2;n<i;o=n,n+=2)r+=(e[n]-e[o])*(e[n+1]+e[o+1]);if(r>0===t)for(n=0,i=e.length;n<i/2;n+=2){var a=e[n],s=e[n+1];e[n]=e[i-2-n],e[n+1]=e[i-1-n],e[i-2-n]=a,e[i-1-n]=s}}(s,o),e.push(s)}}function geojsonvt(e,t){return new GeoJSONVT(e,t)}function GeoJSONVT(e,t){var r=(t=this.options=function extend(e,t){for(var r in t)e[r]=t[r];return e}(Object.create(this.options),t)).debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=function convert(e,t){var r=[];if("FeatureCollection"===e.type)for(var n=0;n<e.features.length;n++)convertFeature(r,e.features[n],t,n);else"Feature"===e.type?convertFeature(r,e,t):convertFeature(r,{geometry:e},t);return r}(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(n=function wrap(e,t){var r=t.buffer/t.extent,n=e,i=clip(e,1,-1-r,r,0,-1,2,t),o=clip(e,1,1-r,2+r,0,-1,2,t);return(i||o)&&(n=clip(e,1,-r,1+r,0,-1,2,t)||[],i&&(n=shiftFeatureCoords(i,1).concat(n)),o&&(n=n.concat(shiftFeatureCoords(o,-1)))),n}(n,t)).length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function toID(e,t,r){return 32*((1<<e)*r+t)+e}GeoJSONVT.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},GeoJSONVT.prototype.splitTile=function(e,t,r,n,i,o,a){for(var s=[e,t,r,n],u=this.options,c=u.debug;s.length;){n=s.pop(),r=s.pop(),t=s.pop(),e=s.pop();var f=1<<t,l=toID(t,r,n),h=this.tiles[l];if(!h&&(c>1&&console.time("creation"),h=this.tiles[l]=createTile(e,t,r,n,u),this.tileCoords.push({z:t,x:r,y:n}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,n,h.numFeatures,h.numPoints,h.numSimplified),console.timeEnd("creation"));var p="z"+t;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(h.source=e,i){if(t===u.maxZoom||t===i)continue;var d=1<<i-t;if(r!==Math.floor(o/d)||n!==Math.floor(a/d))continue}else if(t===u.indexMaxZoom||h.numPoints<=u.indexMaxPoints)continue;if(h.source=null,0!==e.length){c>1&&console.time("clipping");var y,v,m,g,x,w,b=.5*u.buffer/u.extent,_=.5-b,P=.5+b,M=1+b;y=v=m=g=null,x=clip(e,f,r-b,r+P,0,h.minX,h.maxX,u),w=clip(e,f,r+_,r+M,0,h.minX,h.maxX,u),e=null,x&&(y=clip(x,f,n-b,n+P,1,h.minY,h.maxY,u),v=clip(x,f,n+_,n+M,1,h.minY,h.maxY,u),x=null),w&&(m=clip(w,f,n-b,n+P,1,h.minY,h.maxY,u),g=clip(w,f,n+_,n+M,1,h.minY,h.maxY,u),w=null),c>1&&console.timeEnd("clipping"),s.push(y||[],t+1,2*r,2*n),s.push(v||[],t+1,2*r,2*n+1),s.push(m||[],t+1,2*r+1,2*n),s.push(g||[],t+1,2*r+1,2*n+1)}}},GeoJSONVT.prototype.getTile=function(e,t,r){var n=this.options,i=n.extent,o=n.debug;if(e<0||e>24)return null;var a=1<<e,s=toID(e,t=(t%a+a)%a,r);if(this.tiles[s])return transformTile(this.tiles[s],i);o>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var u,c=e,f=t,l=r;!u&&c>0;)c--,f=Math.floor(f/2),l=Math.floor(l/2),u=this.tiles[toID(c,f,l)];return u&&u.source?(o>1&&console.log("found parent tile z%d-%d-%d",c,f,l),o>1&&console.time("drilling down"),this.splitTile(u.source,c,f,l,e,t,r),o>1&&console.timeEnd("drilling down"),this.tiles[s]?transformTile(this.tiles[s],i):null):null};var Fe=0,Ve=function(){function BQClient(e){h()(this,BQClient),this._projectId=e.projectId,this._datasetId=e.datasetId,this._tableId=e.tableId,this._token=e.token}return d()(BQClient,[{key:"list",value:function(){var e=f()(u.a.mark(function _callee(){return u.a.wrap(function _callee$(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.fetch("GET","jobs"));case 1:case"end":return e.stop()}},_callee,this)}));return function list(){return e.apply(this,arguments)}}()},{key:"insert",value:function(){var e=f()(u.a.mark(function _callee2(){return u.a.wrap(function _callee2$(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.fetch("POST","jobs"));case 1:case"end":return e.stop()}},_callee2,this)}));return function insert(){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=f()(u.a.mark(function _callee3(e){return u.a.wrap(function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.fetch("GET","jobs/".concat(e)));case 1:case"end":return t.stop()}},_callee3,this)}));return function get(t){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){var e=f()(u.a.mark(function _callee4(e){return u.a.wrap(function _callee4$(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.fetch("POST","jobs/".concat(e,"/cancel")));case 1:case"end":return t.stop()}},_callee4,this)}));return function cancel(t){return e.apply(this,arguments)}}()},{key:"query",value:function(){var e=f()(u.a.mark(function _callee5(e){return u.a.wrap(function _callee5$(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.fetch("POST","queries",{kind:"bigquery#queryRequest",query:e,useLegacySql:!1}));case 1:case"end":return t.stop()}},_callee5,this)}));return function query(t){return e.apply(this,arguments)}}()},{key:"getQueryResults",value:function(){var e=f()(u.a.mark(function _callee6(e){return u.a.wrap(function _callee6$(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.fetch("GET","queries/".concat(e)));case 1:case"end":return t.stop()}},_callee6,this)}));return function getQueryResults(t){return e.apply(this,arguments)}}()},{key:"execute",value:function(){var e=f()(u.a.mark(function _callee7(e){var t;return u.a.wrap(function _callee7$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.query(e);case 2:return t=r.sent,r.abrupt("return",this._pollingQuery(t));case 4:case"end":return r.stop()}},_callee7,this)}));return function execute(t){return e.apply(this,arguments)}}()},{key:"_pollingQuery",value:function(){var e=f()(u.a.mark(function _callee9(e){var t=this;return u.a.wrap(function _callee9$(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise(function(r,n){if(e.jobComplete)r(e);else{var i=e.jobReference.jobId;setTimeout(f()(u.a.mark(function _callee8(){var e;return u.a.wrap(function _callee8$(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.getQueryResults(i);case 2:(e=n.sent).jobComplete?r(e):r(t._pollingQuery(e));case 4:case"end":return n.stop()}},_callee8)})),5e3)}}));case 1:case"end":return r.stop()}},_callee9)}));return function _pollingQuery(t){return e.apply(this,arguments)}}()},{key:"fetch",value:function(e){function fetch(t,r,n){return e.apply(this,arguments)}return fetch.toString=function(){return e.toString()},fetch}(function(){var e=f()(u.a.mark(function _callee10(e,t,r){var n;return u.a.wrap(function _callee10$(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,fetch("".concat("https://bigquery.googleapis.com/bigquery/v2","/projects/").concat(this._projectId,"/").concat(t),{method:e,headers:{Authorization:"Bearer ".concat(this._token),"Content-Type":"application/json"},body:r&&JSON.stringify(r)});case 2:return n=i.sent,i.abrupt("return",n.json());case 4:case"end":return i.stop()}},_callee10,this)}));return function(t,r,n){return e.apply(this,arguments)}}())},{key:"fetchTiles",value:function(){var e=f()(u.a.mark(function _callee11(e){var t,r,n,i,o,a,s,c,f,l,h=this;return u.a.wrap(function _callee11$(u){for(;;)switch(u.prev=u.next){case 0:return t=e.map(function(e){return h._tileFilter(e)}).join(" OR "),r="SELECT z,x,y,mvt FROM `".concat(this._datasetId,".").concat(this._tableId,"` WHERE ").concat(t),u.next=4,this.query(r);case 4:if(n=u.sent,i=[],n&&n.rows)for(o=0;o<n.rows.length;o++)(a=n.rows[o]).f&&4===a.f.length&&(s=parseInt(a.f[0].v),c=parseInt(a.f[1].v),f=parseInt(a.f[2].v),l=a.f[3].v,i.push({z:s,x:c,y:f,buffer:Object(Te.decode)(l)}));return u.abrupt("return",i);case 8:case"end":return u.stop()}},_callee11,this)}));return function fetchTiles(t){return e.apply(this,arguments)}}()},{key:"_tileFilter",value:function _tileFilter(e){return"(z = ".concat(e.z," AND x = ").concat(e.x," AND y = ").concat(e.y,")")}},{key:"fetchRawTiles",value:function(){var e=f()(u.a.mark(function _callee12(){var e,t,r,n,i,o,a,s,c,f,l,h,p;return u.a.wrap(function _callee12$(u){for(;;)switch(u.prev=u.next){case 0:if(!(Fe>0)){u.next=2;break}return u.abrupt("return",[]);case 2:return Fe=1,console.log("Fetch Raw Tiles"),e=getTime(),u.next=7,this.execute("\n            SELECT x,y,ARRAY_AGG(STRUCT(geom_table)) as geoms \n            FROM `carto-do-public-data.usa_carto.geography_usa_blockgroup_2015` as geom_table, \n            unnest(`cartodb-gcp-backend-data-team`.tiler.getTilesBBOX(-73.955397,40.724201,-73.924341,40.743828, 14, 256))\n            WHERE ST_INTERSECTSBOX(geom, bbox[OFFSET(0)], bbox[OFFSET(1)], bbox[OFFSET(2)], bbox[OFFSET(3)])\n                  AND ST_INTERSECTSBOX(geom, -73.955397, 40.724201, -73.924341, 40.743828)\n            GROUP by x,y;\n        ");case 7:for(t=u.sent,r=getTime(),console.log(r-e),n=14,i=[],o=0;o<t.rows.length;o++)a=bq2geojson(t.rows[o]),s=a.x,c=a.y,f=a.geojson,l=geojsonvt(f,{tolerance:0}),h=l.getTile(n,s,c),p=Object(ke.fromGeojsonVt)({default:h},{version:2}),i.push({z:n,x:s,y:c,buffer:p});return u.abrupt("return",i);case 14:case"end":return u.stop()}},_callee12,this)}));return function fetchRawTiles(){return e.apply(this,arguments)}}()}]),BQClient}();function bq2geojson(e){for(var t=parseInt(e.f[0].v),r=parseInt(e.f[1].v),n=e.f[2].v,i={type:"FeatureCollection",features:[]},o=0;o<n.length;o++){var a=n[o].v.f[0].v.f[0].v,s=n[o].v.f[0].v.f[1].v,u=n[o].v.f[0].v.f[2].v,c=n[o].v.f[0].v.f[5].v,f=Object(Me.parse)(c);i.features.push({type:"Feature",geometry:f,properties:{geoid:a,label:s,area:u}})}return{x:t,y:r,geojson:i}}function getTime(){return(new Date).getTime()}var Se=1,Ie=2,Ee=3,Ne={1:W.POINT,2:W.LINE,3:W.POLYGON},Ce=function(){function BQMVTWorker(){h()(this,BQMVTWorker)}return d()(BQMVTWorker,[{key:"onmessage",value:function onmessage(e){this.processEvent(e).then(postMessage)}},{key:"processEvent",value:function(){var e=f()(u.a.mark(function _callee(e){var t,r;return u.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return(t=e.data).metadata&&(this.castMetadata(t.metadata),this.metadata=t.metadata),n.next=4,this._requestDataframes(t.tiles,t.bqSource,t.layerID,this.metadata);case 4:return r=n.sent,n.abrupt("return",{mID:t.mID,dataframes:r});case 6:case"end":return n.stop()}},_callee,this)}));return function processEvent(t){return e.apply(this,arguments)}}()},{key:"castMetadata",value:function castMetadata(e){Object.setPrototypeOf(e,ce.prototype),e.setCodecs()}},{key:"_requestDataframes",value:function(){var e=f()(u.a.mark(function _callee2(e,t,r,n){var i,o,a,s,c,f=this;return u.a.wrap(function _callee2$(l){for(;;)switch(l.prev=l.next){case 0:return i=[],o=new Ve(t),l.next=4,o.fetchRawTiles(e);case 4:a=l.sent,s=u.a.mark(function _loop(t){var o,s,c;return u.a.wrap(function _loop$(u){for(;;)switch(u.prev=u.next){case 0:if(o=e[t],!(s=a&&a.find(function(e){return e.x===o.x&&e.y===o.y&&e.z===o.z}))){u.next=9;break}return u.next=5,f.responseToDataframeTransformer(s,r,n);case 5:c=u.sent,i.push(c),u.next=10;break;case 9:i.push({x:o.x,y:o.y,z:o.z,empty:!0});case 10:case"end":return u.stop()}},_loop)}),c=0;case 7:if(!(c<e.length)){l.next=12;break}return l.delegateYield(s(c),"t0",9);case 9:c++,l.next=7;break;case 12:return l.abrupt("return",i);case 13:case"end":return l.stop()}},_callee2)}));return function _requestDataframes(t,r,n,i){return e.apply(this,arguments)}}()},{key:"responseToDataframeTransformer",value:function(){var e=f()(u.a.mark(function _callee3(e,t,r){var n,i,o,a,s,c,f,l,h,p,d,m,g;return u.a.wrap(function _callee3$(u){for(;;)switch(u.prev=u.next){case 0:if(n=e.x,i=e.y,o=e.z,a=e.buffer,s=r.extent,0!==a.byteLength){u.next=4;break}return u.abrupt("return",{x:n,y:i,z:o,empty:!0});case 4:if(c=new y.VectorTile(new v(a)),!(Object.keys(c.layers).length>1)||t){u.next=7;break}throw new q("LayerID parameter wasn't specified and the MVT tile contains multiple layers: ".concat(JSON.stringify(Object.keys(c.layers)),"."),j.MISSING_REQUIRED);case 7:if(f=c.layers[t||Object.keys(c.layers)[0]]){u.next=10;break}return u.abrupt("return",{empty:!0});case 10:return l=this._decodeMVTLayer(f,r,s),h=l.geometries,p=l.properties,d=l.propertiesArrayBuffer,m=l.numFeatures,g=getRsysFromTile(n,i,o),u.abrupt("return",this._generateDataFrame(g,h,p,d,m,r.geomType,r,n,i,o));case 13:case"end":return u.stop()}},_callee3,this)}));return function responseToDataframeTransformer(t,r,n){return e.apply(this,arguments)}}()},{key:"_decodeMVTLayer",value:function _decodeMVTLayer(e,t,r){if(!e.length)return{properties:[],geometries:{},propertiesArrayBuffer:[],numFeatures:0};switch(t.geomType||(t.geomType=this._autoDiscoverType(e)),t.geomType){case W.POINT:var n=new ArrayBuffer(2*e.length*3*4);return this._decode(e,t,r,n);case W.LINE:return this._decode(e,t,r,[],decodeLines);case W.POLYGON:return this._decode(e,t,r,[],decodePolygons);default:throw new q("MVT: invalid geometry type '".concat(t.geomType,"'"),j.INCORRECT_TYPE)}}},{key:"_autoDiscoverType",value:function _autoDiscoverType(e){var t=e.feature(0).type;switch(t){case Se:return W.POINT;case Ie:return W.LINE;case Ee:return W.POLYGON;default:throw new q("MVT: invalid geometry type '".concat(t,"'"),j.INCORRECT_TYPE)}}},{key:"_decode",value:function _decode(e,t,r,n,i){var o,a=0;n&&(o=new Float32Array(n));for(var s=this._initializePropertyArrays(t,e.length),u=s.properties,c=s.propertiesArrayBuffer,f=this._scalarPropertyCodecs(t),l=this._rangePropertyCodecs(t),h=0;h<e.length;h++){var p=e.feature(h);this._checkType(p,t.geomType);var d=p.loadGeometry();if(i){var y=i(d,r);n.push(y)}else{var v=2*d[0][0].x/r-1,m=2*(1-d[0][0].y/r)-1;if(v<-1||v>=1||m<-1||m>=1)continue;o[6*a+0]=v,o[6*a+1]=m,o[6*a+2]=v,o[6*a+3]=m,o[6*a+4]=v,o[6*a+5]=m}if(void 0===p.properties[t.idProperty])throw new $("MVT feature with undefined idProperty '".concat(t.idProperty,"'"),Q.MVT);this._decodeProperties(t,f,l,u,p,a),a++}return{properties:u,propertiesArrayBuffer:c,geometries:n,numFeatures:a}}},{key:"_checkType",value:function _checkType(e,t){var r=e.type,n=Ne[r];if(n!==t)throw new $("MVT: mixed geometry types in the same layer. Layer has type: ".concat(t," but feature was ").concat(n),Q.MVT)}},{key:"_initializePropertyArrays",value:function _initializePropertyArrays(e,t){var r=this._getPropertyNamesFrom(e),n=this._getPropertiesFor(r,t);return{propertyNames:r,properties:n.properties,propertiesArrayBuffer:n.propertiesArrayBuffer}}},{key:"_getSourcePropertyNamesFrom",value:function _getSourcePropertyNamesFrom(e){return e.propertyKeys.filter(function(t){return"geometry"!==e.properties[e.baseName(t)].type})}},{key:"_getPropertyNamesFrom",value:function _getPropertyNamesFrom(e){var t=[];return this._getSourcePropertyNamesFrom(e).forEach(function(r){e.decodedProperties(r).forEach(function(e){t.push(e)})}),t}},{key:"_getPropertiesFor",value:function _getPropertiesFor(e,t){for(var r={},n=1024*Math.ceil(t/1024),i=new ArrayBuffer(4*n*e.length),o=i,a=0;a<e.length;a++){r[e[a]]=new Float32Array(i,4*a*n,n)}return{properties:r,propertiesArrayBuffer:o}}},{key:"_scalarPropertyCodecs",value:function _scalarPropertyCodecs(e){return this._getSourcePropertyNamesFrom(e).map(function(t){return[t,e.codec(t)]}).filter(function(e){var t=a()(e,2);t[0];return!t[1].isRange()})}},{key:"_rangePropertyCodecs",value:function _rangePropertyCodecs(e){return this._getSourcePropertyNamesFrom(e).map(function(t){return[t,e.decodedProperties(t),e.codec(t)]}).filter(function(e){var t=a()(e,3);t[0],t[1];return t[2].isRange()})}},{key:"_decodeProperties",value:function _decodeProperties(e,t,r,n,i,o){for(var s=t.length,u=0;u<s;u++){var c=a()(t[u],2),f=c[0],l=c[1],h=i.properties[f];n[f][o]=l.sourceToInternal(e,h)}s=r.length;for(var p=0;p<s;p++){var d=a()(r[p],3),y=(f=d[0],a()(d[1],2)),v=y[0],m=y[1],g=(l=d[2],i.properties[f]),x=l.sourceToInternal(e,g),w=a()(x,2),b=w[0],_=w[1];n[v][o]=b,n[m][o]=_}}},{key:"_generateDataFrame",value:function _generateDataFrame(e,t,r,n,i,o,a,s,u,c){return new ge({active:!1,center:e.center,geom:t,properties:r,propertiesArrayBuffer:n,scale:e.scale,size:i,type:o,metadata:a,x:s,y:u,z:c})}}]),BQMVTWorker}(),Le=["year","month","day","hour","minute","second"],Oe=[1,1,1,0,0,0],De=0,Ae=1,Be=2,Re=3,Ge=4,qe=5,je=864e5,We=36e5,ze=6e4,Ye=1e3;function startLevel(e){for(var t=Le.length-1;t>0&&e[Le[t]]===Oe[t];)--t;return t}function pad(e,t){return e.toString().padStart(t,"0")}function parsedValue(e){var t=msToDate(e);return{year:t.getUTCFullYear(),month:t.getUTCMonth()+1,day:t.getUTCDate(),hour:t.getUTCHours(),minute:t.getUTCMinutes(),second:t.getUTCSeconds()}}function invalidPeriod(e,t){throw new Error("Invalid period of ".concat(t," between ").concat(e.v1," and ").concat(e.v2))}function yearWeek(e,t){var r=function isoDow(e,t,r){var n=new Date(e,t-1,r).getDay();return 0===n?7:n}(e,1,1),n=r>4?9-r:2-r;return Math.abs(t-n)%7!=0?[]:t<n?yearWeek(e-1,t+=Math.round((Date.UTC(e,0,1)-Date.UTC(e-1,0,1))/je)):Date.UTC(e,0,1)+(t-1+3)*je>=Date.UTC(e+1,0,1)?yearWeek(e+1,t-=Math.round((Date.UTC(e+1,0,1)-Date.UTC(e,0,1))/je)):[e,1+Math.round((t-n)/7)]}function periodISO(e,t){var r=parsedValue(e),n=parsedValue(t),i=startLevel(r),o=startLevel(n),s={v1:e,v2:t,t1:r,t2:n};return Math.max(i,o)===De?function yearsPeriod(e){var t=e.t2.year-e.t1.year;return 1e3===t&&(e.t1.year-1)%1e3==0?"M".concat(1+(e.t1.year-1)/1e3):100===t&&(e.t1.year-1)%100==0?"C".concat(1+(e.t1.year-1)/100):10===t&&e.t1.year%10==0?"D".concat(e.t1.year/10):1===t?pad(e.t1.year,4):void invalidPeriod("".concat(t," years"))}(s):Math.max(i,o)===Ae?function monthsPeriod(e){var t=12*e.t2.year+e.t2.month-12*e.t1.year-e.t1.month;return 6===t&&(e.t1.month-1)%6==0?"".concat(pad(e.t1.year,4),"S").concat(1+(e.t1.month-1)/6):4===t?"".concat(pad(e.t1.year,4),"t").concat(1+(e.t1.month-1)/4):3===t?"".concat(pad(e.t1.year,4),"-Q").concat(1+(e.t1.month-1)/3):1===t?"".concat(pad(e.t1.year,4),"-").concat(pad(e.t1.month,2)):void invalidPeriod("".concat(t," months"))}(s):Math.max(i,o)===Be?function daysPeriod(e){var t=Math.round((e.v2-e.v1)/je);if(1===t)return"".concat(pad(e.t1.year,4),"-").concat(pad(e.t1.month,2),"-").concat(pad(e.t1.day,2));if(7===t){var r=e.t1.year,n=Date.UTC(r,0,1),i=yearWeek(r,1+Math.round((e.v1-n)/je)),o=a()(i,2),s=o[0],u=o[1];if(s&&u)return"".concat(pad(s,4),"-W").concat(pad(u,2));invalidPeriod("7 days")}else invalidPeriod("".concat(t," days"))}(s):Math.max(i,o)===Re?function hoursPeriod(e){var t=Math.round((e.v2-e.v1)/We);if(1===t)return"".concat(pad(e.t1.year,4),"-").concat(pad(e.t1.month,2),"-").concat(pad(e.t1.day,2),"T").concat(pad(e.t1.hour,2));invalidPeriod("".concat(t," hours"))}(s):Math.max(i,o)===Ge?function minutesPeriod(e){var t=Math.round((e.v2-e.v1)/ze);if(1===t)return"".concat(pad(e.t1.year,4),"-").concat(pad(e.t1.month,2),"-").concat(pad(e.t1.day,2),"T").concat(pad(e.t1.hour,2),":").concat(pad(e.t1.minute,2));invalidPeriod("".concat(t," minutes"))}(s):Math.max(i,o)===qe?function secondsPeriod(e){var t=Math.round((e.v2-e.v1)/Ye);if(1===t)return"".concat(pad(e.t1.year,4),"-").concat(pad(e.t1.month,2),"-").concat(pad(e.t1.day,2),"T").concat(pad(e.t1.hour,2),":").concat(pad(e.t1.minute,2),":").concat(pad(e.t1.second,2));invalidPeriod("".concat(t," seconds"))}(s):void invalidPeriod(s,"fractional seconds")}var Ue=function(e){function CartoParsingError(e){var t;h()(this,CartoParsingError);return(t=L()(this,D()(CartoParsingError).call(this,{message:e,type:"[Error]"}))).name="CartoParsingError",t}return B()(CartoParsingError,e),CartoParsingError}(G),Ze=function(){function IsoParser(e){h()(this,IsoParser),this._format=e}return d()(IsoParser,[{key:"check",value:function check(e){return e.match(this._format)}}]),IsoParser}();function fieldDefault(e,t){return void 0===e?t:Number(e)}function dateFields(e){return{year:fieldDefault(e.year,1),month:fieldDefault(e.month,1),day:fieldDefault(e.day,1),hour:fieldDefault(e.hour,0),minute:fieldDefault(e.minute,0),second:fieldDefault(e.second,0)}}function fieldsFromMatch(e){return dateFields({year:e[1],month:e[2],day:e[3],hour:e[4],minute:e[5],second:e[6]})}var $e=function(e){function YMDHMSParser(){return h()(this,YMDHMSParser),L()(this,D()(YMDHMSParser).call(this,/^(\d\d\d\d)(?:\-?(\d\d)(?:\-?(\d\d)(?:[T\s]?(\d\d)(?:\:(\d\d)(?:\:(\d\d))?)?)?)?)?$/))}return B()(YMDHMSParser,e),d()(YMDHMSParser,[{key:"parse",value:function parse(e){var t=this.check(e)||[],r=t.slice(),n=[1,2,3,4,5,6].find(function(e){return void 0===r[e]})||7;return 1===n?r[1]=2:r[n-1]=Number(r[n-1])+1,[fieldsFromMatch(t),fieldsFromMatch(r)]}}]),YMDHMSParser}(Ze),Qe=function(e){function MillenniumParser(){return h()(this,MillenniumParser),L()(this,D()(MillenniumParser).call(this,/^M(\d+)$/))}return B()(MillenniumParser,e),d()(MillenniumParser,[{key:"parse",value:function parse(e){var t=this.check(e),r=Number(t[1]),n=function year(e){return 1e3*(e-1)+1};return[dateFields({year:n(r)}),dateFields({year:n(r+1)})]}}]),MillenniumParser}(Ze),Xe=function(e){function CenturyParser(){return h()(this,CenturyParser),L()(this,D()(CenturyParser).call(this,/^C(\d+)$/))}return B()(CenturyParser,e),d()(CenturyParser,[{key:"parse",value:function parse(e){var t=this.check(e),r=Number(t[1]),n=function year(e){return 100*(e-1)+1};return[dateFields({year:n(r)}),dateFields({year:n(r+1)})]}}]),CenturyParser}(Ze),Je=function(e){function DecadeParser(){return h()(this,DecadeParser),L()(this,D()(DecadeParser).call(this,/^D(\d+)$/))}return B()(DecadeParser,e),d()(DecadeParser,[{key:"parse",value:function parse(e){var t=this.check(e),r=Number(t[1]),n=function year(e){return 10*e};return[dateFields({year:n(r)}),dateFields({year:n(r+1)})]}}]),DecadeParser}(Ze),He=function(e){function SemesterParser(){return h()(this,SemesterParser),L()(this,D()(SemesterParser).call(this,/^(\d\d\d\d)S(\d)$/))}return B()(SemesterParser,e),d()(SemesterParser,[{key:"parse",value:function parse(e){var t=this.check(e),r=Number(t[1]),n=Number(t[2]),i=function month(e){return 6*(e-1)+1};return[dateFields({year:r,month:i(n)}),dateFields({year:r,month:i(n+1)})]}}]),SemesterParser}(Ze),Ke=function(e){function TrimesterParser(){return h()(this,TrimesterParser),L()(this,D()(TrimesterParser).call(this,/^(\d\d\d\d)t(\d)$/))}return B()(TrimesterParser,e),d()(TrimesterParser,[{key:"parse",value:function parse(e){var t=this.check(e),r=Number(t[1]),n=Number(t[2]),i=function month(e){return 4*(e-1)+1};return[dateFields({year:r,month:i(n)}),dateFields({year:r,month:i(n+1)})]}}]),TrimesterParser}(Ze),et=function(e){function QuarterParser(){return h()(this,QuarterParser),L()(this,D()(QuarterParser).call(this,/^(\d\d\d\d)\-?Q(\d)$/))}return B()(QuarterParser,e),d()(QuarterParser,[{key:"parse",value:function parse(e){var t=this.check(e),r=Number(t[1]),n=Number(t[2]),i=function month(e){return 3*(e-1)+1};return[dateFields({year:r,month:i(n)}),dateFields({year:r,month:i(n+1)})]}}]),QuarterParser}(Ze);function startOfIsoWeek(e,t){var r=function parseISO_isoDow(e,t,r){var n=new Date(e,t-1,r).getDay();return 0===n?7:n}(e,1,1);return function addDays(e,t){var r=new Date(e.valueOf());return r.setDate(r.getDate()+t),r}(new Date(e,0,r>4?9-r:2-r),7*(t-1))}var tt=function(e){function WeekParser(){return h()(this,WeekParser),L()(this,D()(WeekParser).call(this,/^(\d\d\d\d)\-?W(\d\d)$/))}return B()(WeekParser,e),d()(WeekParser,[{key:"parse",value:function parse(e){var t=this.check(e),r=Number(t[1]),n=Number(t[2]),i=startOfIsoWeek(r,n),o=startOfIsoWeek(r,n+1),a=function fields(e){return{year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()}};return[dateFields(a(i)),dateFields(a(o))]}}]),WeekParser}(Ze),rt=[new Qe,new Xe,new Je,new He,new Ke,new et,new tt,new $e];function parseISO(e){var t=function findParser(e){return rt.find(function(t){return t.check(e)})}(e=e||"");if(!t)throw new Ue("No date parser found for ".concat(e));return t.parse(e)}var nt=function(){function TimeZoneDate(e,t){h()(this,TimeZoneDate),this._value=e,this._date=msToDate(e),this._timeZone=t}return d()(TimeZoneDate,[{key:"year",get:function get(){return this._date.getUTCFullYear()}},{key:"month",get:function get(){return this._date.getUTCMonth()+1}},{key:"day",get:function get(){return this._date.getUTCDate()}},{key:"hour",get:function get(){return this._date.getUTCHours()}},{key:"minute",get:function get(){return this._date.getUTCMinutes()}},{key:"second",get:function get(){return this._date.getUTCSeconds()}},{key:"text",get:function get(){return periodISO(this._date.getTime(),this._date.getTime()+1e3)}},{key:"timeZone",get:function get(){return this._timeZone}}],[{key:"fromValue",value:function fromValue(e,t){return new TimeZoneDate(e,t)}},{key:"from",value:function from(e,t,r,n,i,o,a){return this.fromValue(Date.UTC(e,(t||1)-1,r,n,i,o),a)}}]),TimeZoneDate}(),it=function(){function TimeRange(e,t,r,n){if(h()(this,TimeRange),this._startValue=r,this._endValue=n,r&&n)this._iso=periodISO(r,n);else if(!r&&!n&&t){var i=function _startEndTimeValues(e){return parseISO(e).map(_timeValue)}(t);this._iso=t,this._startValue=i[0],this._endValue=i[1]}this._timeZone=e}return d()(TimeRange,[{key:"timeZone",get:function get(){return this._timeZone}},{key:"iso",get:function get(){return this._iso}},{key:"startValue",get:function get(){return this._startValue}},{key:"endValue",get:function get(){return this._endValue}},{key:"startDate",get:function get(){return nt.fromValue(this._startValue,this._timeZone)}},{key:"endDate",get:function get(){return nt.fromValue(this._endValue,this._timeZone)}}]),TimeRange}();function _timeValue(e){return Date.UTC(e.year,e.month-1,e.day,e.hour,e.minute,e.second)}Math.PI;var ot=6378137;Math.PI;function msToDate(e){return new Date(e)}function castTimeRange(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return void 0===e||function isTimeRange(e){return e instanceof it}(e)?e&&t?util_timeRange({iso:e._iso,timeZone:t}):e:"string"==typeof e?util_timeRange({iso:e,timeZone:t}):void 0}function util_timeRange(e){var t=e.start,r=e.end,n=e.iso,i=e.timeZone;return new it(i,n,t,r)}var at=function(e){function WindshaftDateCodec(e,t){var r;h()(this,WindshaftDateCodec),r=L()(this,D()(WindshaftDateCodec).call(this,e,t));var n=e.stats(t).min;return r._min_ms=1e3*n,r._min_date=msToDate(r._min_ms),r}return B()(WindshaftDateCodec,e),d()(WindshaftDateCodec,[{key:"sourceToInternal",value:function sourceToInternal(e,t){return msToDate(1e3*t)-this._min_date}},{key:"internalToExternal",value:function internalToExternal(e,t){var r=t;return msToDate(r+=this._min_ms)}},{key:"externalToSource",value:function externalToSource(e,t){return t.getTime()/1e3}},{key:"sourceToExternal",value:function sourceToExternal(e,t){return function asDate(e){if(e instanceof Date)return e;return msToDate(1e3*e)}(t)}},{key:"inlineInternalMatch",value:function inlineInternalMatch(e,t){var r=t._min_ms-this._min_ms;return"(".concat(e,"-").concat(r.toFixed(20),")")}}]),WindshaftDateCodec}(X);var st=function(e){function TimeRangeCodec(e,t){var r;h()(this,TimeRangeCodec),r=L()(this,D()(TimeRangeCodec).call(this,e,t));var n=e.stats(t),i=n.min,o=n.grouping&&n.grouping.timezone,a=util_timeRange({timeZone:o,iso:i});return r._min=a.startValue/1e3,r._timeZone=o,r}return B()(TimeRangeCodec,e),d()(TimeRangeCodec,[{key:"isRange",value:function isRange(){return!0}},{key:"sourceToInternal",value:function sourceToInternal(e,t){var r=this,n=util_timeRange({iso:t});return[n.startValue/1e3,n.endValue/1e3].map(function(e){return e-r._min})}},{key:"internalToExternal",value:function internalToExternal(e,t){var r=a()(t,2),n=r[0],i=r[1];return util_timeRange({start:1e3*(n+this._min),end:1e3*(i+this._min),timeZone:this._timeZone})}},{key:"externalToSource",value:function externalToSource(e,t){return castTimeRange(t,this._timeZone)._iso}},{key:"sourceToExternal",value:function sourceToExternal(e,t){return util_timeRange({iso:t,timeZone:this._timeZone})}},{key:"inlineInternalMatch",value:function inlineInternalMatch(e,t){var r=t._min.getTime()-this._min.getTime();return"(".concat(e,"-").concat(r.toFixed(20),")")}}]),TimeRangeCodec}(X),ut=function(e){function CartoMapsAPIError(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ct.DEFAULT;return h()(this,CartoMapsAPIError),(t=L()(this,D()(CartoMapsAPIError).call(this,{message:e,type:r}))).name="CartoMapsAPIError",t}return B()(CartoMapsAPIError,e),CartoMapsAPIError}(G),ct={DEFAULT:"[Error]",SQL:"[SQL]",NOT_SUPPORTED:"[Not supported]",SECURITY:"[Security]"};var ft=function(e){function WindshaftMetadata(){var e,t;h()(this,WindshaftMetadata);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=L()(this,(e=D()(WindshaftMetadata)).call.apply(e,[this].concat(n)))).propertyKeys=[],t.baseNames={},Object.keys(t.properties).forEach(function(e){var r=t.properties[e];r.aggregations?Object.values(r.aggregations).forEach(function(r){t._addProperty(e,r)}):r.dimension?r.dimension.range?(r.dimension.range.forEach(function(r){t._addProperty(e,r,!1)}),t._addProperty(e,r.dimension.propertyName)):t._addProperty(e,r.dimension.propertyName):t._addProperty(e,e)}),t}return B()(WindshaftMetadata,e),d()(WindshaftMetadata,[{key:"_addProperty",value:function _addProperty(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.baseNames[t]=e,r&&this.propertyKeys.push(t)}},{key:"_dimensionInfo",value:function _dimensionInfo(e){var t=this.baseName(e)||e,r=this.properties[t],n=null;t!==e&&t!==e&&r.dimension&&(n=r.dimension);var i=r.type,o=n?function dimensionBaseType(e){return e.type}(n):i;return{baseName:t,column:r,dimension:n,dataframeType:n?function dimensionType(e,t){if(e.range)return"date";return e.type}(n):o,baseType:i,sourceType:o}}},{key:"baseName",value:function baseName(e){return this.baseNames[e]}},{key:"decodedProperties",value:function decodedProperties(e){var t=this._dimensionInfo(e).dimension;return t&&t.grouping&&t.range?t.range:ie()(D()(WindshaftMetadata.prototype),"decodedProperties",this).call(this,e)}},{key:"stats",value:function stats(e){var t=this._dimensionInfo(e).dimension;return t&&t.grouping?t:ie()(D()(WindshaftMetadata.prototype),"stats",this).call(this,e)}},{key:"setCodecs",value:function setCodecs(){!function setMetadataCodecs(e){Object.keys(e.properties).forEach(function(t){var r=e.properties[t],n=r.type;if("geometry"!==n){var i=r.dimension?r.dimension.type:null,o=i?r.dimension.propertyName:t,a="category"===i&&r.dimension.range?"timerange":i;r.codec=function windshaftCodecFactory(e,t,r){switch(t){case"number":return new oe(e,r);case"category":return new se(e,r);case"date":return new at(e,r);case"timerange":return new st(e,r);default:throw new ut("Windshaft MVT decoding error. Feature property value of type '".concat(t,"' cannot be decoded."),ct.NOT_SUPPORTED)}}(e,a||n,o||t)}})}(this)}},{key:"sourcePropertyName",value:function sourcePropertyName(e){var t=this.baseName(e),r=this.properties[t].dimension;return r&&r.range?r.propertyName:e}}]),WindshaftMetadata}(ce);var lt=function(e){function WindshaftWorker(){return h()(this,WindshaftWorker),L()(this,D()(WindshaftWorker).apply(this,arguments))}return B()(WindshaftWorker,e),d()(WindshaftWorker,[{key:"castMetadata",value:function castMetadata(e){Object.setPrototypeOf(e,ft.prototype),e.setCodecs()}}]),WindshaftWorker}(Pe);const ht={MVT:new Pe,BQMVT:new Ce,windshaft:new lt};onmessage=function(e){return ht[e.data.workerName].onmessage(e)}}]);